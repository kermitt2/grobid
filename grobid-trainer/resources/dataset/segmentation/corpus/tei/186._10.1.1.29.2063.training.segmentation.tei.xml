<?xml version="1.0" ?>
<tei xml:space="preserve">
	<teiHeader>
		<fileDesc xml:id="0"/>
	</teiHeader>
	<text xml:lang="en">
			<front>PENALIZED LIKELIHOOD EMISSION IMAGE RECONSTRUCTION <lb/>WITH UNCERTAIN BOUNDARY INFORMATION <lb/>Stephen R. Titus, Alfred O. Hero III, Je rey A. Fessler <lb/>4401 EECS, University of Michigan, Ann Arbor, MI 48109 <lb/>ABSTRACT <lb/>In this paper, a method is introduced for incorporat-<lb/>ing perfectly registered MRI boundary information into <lb/>a penalized likelihood emission reconstruction scheme. <lb/>The boundary curve is modeled as a periodic spline <lb/>whose coe cients are estimated from the MRI image. <lb/>The resulting boundary estimate is mapped to a spa-<lb/>tially variant set of Gibbs weights. When incorpo-<lb/>rated into a quadratic roughness penalty, these weights <lb/>improve emission reconstruction bias/variance perfor-<lb/>mance by preventing smoothing across the estimated <lb/>boundary. <lb/></front>

			<body>1. INTRODUCTION <lb/>Emission computed tomography (ECT) images of ra-<lb/>dioisotope concentration are reconstructed from data <lb/>that consists of counts of detected decay events. Sev-<lb/>eral factors, including dose limitations, scatter, attenu-<lb/>ation, and detector e ciency, limit the acquired count <lb/>rates achievable in ECT. The resulting low SNR gives <lb/>rise to a poor bias/variance tradeo . Recently, various <lb/>researchers have used MRI boundary side information <lb/>to improve performance in the case where functional <lb/>and anatomical boundaries are coincident, e.g. 1], 2]. <lb/>However, many use the side information \blindly&quot;, ig-<lb/>noring the uncertainty of the boundary estimate. Here, <lb/>we present a spline-based method for incorporating an <lb/>anatomical boundary estimate from an MRI image into <lb/>the penalized likelihood (PL) emission reconstruction <lb/>paradigm. Speci cally, we focus on estimating mean <lb/>uptake in a region of interest (ROI) inside the boundary <lb/>curve. Estimator performance is characterized by the <lb/>bias/variance tradeo associated with varying the regu-<lb/>larization parameter, and asymptotic limits on bias/variance <lb/>performance are determined. <lb/></body>

            <front>This work was supported by National Cancer Institute, ROI-<lb/>CA-54362-02 and DOE Grant DE-FG02-87ER65061. <lb/></front>

            <body>2. MRI BOUNDARY ESTIMATION <lb/>Consider an anatomical slice of interest which contains <lb/>a single organ or tumor that selectively absorbs a rel-<lb/>atively uniform concentration of radionuclide, so that <lb/>the radionuclide and anatomical boundaries coincide. <lb/>Let r(x; y) denote the resulting single boundary curve <lb/>present in the perfectly registered MRI and emission <lb/>slice planes. The MRI boundary estimation problem <lb/>consists of generating an estimater(x; y) from Y M , a <lb/>noisy MRI image of the slice. <lb/>We parameterize boundary r(x; y) using a periodic <lb/>polar spline. A periodic polar spline function r( ) of <lb/>degree d is a piecewise polynomial on 0; 2 ] that is <lb/>de ned over a set of K scalar \knots&quot; fx 1 = 0 &lt; x 2 &lt; <lb/>: : : &lt; x K = 2 g, and has the following properties <lb/>3]: (i) it is a polynomial of degree d on intervals <lb/>x j ; x j+1 ], (ii) it is continuous and has d?1 continuous <lb/>derivatives on 0; 2 ], and (iii) the values of the function <lb/>and its rst d ? 1 derivatives at 0 equal those at 2 . <lb/>Any periodic polar spline function represents a smooth, <lb/>closed polar curve with respect to a prescribed origin. <lb/>The normalized b-spline basis for this set of splines (see <lb/>3]) allows us to write any periodic polar spline function <lb/>r( ) in terms of a set of K ? 1 basis splines: <lb/>r ( ) = <lb/>K?1 X <lb/>i=1 <lb/>i B i ( ) <lb/>8 2 0; 2 ] : <lb/>(1) <lb/>The scalars = ( 1 ; : : :; K?1 ) are called spline coe -<lb/>cients. Non-negativity of the fB i ( )g assures that if all <lb/>i &gt; 0, r ( ) represents a non-intersecting, continuous <lb/>closed boundary. <lb/>Side information is extracted from the MRI image <lb/>using ML estimation of 4]; i.e. <lb/>= argmax ln f(Y M ; ) : <lb/>(2) <lb/>We model the MRI scanner as a linear, spatially shift <lb/>invariant system with a symmetric Gaussian 2D im-<lb/>pulse response h(x; y) and with additive white Gaus-<lb/>sian noise 5]. These system and noise models lead to <lb/>the following Gaussian model for MRI image Y M : <lb/>Y M = I( ) H + N <lb/>(3) <lb/>where matrix I( ) is the true MRI image containing <lb/>boundary , H contains samples of h(x; y) at pixel cen-<lb/>ters, N contains IID white noise, and operator \ &quot; <lb/>denotes 2D matrix convolution. <lb/>3. PL RECONSTRUCTION <lb/>The ECT reconstruction problem consists of estimating <lb/>n parameters , the radionuclide concentrations in the <lb/>slice pixels, from a data set Y E of detected counts on <lb/>the surfaces of m detectors. These counts are statisti-<lb/>cally independent and have Poisson statistics with rate <lb/>parameters given by the elements of the vector A +r, <lb/>where A is an m n matrix of rank n corresponding to <lb/>the system transition probabilities, and r is a an o -<lb/>set in the detected rates due to a random background <lb/>intensity level. In penalized likelihood (PL) reconstruc-<lb/>tion with side information, we maximize an objective <lb/>that is the sum of the Poisson data log-likelihood and <lb/>a penalty function R( ;^ ): <lb/>= argmax J(Y E ; ) <lb/>J(Y E ; ) = <lb/>h <lb/>lnf(Y E ; ) ? R( ;^ ) <lb/>i <lb/>: (4) <lb/>The term R( ;^ ) allows us to direct the reconstruc-<lb/>tion by \penalizing&quot;, via large R values, the likeli-<lb/>hood of images that are undesirable or are not in good <lb/>agreement with prior information. It is often chosen <lb/>proportional to some measure of roughness of , so <lb/>that smoother (lower variance) images than those ob-<lb/>tained via ML estimation are produced. The parameter <lb/>in (4) establishes the bias/variance operating point <lb/>(smoothness) by determining the relative importance of <lb/>maximizing lnf(Y E ; ) versus minimizing the penalty <lb/>term. <lb/>We select R( ;^ ) to implement a spatially variant <lb/>quadratic roughness penalty, where smoothness is en-<lb/>couraged inside and outside, but not across, the bound-<lb/>ary^ : <lb/>R( ;^ ) = <lb/>X <lb/>k <lb/>X <lb/>j <lb/>! kj (^ ) ( k ? j ) 2 : <lb/>(5) <lb/>The summations above are over pixels, and f! kj g is a <lb/>set of penalty weights that for xed k promote smooth-<lb/>ing within the neighborhood of the kth pixel. We use <lb/>a Gibbs weighting scheme with a rst order 2D pixel <lb/>neighborhood consisting of four adjacent neighbors. By <lb/>de nition, the weights are symmetric (! kj = ! jk ), and <lb/>! kj can be non-zero only in the neighborhood of the <lb/>kth pixel (see 6]). <lb/>The side information is encoded into these weights <lb/>as follows. Let J(^ ) be an image whose jth pixel inten-<lb/>sity is equal to the fraction of pixel j that falls inside <lb/>curve^ . Intrapixel weight ! jk (^ ) is <lb/>! jk (^ ) = <lb/>8 <lb/>&lt; <lb/>: <lb/>1 : J j (^ ) :50; J k (^ ) :50 <lb/>1 : J j (^ ) &lt; :50; J k (^ ) &lt; :50 <lb/>0 : <lb/>else <lb/>9 <lb/>= <lb/>; :(6) <lb/>Notice that only pixels more than half inside the bound-<lb/>ary included in the interior. <lb/>The image that maximizes (4) can not be found an-<lb/>alytically; therefore, an iterative method must be used. <lb/>In the sequel we use the PML-SAGE3 algorithm of 7] <lb/>to perform the maximization. This EM-type algorithm <lb/>is characterized by monotonic, fast convergence. <lb/>4. LARGE LIMIT <lb/>Next we give the limiting form of the PL reconstruction <lb/>error as gets large. In this limiting case the penalty <lb/>? R( ;^ ) (5) dominates the objective (4) forcing to <lb/>be piecewise constant over the neighborhoods de ned <lb/>by Gibbs weights w jk (^ ). In particular, when the w jk &apos;s <lb/>correspond to Gibbs weights enforcing smoothness in-<lb/>side and outside of the estimated ROI, the limitingform <lb/>of the PL objective function is <lb/>J(Y E ; ) = lnf(Y E ; ); = S^ <lb/>2 I R 2 <lb/>?1; <lb/>other <lb/>;(7) <lb/>where S^ = 1 ROI^ ; 1?1 ROI^ ] is a matrix shose columns <lb/>are indicator functions of the interior (1 ROI ) and exte-<lb/>rior (1?1 ROI ) of the ROI, and = 1 ; 2 ] are constant <lb/>levels within the interior and exterior, respectively. <lb/>In the high count regime the log likelihood ln f(Y E ; ) <lb/>is well approximated (up to additive constants) by the <lb/>Gaussian log likelihood ? 1 <lb/>2 (Y E ?A ) T ?1 (Y E ?A )? <lb/>1 <lb/>2 <lb/>P <lb/>i ln ] ii , where = diag(A ) is a diagonal matrix <lb/>with the elements of the vector A arranged along the <lb/>diagonal, and ] ii denotes the i-th diagonal element <lb/>of the matrix . Ignoring dependence of on the un-<lb/>known , the maximum of the PL objective function <lb/>(7) is attained by the constrained linear least squares <lb/>estimator^ c = S^ wherê <lb/>= (S T F S) ?1 S T A T ?1 (Y E ? r); <lb/>(8) <lb/>and F = A T ?1 A is the Fisher information matrix <lb/>associated with the emission data, and we have sup-<lb/>pressed the subscript^ from S for simplicity. <lb/>Note that^ c is an unimplementable ideal least squares <lb/>estimator since it requires the matrix which depends <lb/>on the unknown image . However, the bias and vari-<lb/>ance performance of this ideal estimator will be used <lb/>to bound the asymptotic performance of the estima-<lb/>tor (4). The bias and the covariance of this estimator <lb/>are E ^ c ] = S(S T F S) ?1 S T F ? I] and cov(^ c ) = <lb/>S(S T F S) ?1 S T . When = S the image is truly <lb/>piecewise constant over the estimated ROI and the bias <lb/>is zero. <lb/>A useful approximation to^ <lb/>c can be implemented <lb/>by replacing the unknown covariance = diag(E Y E ]) <lb/>in (8) by the empirical estimate diag(Y E ). This can be <lb/>used to initialize iterative optimization algorithms, e.g. <lb/>grouped coordinate ascent, EM, or SAGE, for nding <lb/>the true ML estimate^ of (4) when the smoothing <lb/>parameter is large. <lb/>EF method <lb/>ML method <lb/>CR Bound <lb/>0 <lb/>2 <lb/>4 <lb/>6 <lb/>8 <lb/>10 <lb/>12 <lb/>14 <lb/>16 <lb/>0 <lb/>5 <lb/>10 <lb/>15 <lb/>20 <lb/>25 <lb/>30 <lb/>35 <lb/>40 <lb/>45 <lb/>50 <lb/>Noise std (% of contrast) <lb/>Boundary std (% of mean coeff) <lb/>Stdev. of Boundary Estimates vs. MRI Noise <lb/>Figure 1: Variance of MRI boundary extraction meth-<lb/>ods as compared to the CR bound. <lb/>FBP <lb/>PL no side <lb/>PL ext side (EF) <lb/>PL ext side (ML) <lb/>−10 <lb/>−5 <lb/>0 <lb/>5 <lb/>10 <lb/>15 <lb/>0 <lb/>10 <lb/>20 <lb/>30 <lb/>40 <lb/>50 <lb/>60 <lb/>log2(beta) <lb/>Average % RMS Error <lb/>Image Reconstruction Performance <lb/>Figure 3: Average RMS reconstruction error for various <lb/>emission reconstruction methods. <lb/>5. RESULTS <lb/>We generated 400 realizations of noisy MRI and ECT <lb/>data to investigate the bias variance perfomance of <lb/>ECT uptake estimation with and without MRI side in-<lb/>formation. The ROI boundary was a quadratic spline <lb/>with K = 16 equispaced knots which is a least squares <lb/>t to an ellipse with major axis 5 pixels and minor <lb/>axis 3 pixels located at (?10; 0) pixels relative to im-<lb/>age center. The contrast for both the MRI and ECT <lb/>none <lb/>ideal <lb/>noisy <lb/>ideal limit <lb/>−60 <lb/>−50 <lb/>−40 <lb/>−30 <lb/>−20 <lb/>−10 <lb/>0 <lb/>10 <lb/>20 <lb/>0 <lb/>0.2 <lb/>0.4 <lb/>0.6 <lb/>0.8 <lb/>1 <lb/>1.2 <lb/>1.4 <lb/>1.6 <lb/>1.8 <lb/>2 <lb/>% Bias <lb/>% Std <lb/>Uptake Estimate Performance <lb/>* * <lb/>β small <lb/>β large <lb/>β large <lb/>Figure 4: Comparison of empirical standard deviation <lb/>vs. bias for no, ideal, and noisy (ML extracted) side <lb/>information. <lb/>mean images were identical: for MRI the mean inten-<lb/>sity inside the ROI was 6 in a zero mean background <lb/>while for ECT the mean intensity inside the ROI was 9 <lb/>in a background of mean 3. In both ECT and MRI im-<lb/>ages each boundary pixel was assigned mean intensity <lb/>equal to the interior mean intensity times the fraction <lb/>of the boundary pixel included inside the ROI. The <lb/>MRI spatial blurring width was equal to s = 0:75 <lb/>(approximately 19% of average ROI radius) and a spa-<lb/>tially independent Gaussian noise was added having <lb/>zero mean and standard deviation n = 0:18 (appox-<lb/>imately 3% of contrast). The ECT data was sampled <lb/>by a parallel beam tomograph corresponding to PET <lb/>projections over 64 radial bins, and 60 equispaced pro-<lb/>jection angles over 180 o . Poisson noise was added to <lb/>the ECT data by generating 10 6 Poisson realizations <lb/>of the mean intensity and adding 15% random coinci-<lb/>dences. <lb/>In Fig. 1 we show the total standard deviation of <lb/>the MRI boundary estimates, computed by summing <lb/>estimation errors over a set equispaced angular samples <lb/>of the boundary: std dev = <lb/>q P N <lb/>i=1 var(r( i )), based <lb/>on both the maximum likelihood estimator (ML) and <lb/>an edge ltering estimator (EF) discussed in 8]. Both <lb/>estimators were observed to be virtually unbiased for <lb/>noise standard deviation less than 10% of contrast. The <lb/>EF boundary extractor is a computationally much sim-<lb/>pler, but ad hoc, method as constrasted to ML which <lb/>requires iterative methods (we used a quasi-Newton <lb/>method) to solve the nonlinear least squares problem <lb/>(2). It is signi cant that both boundary extraction <lb/>methods virtually attain the CR bound on variance <lb/>(derived in 8]) over a large range of noise power. <lb/>In Figures 2a-2d we show the emission phantom, <lb/>the ltered back projection (FBP) reconstruction (FBP <lb/>Hanning lter bandwidth chosen to match = 8 smooth-<lb/>(a) <lb/>Emission Phantom <lb/>(b) <lb/>FBP Reconstruction <lb/>(c) <lb/>PL Reconstruction (No side info) <lb/>(d) <lb/>PL Reconstruction (Noisy Side Info) <lb/>Figure 2: (a) Emission phantom. (b) FBP recon corresponding to = 8. (c) PL recon, = 8, no side information. <lb/>(d) PL recon, = 8, noisy side information obtained by ML extraction. <lb/>ing of PL), the PL reconstruction ( = 8) without MRI <lb/>side information (all w ij set to 1), and PL reconstruc-<lb/>tion ( = 8) using w ij assignment based on extracted <lb/>MRI boundaries using MaximumLikelihood estimation <lb/>of^ in the spline model. All reconstructions in Figs. 2c <lb/>and 2d were performed using 60 iterations of the PML-<lb/>SAGE3 algorithm initialized with the ltered back pro-<lb/>jection image. The qualitative di erence between the <lb/>severely blurred reconstructions (b) and (c) and the <lb/>highly de ned reconstruction (d) is obvious. Figure 3 <lb/>shows quantitatively the improvement in terms of % <lb/>RMS reconstruction error as a function of de ned as <lb/>%RMS error = <lb/>P <lb/>ij ( ij ?^ ij ) 2 <lb/>P <lb/>ij <lb/>2 <lb/>ij <lb/>100: <lb/>The large-divergence of the RMS error of FBP and <lb/>PL without side informationis due to excessive smooth-<lb/>ing accross the boundary of the ROI. <lb/>Figure 4 shows empirical results for estimating the <lb/>uptake inside boundary as we vary the regulariza-<lb/>tion parameter . The uptake is de ned as the sum <lb/>of the total intensity within the ROI 1 T <lb/>ROI . Notice <lb/>that the reconstructions using ideal side information <lb/>su er from essentially no bias, and approach the the-<lb/>oretical large limit of performance, labeled \+&quot; in <lb/>Fig. 4. This limit is computed as the coordinate pair <lb/>(1 T <lb/>ROI E ^ c ]; 1 T <lb/>ROI cov(^ c )1 ROI ) where the bias and co-<lb/>variance of the two-level constrained estimator^ <lb/>c were <lb/>derived in the previous section. At all standard de-<lb/>viation levels, the bias using ideal side information is <lb/>substantially less than without side information, with <lb/>the performance gap increasing to more than a factor <lb/>of 15 as the ideal performance limit is approached. <lb/>6. CONCLUSIONS AND FUTURE WORK <lb/>We have shown that under a spline boundary model for <lb/>the MRI de ned region of interest estimators of spline <lb/>parameters can be e ectively incorporated into ECT <lb/>image reconstructions via penalized likelihood (PL) us-<lb/>ing an estimator-dependent Gibbs weighting scheme. <lb/>This approach is blind to the fact that the MRI-based <lb/>boundary estimator is noisy with approximately zero <lb/>mean and variance equal to the inverse Fisher informa-<lb/>tion matrix. A future paper will report on a technique <lb/>which modi es the penalty function in the PL objec-<lb/>tive to discount the MRI spline estimator as a function <lb/>of its variance. <lb/></body>

			<listBibl>7. REFERENCES <lb/>1] G. Gindi, M. Lee, A. Rangarajan, and G. Zubal. <lb/>Bayesian reconstruction of functional images using <lb/>anatomical information as priors. IEEE Transactions <lb/>on Medical Imaging, 12(4), December 1993. <lb/>2] V. E. Johnson. A model for segmentation and analysis <lb/>of noisy images. Journal of the American Statistical <lb/>Association, 89(425):230{241, March 1994. <lb/>3] J. H. Ahlberg. The Theory of Splines and Their Appli-<lb/>cations. Academic Press, 1967. <lb/>4] Stephen R. Titus, Alfred 0. Hero, and Je rey A. Fessler. <lb/>NMR object boundaries: B-spline modeling and es-<lb/>timator performance. In International Conference on <lb/>Acoustics, Speech, and Signal Processing, 1995. <lb/>5] W.A. Edelstein. Intrinsic signal to noise ratio in NMR <lb/>imaging. Magnetic Resonance in Medicine, 1986. <lb/>6] T. Hebert and R. Leahy. A generalized EM algorithm <lb/>for 3-D Bayesian recon struction from Poisson data us-<lb/>ing Gibbs priors. IEEE Transactions on Medical Imag-<lb/>ing, 8(2):194{202, June 1989. <lb/>7] J. A. Fessler and A.O. Hero. Penalized maximum likeli-<lb/>hood image reconstruction using space alternating gen-<lb/>eralized em algorithms. IEEE Transactions on Image <lb/>Processing, 4(10), October 1995. <lb/>8] Stephen R. Titus. Improved penalized likelihood recon-<lb/>struction of anatomically correlated emission computed <lb/>tomography data. PhD thesis, The University of Michi-<lb/>gan, Ann Arbor, December 1996. </listBibl>


	</text>
</tei>
