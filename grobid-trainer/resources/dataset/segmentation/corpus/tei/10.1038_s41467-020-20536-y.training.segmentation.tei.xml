<?xml version="1.0" ?>
<tei xml:space="preserve">
	<teiHeader>
		<fileDesc xml:id="0"/>
	</teiHeader>
	<text xml:lang="en">
			<front>ARTICLE <lb/>Extended haplotype-phasing of long-read de novo <lb/>genome assemblies using Hi-C <lb/>Zev N. Kronenberg 1,2 ✉ , Arang Rhie 3 , Sergey Koren 3 , Gregory T. Concepcion 2 , Paul Peluso 2 , <lb/>Katherine M. Munson 4 , David Porubsky 4 , Kristen Kuhn 5 , Kathryn A. Mueller 1 , Wai Yee Low 6 , <lb/>Stefan Hiendleder 6 , Olivier Fedrigo 7 , Ivan Liachko 1 , Richard J. Hall 2 , Adam M. Phillippy 3 , <lb/>Evan E. Eichler 4,8 , John L. Williams 6,9 , Timothy P. L. Smith 5 , Erich D. Jarvis 10,11 , Shawn T. Sullivan 1 &amp; <lb/>Sarah B. Kingan 2 ✉ <lb/>Haplotype-resolved genome assemblies are important for understanding how combinations <lb/>of variants impact phenotypes. To date, these assemblies have been best created with <lb/>complex protocols, such as cultured cells that contain a single-haplotype (haploid) genome, <lb/>single cells where haplotypes are separated, or co-sequencing of parental genomes in a trio-<lb/>based approach. These approaches are impractical in most situations. To address this issue, <lb/>we present FALCON-Phase, a phasing tool that uses ultra-long-range Hi-C chromatin <lb/>interaction data to extend phase blocks of partially-phased diploid assembles to chromosome <lb/>or scaffold scale. FALCON-Phase uses the inherent phasing information in Hi-C reads, <lb/>skipping variant calling, and reduces the computational complexity of phasing. Our method is <lb/>validated on three benchmark datasets generated as part of the Vertebrate Genomes Project <lb/>(VGP), including human, cow, and zebra finch, for which high-quality, fully haplotype-<lb/>resolved assemblies are available using the trio-based approach. FALCON-Phase is accurate <lb/>without having parental data and performance is better in samples with higher hetero-<lb/>zygosity. For cow and zebra finch the accuracy is 97% compared to 80-91% for human. <lb/>FALCON-Phase is applicable to any draft assembly that contains long primary contigs and <lb/>phased associate contigs. <lb/>https://doi.org/10.1038/s41467-020-20536-y <lb/>OPEN <lb/>1 Phase Genomics, Seattle, WA, USA. 2 Pacific Biosciences, Menlo Park, CA, USA. 3 Genome Informatics Section, Computational and Statistical Genomics <lb/>Branch, National Human Genome Research Institute, Bethesda, MD, USA. 4 Department of Genome Sciences, University of Washington School of Medicine, <lb/>Seattle, WA, USA. 5 US Meat Animal Research Center, ARS USDA, Clay Center, NE, USA. 6 Davies Research Centre, School of Animal and Veterinary <lb/>Sciences, The University of Adelaide, Roseworthy, SA, Australia. 7 Vertebrate Genomes Laboratory, The Rockefeller University, New York, NY, USA. 8 Howard <lb/>Hughes Medical Institute, University of Washington, Seattle, WA, USA. 9 Dipartimento di Scienze Animali, della Nutrizione e degli Alimenti, Università <lb/>Cattolica del Sacro Cuore, 29122 Piacenza, Italy. 10 Laboratory of Neurogenetics of Language, The Rockefeller University, New York, NY, USA. 11 Howard <lb/>Hughes Medical Institute, Chevy Chase, MD, USA. ✉ email: zkronenberg@pacificbiosciences.com; skingan@pacificbiosciences.com <lb/>NATURE COMMUNICATIONS | (2021) 12:1935 | https://doi.org/10.1038/s41467-020-20536-y | www.nature.com/naturecommunications <lb/>1 <lb/>1234567890():,; <lb/></front>

			<body>H <lb/>igh-quality reference genomes are an indispensable <lb/>resource for basic and applied research in biology, geno-<lb/>mics, agriculture, medicine, and many other fields 1-3 . <lb/>Technological innovations in DNA sequencing, long-range gen-<lb/>otyping, and assembly algorithms have led to rapidly declining <lb/>costs of sequencing and computation for genome assembly pro-<lb/>jects 4 . A major challenge for de novo assembly of genomes of <lb/>outbred, non-model, diploid and polyploid organisms is accurate <lb/>haplotype resolution. Most genome assemblers collapse multiple <lb/>haplotypes into a single consensus sequence to generate a pseudo-<lb/>haploid reference. Unfortunately, this process results in mosaic <lb/>haplotypes with erroneously associated variants not present in <lb/>either haplotype, with concomitant negative impacts on biological <lb/>inference 5-7 . <lb/>Four approaches to haplotype resolution in long-read diploid <lb/>genome assembly have been described. Trio binning uses short-<lb/>read sequence data of the parents to identify parent-specific k-<lb/>mers, which are then used to bin long-read sequence data of the <lb/>offspring into maternal and paternal bins 8-10 . These parent-<lb/>specific read bins can be separately assembled into two haploid <lb/>genomes, as with TrioCanu 9 or binned within the assembly <lb/>graph, as with hifiasm 10 . Trio binning provides accurate phased <lb/>assemblies but requires that samples of the parents are available, <lb/>which is often not possible. A second approach phases reads by <lb/>mapping to an existing reference genome to infer haplotypes, <lb/>followed by long-read partitioning and assembly 11-14 . Read-based <lb/>phasing methods require that a reference assembly is available <lb/>and depends on single-nucleotide variant (SNV) calling, which <lb/>has associated errors. A third approach is to use Strand-seq 15 to <lb/>sequence DNA template strands only, but not the nascent strands <lb/>that have been selectively labeled and targeted for removal. The <lb/>advantage of this method is that structural contiguity of indivi-<lb/>dual homologs is maintained, but it requires living cells and at <lb/>least one cell division with BrdU labeling, and thus is not easily <lb/>scalable for many species or individuals of a species. The fourth <lb/>approach is to separate haplotypes during the genome assembly <lb/>process as implemented by FALCON-Unzip for long reads 16 , <lb/>DipAsm for Hi-C and long reads 17 , and Supernova for short <lb/>reads 18 . The length of the phase blocks produced by these <lb/>methods are, however, limited by sequence read length and depth <lb/>of coverage in the diploid genome. <lb/>To address these issues, we developed FALCON-Phase, an <lb/>assembly processing pipeline that uses the natural intra-<lb/>chromosomal interactions identified by Hi-C to phase paternal <lb/>and maternal contigs and their associated haplotigs from a long-<lb/>read assembly of a diploid organism. A haplotig is an assembled <lb/>sequence from a single haplotype and there are typically several <lb/>haplotigs interspersed along their primary contig (Fig. 1). A <lb/>fundamental limitation of partially phased long-read assemblies is <lb/>that the phase between neighboring haplotigs is unknown. <lb/>FALCON-Phase solves this problem in an efficient fashion, not <lb/>by calling or phasing SNP variants relative to an existing refer-<lb/>ence genome, but by using the ultra-long-range (&gt;1 Mb) infor-<lb/>mation from the mapping of unique, haplotype-specific, Hi-C <lb/>read pairs 19-21 and a stochastic algorithm to establish correct <lb/>linkage between haplotigs along a contigs. <lb/>FALCON-Phase uses a partially phased contig assembly and <lb/>Hi-C data, which can be obtained for many samples, including <lb/>field-collected organisms for which trio samples may not be <lb/>available. We apply our method to PacBio long-read de novo <lb/>genome assemblies of three species with different levels of het-<lb/>erozygosity. Performance of our method is best with high het-<lb/>erozygosity samples: zebra finch (Taeniopygia guttata), and an <lb/>intersubspecies cross of Bos taurus 8,9 (a male fetus, but referred to <lb/>as cow for simplicity), achieving 97% accuracy, whereas the <lb/>lower-heterozygosity human samples have phasing accuracy of <lb/>80-91%. By applying our phasing method to contigs and scaffolds <lb/>in two separate iterations it is possible to extend haplotype <lb/>phasing to chromosomes scale. <lb/>Results <lb/>FALCON-Phase: a Hi-C haplotype-phasing tool for long-read <lb/>assemblies. FALCON-Phase inputs a partially phased long-read <lb/>assembly, such as one from FALCON-Unzip, and extends the <lb/>phasing on the contigs using Hi-C reads from the same sample. <lb/>The method leverages the higher density of cis-interactions for <lb/>Hi-C read pairs to regroup phase blocks (haplotigs) into haplo-<lb/>types along a contig 11 . First, the haplotype phase blocks are <lb/>defined by aligning the alternate haplotigs to their associated <lb/>primary contigs (Fig. 1b). Breaks (minces) in the contigs are <lb/>introduced to separate phased from unphased (collapsed haplo-<lb/>type) regions (Fig. 1c). Hi-C read pair mapping density is then <lb/>used to classify haplotype blocks that are in the same phase (same <lb/>parental homolog) along each contig (Fig. 1d, e). The assembly <lb/>sequences are then expanded by integrating the collapsed <lb/>sequences into both haplotypes to obtain two contig sets that <lb/>contain either maternal or paternal phase blocks interspersed <lb/>with the collapsed regions (Fig. 1f). Although FALCON-Phase <lb/>groups maternal and paternal sequences from the same chro-<lb/>mosomes, it is agnostic as to which parent the assembled chro-<lb/>mosomes came from. Details of the method, including equations <lb/>and algorithms, are described in the methods. <lb/>Over 90% of paternal and maternal contigs correctly phased. <lb/>We tested FALCON-Phase on three vertebrate species for which <lb/>we had trio-binned assemblies from the same data: two human <lb/>samples (HG00733 and mHomSap3), zebra finch, and cow (see <lb/>&quot;Data availability&quot;). In order to most accurately assess the per-<lb/>formance of our method, we removed errors in the starting de <lb/>novo assembly first by breaking chimeric contigs containing <lb/>sequences from different chromosomes for all samples using <lb/>visualization of Hi-C read density with Juicebox 22 . Second, for the <lb/>highest heterozygosity sample, zebra finch, it was also necessary <lb/>to run purge haplotigs 23 to remove haplotype duplications in the <lb/>primary contig set. After this assembly curation, the primary <lb/>contig assemblies ranged from ~1 to 3 Gb in size, matching the <lb/>expected haploid genome size, with contig N50 values from ~3 to <lb/>30 Mb in length and 81-88% of the genomes present in phased <lb/>haplotigs (Table 1 and Supplementary Table 1). Average alternate <lb/>haplotig assembly length, which is equivalent to average phase <lb/>block size, ranged from 188 to 452 kb (Table 1). <lb/>In the next stage, Hi-C read pairs were aligned to both the <lb/>collapsed regions and phase blocks using the software BWA-<lb/>MEM 24 . By requiring both Hi-C read pairs to have a map quality <lb/>greater than 10, we obtained a haplotype-specific set of Hi-C <lb/>reads. We found that depending on sample heterozygosity level <lb/>(Table 1), between ~11 and 44% of the Hi-C read pairs contained <lb/>haplotype-specific variants (Supplementary Table 2). A matrix <lb/>was then generated from the counts of retained Hi-C read pairs <lb/>mapping between phase blocks, and the phasing algorithm was <lb/>then applied. We assessed phasing performance of our method by <lb/>counting parental k-mers identified in Illumina sequence data <lb/>from the parents and used a stringent measure that penalized <lb/>every k-mer that was contained within an erroneous phase switch. <lb/>We ran FALCON-Phase on 64 CPUs, with 488GB RAM, and a <lb/>600GB magnetic disk. For the mHomSap3 dataset the total wall <lb/>time was 46 h and the total CPU time was 579 h. The majority of <lb/>time was spent mapping the HiC data (549 CPU hours) and <lb/>running the phasing algorithm (25 CPU hours). <lb/>Before applying FALCON-Phase, ~61-75% of the primary <lb/>contig k-mers and ~95-98% of the haplotig k-mers were <lb/></body>

			<note place="headnote">ARTICLE <lb/>NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-20536-y <lb/></note>

			<page>2 <lb/></page>

			<note place="footnote">NATURE COMMUNICATIONS | (2021) 12:1935 | https://doi.org/10.1038/s41467-020-20536-y | www.nature.com/naturecommunications <lb/></note>

			<body>Primary Contig <lb/>Haplotig 1 <lb/>Haplotig 2 <lb/>Primary Contig <lb/>Haplotig 1 <lb/>Haplotig 2 <lb/>B <lb/>A <lb/>B <lb/>A <lb/>[0,1] <lb/>[1,0] <lb/>B <lb/>A <lb/>phase block 1 <lb/>phase block 2 <lb/>B <lb/>A <lb/>a. Partially-phased long read assembly <lb/>b. Haplotig placement <lb/>c. Mincing <lb/>d. Hi-C mapping <lb/>e. Phasing <lb/>f. Emission of pseudohaplotypes with extended-phasing <lb/>Fig. 1 Overview of FALCON-Phase method. a Partially phased long-read assembly consists of primary contigs (blue) and shorter alternate haplotigs (red). <lb/>The region where a haplotig overlaps a primary contig is a phase block and is referred to as being unzipped because two haplotypes are resolved. Regions <lb/>of the primary contig without associated haplotigs are referred to as collapsed because the haplotypes have low or no heterozygosity. b A haplotig <lb/>placement file specifies primary contig coordinates where the haplotigs align. c This placement file is used to mince the primary contigs at the haplotig <lb/>alignment start and end coordinates. Mincing defines the phase blocks (A-B haplotype pairs, blue and red) and collapsed haplotypes (gray). d Hi-C read <lb/>pairs are mapped to the minced contigs and alignments are filtered to retain haplotype-specific mapping. e Phase blocks are assigned to state 0 or 1 using <lb/>the phasing algorithm. f The output of FALCON-Phase is two full-length pseudo-haplotypes for phase 0 and 1. These sequences are of similar length to the <lb/>original primary contig and the unzipped haplotypes are in phase with each other. <lb/>Table 1 Input statistics for the genomes used for FALCON-Phase. <lb/>Sample heterozygosity <lb/>Sample <lb/>Zebra finch Cow <lb/>HG00733 <lb/>mHomSap3 <lb/>Heterozygosity (%) <lb/>1.57-1.72 <lb/>0.65-0.93 <lb/>0.17-0.21 <lb/>0.25-0.26 <lb/>Contig and Hi-C summary statistics <lb/>Primary assembly length (Gb) <lb/>1.05 <lb/>2.71 <lb/>2.89 <lb/>2.88 <lb/>Primary Contig N50 (Mb) <lb/>3.48 <lb/>31.4 <lb/>26.3 <lb/>22.4 <lb/>Mean Phase Block Length (kb) <lb/>188 <lb/>452 <lb/>312 <lb/>351 <lb/>Proportion of genome unzipped (%) <lb/>87.6 <lb/>87.7 <lb/>84.0 <lb/>81.1 <lb/>Average number of Hi-C links between phase blocks on the same primary contig (pre/post) <lb/>filtering <lb/>92.5/31.5 <lb/>20.39/4.79 44.79/2.42 16.28/10.10 <lb/>Scaffold summary statistics <lb/>Number of scaffolds <lb/>30 <lb/>31 <lb/>23 <lb/>28 <lb/>Total scaffold length (Gb) <lb/>1.06 <lb/>2.64 <lb/>2.86 <lb/>2.87 <lb/>Number of gaps <lb/>740 <lb/>962 <lb/>523 <lb/>850 <lb/>Number of contigs scaffolded <lb/>797 <lb/>1040 <lb/>514 <lb/>862 <lb/>Number of unscaffolded contigs <lb/>160 <lb/>650 <lb/>351 <lb/>207 <lb/></body>

			<note place="headnote">NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-20536-y <lb/>ARTICLE <lb/></note>

			<note place="footnote">NATURE COMMUNICATIONS | (2021) 12:1935 | https://doi.org/10.1038/s41467-020-20536-y | www.nature.com/naturecommunications <lb/></note>

			<page>3 <lb/></page>

			<body>0 <lb/>500,000 <lb/>1,000,000 <lb/>0 <lb/>500,000 <lb/>1,000,000 <lb/>Contig Length <lb/>5,000,000 <lb/>10,000,000 <lb/>15,000,00 <lb/>20,000,000 <lb/>Assembly <lb/>haplotigs <lb/>primary <lb/>0 <lb/>1,000,000 <lb/>2,000,000 <lb/>0 <lb/>1,000,000 <lb/>2,000,000 <lb/>Contig Length <lb/>5,000,000 <lb/>10,000,000 <lb/>15,000,000 <lb/>20,000,000 <lb/>Assembly <lb/>phase0 <lb/>phase1 <lb/>a. <lb/>Zebra Finch FALCON-Unzip Contigs <lb/>c. <lb/>Zebra Finch FALCON-Phase Contigs <lb/>0 <lb/>100,000 <lb/>200,000 <lb/>300,000 <lb/>0 <lb/>100,000 <lb/>200,000 <lb/>300,000 <lb/>Contig Length <lb/>20,000,000 <lb/>40,000,000 <lb/>60,000,000 <lb/>80,000,000 <lb/>Assembly <lb/>haplotigs <lb/>primary <lb/>0 <lb/>100,000 <lb/>200,000 <lb/>300,000 <lb/>0 <lb/>100,000 200,000 300,000 <lb/>Contig Length <lb/>20,000,000 <lb/>40,000,000 <lb/>60,000,000 <lb/>80,000,000 <lb/>Assembly <lb/>phase0 <lb/>phase1 <lb/>f. <lb/>HG00733 FALCON-Phase Contigs <lb/>0 <lb/>1,000,000 <lb/>2,000,000 <lb/>0 <lb/>1,000,000 <lb/>2,000,000 <lb/>Contig Length <lb/>25,000,000 <lb/>50,000,000 <lb/>75,000,000 <lb/>Assembly <lb/>haplotigs <lb/>primary <lb/>0 <lb/>1,000,000 <lb/>2,000,000 <lb/>3,000,000 <lb/>0 <lb/>1,000,000 2,000,000 3,000,000 <lb/>Contig Length <lb/>25,000,000 <lb/>50,000,000 <lb/>75,000,000 <lb/>Assembly <lb/>phase0 <lb/>phase1 <lb/>b. <lb/>Cow FALCON-Unzip Contigs <lb/>d. Cow FALCON-Phase Contigs <lb/>e. HG00733 FALCON-Unzip Contigs <lb/>g. mHomSap3 FALCON-Unzip Contigs <lb/>h. mHomSap3 FALCON-Phase Contigs <lb/>0 <lb/>200,000 <lb/>400,000 <lb/>0 <lb/>200,000 <lb/>400,000 <lb/>Maternal k-mers <lb/>Paternal <lb/>k-mers <lb/>Contig Length <lb/>20,000,000 <lb/>40,000,000 <lb/>60,000,000 <lb/>80,000,000 <lb/>Assembly <lb/>haplotigs <lb/>primary <lb/>0 <lb/>200,000 <lb/>400,000 <lb/>600,000 <lb/>0 <lb/>200,000 400,000 600,000 <lb/>Maternal k-mers <lb/>Contig Length <lb/>20,000,000 <lb/>40,000,000 <lb/>60,000,000 <lb/>80,000,000 <lb/>Assembly <lb/>phase0 <lb/>phase1 <lb/>Paternal <lb/>k-mers <lb/>Paternal <lb/>k-mers <lb/>Paternal <lb/>k-mers <lb/>Fig. 2 Phasing accuracy of contigs before (left) and after applying FALCON-Phase (right) to the contigs. Parent-specific k-mer count from mother is on <lb/>the x-axis and father on the y-axis. Contig size is indicated by size of the data point and well-phased contigs lie along the axes. Unphased primary contigs <lb/>(blue) are large but contain a mixture of k-mer markers from mother and father. Haplotigs are mostly phased but shorter in length. After phasing by <lb/>FALCON-Phase, phase 0 and phase 1 contigs are of similar length to the FALCON-Unzip primary contigs and have less mixing of parental markers within <lb/>contigs. a Zebra finch contigs before phasing; b zebra finch contigs after phasing; c cow contigs before phasing; d cow contigs after phasing; e HG00733 <lb/>contigs before phasing; f HG00733 contigs after phasing; g mHomSap4 contigs before phasing; h mHomSap3 contigs after phasing. <lb/></body>

			<note place="headnote">ARTICLE <lb/>NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-20536-y <lb/></note>

			<page>4 <lb/></page>

			<note place="footnote">NATURE COMMUNICATIONS | (2021) 12:1935 | https://doi.org/10.1038/s41467-020-20536-y | www.nature.com/naturecommunications <lb/></note>

			<body>accurately phased into their paternal or maternal haplotypes <lb/>(Fig. 2a, c, e, g and Table 2; see also ref. 25 ). After applying <lb/>FALCON-Phase, the accuracy of the phasing of the new contigs <lb/>was 91-96% for cow, zebra finch, and mHomSap3 (Fig. 2b, d, f, h <lb/>and Table 2). The accuracy for the HG00733 human was lower at <lb/>80.3%, likely due to poor quality Hi-C data (see below for more <lb/>detail). In comparison, trio-binned Canu assemblies have &gt;99% <lb/>parental phasing accuracy for these genomes. We also evaluated <lb/>the phase accuracy of a supernova assembly of the <lb/>HG00733 sample and determined it to be 74% for parental <lb/>haplotypes (Supplementary Fig. 1). We also applied FALCON-<lb/>Phase to a PacBio HiFi assembly of HG002 and saw similar <lb/>performance to the other humans (Supplementary Table 3). <lb/>The FALCON-Unzip assemblies of the two human samples <lb/>had similar contiguity (primary contig N50 = 22.4 for mHom-<lb/>Sap3 and 26.3 Mb for HG00733), mean phase block length (0.351 <lb/>Mb for mHomSap3 and 0.312 Mb for HG00733), and percent of <lb/>the genome unzipped (81% for mHomSap3 and 84% for <lb/>HG00733; Table 1), although the heterozygosity for mHomSap3 <lb/>is slightly higher than for HG00733 (0.26% versus 0.21%). <lb/>Interestingly, both the absolute number and percentage of long-<lb/>range Hi-C contacts for mHomSap3 are much higher than that of <lb/>HG00733: 12M versus 4.5M Hi-C read pairs have mapping <lb/>distance greater than 100 kb (6.6% versus 3.5% of filtered reads <lb/>have &gt;100 kb mapping distance, Supplementary Table 3 and <lb/>Supplementary Fig. 2). A possible explanation for the poorer Hi-<lb/>C data of HG00733 is that it was collected from a frozen cell line <lb/>whereas the mHomSap3 Hi-C data were collected from <lb/>fresh blood. <lb/>Over 85% of paternal and maternal scaffolds correctly phased. <lb/>One set of the resulting contigs from FALCON-Phase (phase 0) <lb/>was scaffolded into chromosome-scale sequences using Proximo <lb/>Hi-C (Phase Genomics, Table 1 and Fig. 3). A second round of <lb/>phasing was performed on the scaffolds using FALCON-Phase <lb/>and performance was evaluated using parental k-mer counts in <lb/>the unphased versus phased scaffolds (Table 2). We compare the <lb/>phasing accuracy of the scaffolds before running FALCON-Phase <lb/>as a baseline to assess performance for the second round of <lb/>phasing. In the non-human samples, the unphased scaffolds had <lb/>between ~62% (zebra finch) and ~78% (cow) phasing accuracy <lb/>(Table 2); after the second round of FALCON-Phase, accuracy <lb/>increased to ~88% and ~92%, respectively (Table 2). For the <lb/>human samples, unphased scaffolds had ~63% (HG00733) and <lb/>~78% (mHomSap3) phasing accuracy. Phasing performance in <lb/>mHomSap3 was good (85% accuracy), compared to HG00733 <lb/>(74%), which had similarly bad performance for contig phasing <lb/>due to the poor quality of the Hi-C data (see above). It is <lb/>important to note that, unlike trio binning, additional informa-<lb/>tion is necessary to compile the maternal or paternal scaffold sets <lb/>as the phase 0 and phase 1 scaffolds are a mix of maternal and <lb/>paternal scaffolds. Also, sex chromosomes and other hemizygous <lb/>sequence should be treated separately from autosomes. <lb/>To independently verify the parental phasing and structural <lb/>correctness of our human scaffolds, we compared FALCON-<lb/>Phase HG0733 scaffolds to Strand-seq data from the same <lb/>individual. Only a small fraction of total length of FALCON-<lb/>Phase scaffolds genotyped discordantly as homozygous (~0.6%) <lb/>or heterozygous (~1.6%) (Supplementary Fig. 3). There were 10 <lb/>putative misassembles at the contig level, which is a commonly <lb/>observed number for FALCON-or Peregrine-based 26 assemblies <lb/>when compared to Strand-seq data 27 . The scaffolds had a phasing <lb/>switch error rate of 0.78 and a hamming distance of 36% <lb/>(Supplementary Table 4). The hamming distance reported <lb/>correlates well with the 74% phasing accuracy measured by our <lb/>k-mer counting approach for HG00733. Unfortunately, Strand-<lb/>seq data were not available for the samples with high-quality Hi-<lb/>C data so we could not assess them in the same way. <lb/>We also explored the performance of our method in the highly <lb/>heterozygous and repetitive major histocompatibility complex <lb/>(MHC) region in the mHomSap3 dataset. We identified <lb/>haplotype phase blocks using Merqury 28 in the chromosome <lb/>6 scaffold before and after running FALCON-Phase (Supple-<lb/>mentary Fig. 4). Phase blocks were large in the unphased <lb/>scaffolds: two phase blocks spanned the 4 Mb region around the <lb/>MHC with a switch between paternal and maternal haplotype <lb/>near the C4A gene. FALCON-Phase corrected this phase switch, <lb/>and the final sequence contained only a short segment of paternal <lb/>haplotype (50 kb) in an otherwise maternal phase block. This <lb/>phasing error overlaps a putative structural error in our assembly, <lb/>nested in an array of segmental duplications with greater than <lb/>99% sequence identity (Supplementary Fig. 4). Additional <lb/>orthogonal data are necessary to resolve the discrepancy between <lb/>our assembly and the hg38 reference. <lb/>Discussion <lb/>The ultimate goal of genome assembly is to faithfully represent <lb/>each chromosome in the organism from telomere-to-telomere. To <lb/>do so, assembly methods must account for sequence divergence <lb/>between homologous maternal and paternal chromosomes in <lb/>order to prevent collapsed haplotypes and false sequence dupli-<lb/>cations, which may result in incomplete or erroneous repre-<lb/>sentations of the underlying biological sequence 7,9,29 . Long-read <lb/>genome assemblers like FALCON-Unzip identify heterozygous <lb/>regions of a genome as bubbles in assembly graphs and unzip <lb/>those bubbles further by phasing and reassembling reads using <lb/>single-nucleotide variants (SNVs) 16 . However, long-read assem-<lb/>blers cannot phase entire primary contigs. To address this lim-<lb/>itation, we designed FALCON-Phase, which uses Hi-C data to <lb/>extend the phase blocks to the contig and scaffold scales. Here, we <lb/>have demonstrated that FALCON-Phase improves accuracy for <lb/>heterozygous diploid genome assemblies, without the need for <lb/>parental, population, or Strand-seq data. <lb/>Table 2 FALCON-Phase performance. <lb/>Contig phasing accuracy <lb/>Sample <lb/>Zebra finch <lb/>Cow <lb/>HG00733 <lb/>mHomSap3 <lb/>FALCON-Unzip Primary Contig Accuracy (%) <lb/>70.8 <lb/>71.0 <lb/>61.0 <lb/>75.5 <lb/>FALCON-Unzip Haplotig Accuracy (%) <lb/>94.9 <lb/>98.7 <lb/>96.2 <lb/>98.3 <lb/>FALCON-Phase Contig Accuracy (%) <lb/>91.2 <lb/>96.0 <lb/>80.3 <lb/>91.2 <lb/>Trio-binned Canu Contig Accuracy (%) <lb/>99.4 <lb/>99.4 <lb/>99.5 <lb/>99.6 <lb/>Scaffold phasing accuracy <lb/>Unphased Scaffold Accuracy (%) <lb/>64.1 <lb/>77.8 <lb/>62.9 <lb/>75.7 <lb/>FALCON-Phase Scaffold Accuracy (%) <lb/>88.4 <lb/>92.4 <lb/>73.9 <lb/>84.9 <lb/></body>

			<note place="headnote">NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-20536-y <lb/>ARTICLE <lb/></note>

			<note place="footnote">NATURE COMMUNICATIONS | (2021) 12:1935 | https://doi.org/10.1038/s41467-020-20536-y | www.nature.com/naturecommunications <lb/></note>

			<page>5 <lb/></page>

			<body>FALCON-Phase, in conjunction with long-read assembly, is <lb/>thus an attractive method for generating high-quality reference <lb/>genomes of samples for which parents are not available. This <lb/>approach should be useful for large-scale genome initiatives that <lb/>source samples of diverse origins, including invertebrate disease <lb/>vectors, agricultural pests, or threatened or endangered wild-<lb/>caught individuals. The method utilizes two technologies <lb/>common in generating highly contiguous genome assemblies: <lb/>PacBio long reads and Hi-C. While Hi-C is commonly used for <lb/>scaffolding 30,31 , our study finds that similar high-quality data can <lb/>also be used for contig or scaffold phasing. The accuracy of <lb/>phasing increases with Hi-C data quality, specifically the pro-<lb/>portion of long-range contacts greater than 100-kb. Coverage <lb/>requirements of Hi-C for phasing are similar to scaffolding, 100 <lb/>0 <lb/>5,000,000 <lb/>15,000,000 <lb/>0 <lb/>5,000,000 <lb/>15,000,000 <lb/>Scaffold Length <lb/>50,000,000 <lb/>100,000,000 <lb/>150,000,000 <lb/>Assembly <lb/>phase0 <lb/>phase1 <lb/>0 <lb/>2,500,000 <lb/>5,000,000 <lb/>7,500,000 <lb/>0 <lb/>2,500,000 5,000,000 7,500,000 <lb/>Scaffold Length <lb/>30,000,000 <lb/>60,000,000 <lb/>90,000,000 <lb/>Assembly <lb/>scaffolds <lb/>Zebra Finch Unphased Scaffolds <lb/>Zebra Finch Phased Scaffolds <lb/>0 <lb/>2,000,000 <lb/>4,000,000 <lb/>0 <lb/>2,000,000 <lb/>4,000,000 <lb/>Scaffold Length <lb/>40,000,000 <lb/>80,000,000 <lb/>120,000,000 <lb/>160,000,000 <lb/>Assembly <lb/>scaffolds <lb/>0 <lb/>2,000,000 <lb/>4,000,000 <lb/>0 <lb/>2,000,000 <lb/>4,000,000 <lb/>Scaffold Length <lb/>40,000,000 <lb/>80,000,000 <lb/>120,000,000 <lb/>160,000,000 <lb/>Assembly <lb/>phase0 <lb/>phase1 <lb/>a. <lb/>Cow Unphased Scaffolds <lb/>Cow Phased Scaffolds <lb/>b. <lb/>c. <lb/>d. <lb/>0 <lb/>250,000 <lb/>500,000 <lb/>750,000 <lb/>0 <lb/>250,000 <lb/>500,000 <lb/>750,000 <lb/>Scaffold Length <lb/>50,000,000 <lb/>100,000,000 <lb/>150,000,000 <lb/>200,000,000 <lb/>Assembly <lb/>scaffolds <lb/>0 <lb/>300,000 <lb/>600,000 <lb/>900,000 <lb/>0 <lb/>300,000 600,000 900,000 <lb/>Scaffold Length <lb/>50,000,000 <lb/>100,000,000 <lb/>150,000,000 <lb/>200,000,000 <lb/>Assembly <lb/>phase0 <lb/>phase1 <lb/>HG00733 Unphased Scaffolds <lb/>HG00733 Phased Scaffolds <lb/>e. <lb/>f. <lb/>mHomSap3 Unphased Scaffolds <lb/>mHomSap3 Phased Scaffolds <lb/>g. <lb/>h. <lb/>0 <lb/>500,000 <lb/>1,000,000 <lb/>0 <lb/>5 0 0 , 0 0 0 <lb/>1,000,000 <lb/>Contig Length <lb/>50,000,000 <lb/>100,000,000 <lb/>150,000,000 <lb/>200,000,000 <lb/>Assembly <lb/>phase0 <lb/>phase1 <lb/>0 <lb/>500,000 <lb/>1,000,000 <lb/>1,500,000 <lb/>0 <lb/>500,000 <lb/>1,000,000 <lb/>Maternal k-mers <lb/>Paternal <lb/>k-mers <lb/>Contig Length <lb/>50,000,000 <lb/>100,000,000 <lb/>150,000,000 <lb/>200,000,000 <lb/>Assembly <lb/>scaffolds <lb/>1,500,000 <lb/>Maternal k-mers <lb/>Paternal <lb/>k-mers <lb/>Paternal <lb/>k-mers <lb/>Paternal <lb/>k-mers <lb/>Fig. 3 Phasing accuracy of scaffolds before (left) and after applying FALCON-Phase (right). Parent-specific k-mers from mother are on the x-axis and <lb/>father on the y-axis. Scaffold size is indicated by size of the data point and well-phased contigs lie along the axes. Only the phase 0 contigs from FALCON-<lb/>Phase were scaffolded. Scaffolds after a second round of phasing by FALCON-Phase show greater separation, indicating each scaffold contains a higher <lb/>proportion of markers from one parent. a Zebra finch scaffolds before phasing; b zebra finch scaffolds after phasing; c cow scaffolds before phasing; d cow <lb/>scaffolds after phasing; e HG00733 scaffolds before phasing; f HG00733 scaffolds after phasing; g mHomSap4 scaffolds before phasing; h <lb/>mHomSap3 scaffolds after phasing. <lb/></body>

			<note place="headnote">ARTICLE <lb/>NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-20536-y <lb/></note>

			<page>6 <lb/></page>

			<note place="footnote">NATURE COMMUNICATIONS | (2021) 12:1935 | https://doi.org/10.1038/s41467-020-20536-y | www.nature.com/naturecommunications <lb/></note>

			<body>M reads per Gb of genome size and coverage recommendations <lb/>for PacBio long reads is at least 60-fold coverage and for PacBio <lb/>HiFi reads 30-fold coverage. A feature of FALCON-Phase is that <lb/>it can also be applied to scaffolds in order to link phased scaffold <lb/>regions. Thus, we suggest the following genome assembly work-<lb/>flow: (1) partially phased long-read assembly, (2) FALCON-Phase <lb/>on primary contigs and haplotigs, (3) scaffolding with Hi-C data, <lb/>and (4) FALCON-Phase on scaffolds. <lb/>FALCON-Phase relies on a diploid assembly that is curated as <lb/>a haploid set of primary contigs plus alternate haplotigs that are <lb/>each assigned to a primary contig. Generating a high-quality <lb/>assembly requires the removal of chimeric contigs that join <lb/>unlinked loci 22,31 in the primary assembly using tools, such as <lb/>purge haplotigs 32 , or purge_dups 33 . Any primary contig is treated <lb/>as if it were diploid and will be duplicated in the pseudo-<lb/>haplotype output. Contigs from hemizygous regions of the gen-<lb/>ome, such as the non-pseudoautosomal regions of sex chromo-<lb/>somes and mitochondrial sequences (i.e., haploid), cannot have <lb/>phase-switch errors and should be removed prior to running <lb/>FALCON-Phase or they will be duplicated as an artifact of the <lb/>method. <lb/>The phasing algorithm at the core of FALCON-Phase could be <lb/>adapted to use other long-range contact data types and higher <lb/>ploidies. The input matrix is simply a count of contacts between <lb/>all pairs of sequences in an assembly. Instead of Hi-C data, BAC-<lb/>end sequences, read clouds/linked-reads, or optical maps could be <lb/>transformed into the required input for FALCON-Phase. Hi-C <lb/>was chosen over the other technologies because it provides ultra-<lb/>range contact information (&gt;1 Mb), which enables chromosome-<lb/>scale phase blocks to be created. Similarly, the input sequences <lb/>could consist of phase blocks generated through resequencing and <lb/>variant calling, or pseudo-haplotypes generated from assemblies <lb/>of PacBio HiFi reads or Oxford Nanopore reads (see Supple-<lb/>mentary Table 3 where we apply the method to a PacBio HiFi <lb/>assembly of HG002). The simple approach of skirting variant <lb/>calling reduces the number of steps and overall runtime of <lb/>phasing pseudo-diploid assemblies. There are additional finishing <lb/>steps before the assembly is ready for genome annotation, e.g., <lb/>gap filling with a tool such as PB Jelly 34 . For these reasons, we <lb/>believe FALCON-Phase will be an important algorithmic con-<lb/>tribution to the goal of diploid, high-quality genome assemblies. <lb/>Methods <lb/>FALCON-Phase method. FALCON-Phase has three stages: (1) processing partially <lb/>phased contigs and Hi-C data; (2) application of the phasing algorithm; and (3) <lb/>emission of phased pseudo-haplotypes (Fig. 1). We implemented FALCON-Phase <lb/>using the Snakemake language to provide flexibility and pipeline robustness 35 . The <lb/>pipeline can be run interactively, on a single computer, or submitted to a cluster job <lb/>scheduler. The code is open source under a Clear BSD plus attribution license and <lb/>is available through github (https://github.com/phasegenomics/FALCON-Phase). <lb/>In stage one, the contigs are processed to identify phase blocks: regions of the <lb/>genome that have been unzipped into a maternal and paternal pair of haplotypes. <lb/>For example, FALCON-Unzip generates contiguous primary contigs representing <lb/>pseudo-haplotypes and shorter phased alternate haplotigs. A haplotig placement <lb/>file is generated in the pairwise alignment format 36 that specifies the alignment <lb/>location of each haplotig on the primary contig (Fig. 1). Briefly, haplotigs are <lb/>aligned, filtered, and processed with three utilities of the mummer v4 package: <lb/>nucmer, delta-filter, and show-coords 37 . Sub-alignments for each haplotig are <lb/>chained in one dimension to find the optimal start and end of the placement using <lb/>the coords2hp.py script. Finally, non-unique haplotig mappings and those fully <lb/>contained by other haplotigs are removed with filt_hp.py. <lb/>The haplotig placement file is used to generate three minced FASTA files <lb/>(Fig. 1), A_haplotigs.fasta, B_haplotigs.fasta, and collapsed_haplotypes.fasta. The A <lb/>haplotigs are the original haplotigs (red in Fig. 1), the B haplotigs are the <lb/>corresponding homologous region of the primary contigs (the alternate haplotype, <lb/>blue in Fig. 1c, d), and the collapsed haplotypes are the unphased or collapsed <lb/>regions of the assembly (gray in Fig. 1). The pairing of the A and B minced <lb/>haplotigs in the phase blocks and their order along the primary contig is <lb/>summarized in an index file, ov_index.txt generated by primary_contig_index.pl. <lb/>The Hi-C reads are mapped to the minced contigs using BWA-MEM, with the <lb/>Hi-C option (-5) enabled 24 . The mapped reads are streamed to SAMtools, <lb/>removing unmapped, secondary, and supplementary alignments (SAMtools -F <lb/>2316) 38 . This operation ensures that each mate-pair only contains two alignment <lb/>records. In the last step of read processing, a map quality score filter of Q10 (for <lb/>both reads) is applied, removing reads without haplotype-specific sequence. <lb/>Additionally, we set an edit distance from the reference of less than 5 for both <lb/>reads. Both more stringent (60) and relaxed (0) map quality filtering resulted in <lb/>lower phasing accuracy. <lb/>The Hi-C mate-pair counts between minced contigs are enumerated into a <lb/>contact matrix, M. Each element, M i,j , in the matrix is later normalized by the <lb/>number of Hi-C restriction enzyme sites, z, in both the ith and jth minced contigs <lb/>as shown in Eq. (1). The raw count matrix is encoded into a binary matrix format. <lb/>Mi;j :¼ <lb/>M i;j <lb/>z i þ z j <lb/>ð1Þ <lb/>We designed an algorithm to extend phasing between haplotig phase blocks <lb/>based on Hi-C read pair mapping. The algorithm searches for the optimum set of <lb/>phase block configurations along a primary contig using a stochastic model. The <lb/>algorithm is given a list, C, of tuples for the phase blocks and their sequential <lb/>ordering along each primary contig. During initialization, each member of the <lb/>phase block, except the first, is randomly assigned one of the two possible phase <lb/>configurations for a diploid organism ∈({[0, 1],[1, 0]}). The phase assignment is <lb/>stored in array T where 0 corresponds to phase configuration [0, 1]. The first phase <lb/>block along the primary contig is always assigned to the phase configuration [0, 1] <lb/>as its orientation is arbitrary. By fixing the first phase block, the search results are <lb/>comparable across iterations. Phase blocks are only randomly initialized once <lb/>before the search begins. The algorithm sweeps along the phase blocks of each <lb/>primary contig, assigning a phase for the blocks, conditioned on the phase <lb/>assignment of all previous phase blocks and the Hi-C links between them. The <lb/>phaseFreq function (Eq. 2) calculates the frequency of Hi-C links from the current <lb/>region, i, to all past regions, j, that have the same phase, i.e., T i = T j = 1 = [1, 0]. <lb/>phaseFreqði; T; M; CÞ ¼ <lb/>P j&lt;i <lb/>j¼0 γ i; j <lb/>ð Þ*αði; jÞ <lb/>P j&lt;i <lb/>j¼0 βði; jÞ <lb/>ð2Þ <lb/>The phaseFreq function takes the index of the current phase block, i, the phase <lb/>assignment of all regions associated with a given primary contig, array T, the <lb/>normalized Hi-C count matrix, M, and the C array of the phase block tuples. The <lb/>gamma function (Eq. 3) determines if two phase blocks have the same phase <lb/>assignment, T, and if so returns 1. The alpha function (Eq. 4) gives the normalized <lb/>cis counts of Hi-C links between a pair of phase blocks whereas the beta function <lb/>(Eq. 5) returns both the cis and trans counts, which is a normalizing constant. <lb/>γ i; j <lb/>ð Þ ¼ <lb/>1; T i <lb/>½ ¼ T½j <lb/>0; T i <lb/>½ ≠ T½j <lb/>&amp; <lb/>ð3Þ <lb/>α i; j; M; C <lb/>À <lb/>Á <lb/>¼ M C i; 0 <lb/>½ ; C j; 1 <lb/>½ <lb/>½ <lb/>þ M C i; 1 <lb/>½ ; C j; 0 <lb/>½ <lb/>½ <lb/>ð4Þ <lb/>β i; j; M; C <lb/>À <lb/>Á <lb/>¼ M C i; 0 <lb/>½ ; C j; 0 <lb/>½ <lb/>½ <lb/>þ M C i; 1 <lb/>½ ; C j; 1 <lb/>½ <lb/>½ <lb/>þ M C i; 0 <lb/>½ ; C j; 1 <lb/>½ <lb/>½ <lb/>þ M C i; 1 <lb/>½ ; C j; 0 <lb/>½ <lb/>½ <lb/>ð5Þ <lb/>The process of phase assignment across a primary contig is iterated for a burn-<lb/>in period followed by a scoring period (see Algorithm 1). The only difference <lb/>between the two stages is that the scoring stage enumerates the number of <lb/>iterations that each member of the phase block spends in phase 1 [1, 0]. We found <lb/>by ignoring several million iterative sweeps over a primary contig, the algorithm <lb/>tends to be in a more favorable search space. The final phase assignment is the <lb/>configuration in which each member of a phase block spent the most iterations. In <lb/>practice, 50-100 M iterations with 10 M burn-in period generated consistent <lb/>results. The limiting computational resource is memory as ( M) is not sparse. <lb/>Algorithm 1. <lb/>Phasing procedure <lb/>Data: normalized HiC count matrix ( M), contig overlap index array (C), number of <lb/>permutations (n) and burn in (b) <lb/>Result: (R) array, the phase of the A-B haplotig pairs is ε {0,1} <lb/>m ← length of C-1 <lb/>R ≡ result array of length of C <lb/>T ≡ temporary phase array of length of C <lb/>P ≡ state count array (T[i] = 1) of length C <lb/>if length of C ==1 then <lb/>return R[0] ← random (ε {0.1}) <lb/>end <lb/>for j ← 0 to m do <lb/>R[j] ← T[j] ← random (ε{0.1}) <lb/>P[j] ← 0; <lb/>end <lb/>for i ← 0 to n do <lb/>for j ← 0 to m do <lb/>T[j] ← 1; <lb/>if phaseFreq (j, T, M, C) &lt; runif (⬚) then <lb/></body>

			<note place="headnote">NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-20536-y <lb/>ARTICLE <lb/></note>

			<note place="footnote">NATURE COMMUNICATIONS | (2021) 12:1935 | https://doi.org/10.1038/s41467-020-20536-y | www.nature.com/naturecommunications <lb/></note>

			<page>7 <lb/></page>

			<body>T[j] ← 0; <lb/>end <lb/>if i &gt; band T[j] = 1 then <lb/>P[j] ← P[j] + 1 <lb/>end <lb/>end <lb/>end <lb/>for j ← 0 to m do <lb/>R[j] ← 1; <lb/>if P j <lb/>½ <lb/>ðnÀbÞ &lt; 0:5 then <lb/>R[j] ← 0; <lb/>end <lb/>end <lb/>Return R <lb/>Once the phase assignments of haplotype pairs in the phase blocks are <lb/>determined, the minced fasta sequences are joined into two full-length <lb/>pseudo-haplotypes (phase 0 and phase 1) per primary contig (Fig. 1). The <lb/>order of minced sequences (phase blocks plus collapsed regions) is determined <lb/>by the haplotig placement file and the phase assignment is determined by the <lb/>phasing algorithm. An alternate output similar to the FALCON-Unzip format <lb/>of primary contigs and haplotigs is also available as a user-specified option. <lb/>Users can specify pseudo-haplotype or unzip output formats, the former <lb/>having the same collapsed sequence in both pseudo-haplotypes, the latter <lb/>matching the FALCON-Unzip assembly output format (primary contigs plus <lb/>haplotigs). <lb/>We scaffolded the contigs from FALCON-Phase for the non-human datasets <lb/>using default Proximo 30,39 settings (Phase Genomics, WA). Briefly, reads were <lb/>aligned to phase 0 pseudo-haplotypes using BWA-MEM 40 (v. 0.7.15-r1144-<lb/>dirty) with the -5SP and -t 8 options. SAMBLASTER 41 (commit <lb/>37142b37e4f0026e1b83ca3f1545d1807ef77617) was used to flag PCR duplicates, <lb/>which were later excluded from analysis. Alignments were then filtered with <lb/>SAMtools (v1.5, with htslib 1.5) using the -F 2304 filtering flag to remove non-<lb/>primary and supplementary alignments, as well as read pairs in which one or <lb/>more mates were unmapped. The Phase Genomics Proximo Hi-C genome <lb/>scaffolding platform (commit 145c01be162be85c060c567d576bb4786496c032) <lb/>was used to create chromosome-scale scaffolds from the draft assembly as <lb/>previously described 39 . As in the LACHESIS method 30 , this process computes a <lb/>contact frequency matrix from the aligned Hi-C read pairs, normalized by the <lb/>number of restriction sites on each contig, and constructs scaffolds in such a way <lb/>as to optimize expected contact frequency and other statistical patterns in Hi-C <lb/>data. Juicebox v1.8.8 was used to correct scaffolding errors 22,42 . After <lb/>scaffolding, we applied the phasing algorithm a second time, using as input the <lb/>pairing of the phase 0 and phase 1 pseudo-haplotypes and their order along the <lb/>chromosomes as determined by scaffolding. <lb/>We evaluated FALCON-Phase on three vertebrate species with different levels <lb/>of heterozygosity: The VGP zebra finch female trio (T. guttata, high); the male <lb/>bovine trio (B. taurus taurus × B. taurus indicus moderate); Puerto Rican human <lb/>female trio, (HG00733, low); the VGP admixed human male trio (mHomSap3, <lb/>low). For each genome, we had high-coverage PacBio CLR data for de novo <lb/>genome assembly, Hi-C data for phasing and scaffolding, paired-end Illumina data <lb/>from the parents, and trio-binned Canu assemblies (see &quot;Data availability&quot;). <lb/>Heterozygosity was estimated two ways. First, from k-mers (k-length sequence) <lb/>in Illumina whole-genome sequencing reads (see &quot;Data availability&quot;). Fastq files <lb/>were converted to fasta files, then the canonical k-mers were collected using meryl <lb/>in canu 1.7 (ref. 9 ) to include all the high frequency k-mers using the <lb/>following code. <lb/>meryl -B -C -s $name.fa -m $k_size -o $name.$k <lb/>meryl -Dh -s $name.$k &gt; $name.$k.hist <lb/>Given the k-mer histogram, Genomescope 43 was used to estimate the level of <lb/>heterozygosity. k = 21 was used for HG00733 and cow, and k = 31 was used for the <lb/>zebra finch and mHomSap3. A higher k-mer size was used for zebra finch for more <lb/>accurate estimates of heterozygosity due to its higher level of polymorphism. This <lb/>k-mer size was also used for other samples in the VGP, from which this sample was <lb/>selected. Second, with mummer v 3.2.3 (ref. 44 ), trio-binned parental Canu <lb/>assemblies were aligned with nucmer (nucmer -l 100 -c 500 -maxmatch mom.fasta <lb/>dad.fasta) and heterozygosity was computed as 1-average identity from 1 to 1 <lb/>alignments output by dnadiff using default parameters. <lb/>As a precursor to FALCON-Phase, we performed de novo genome assembly <lb/>with FALCON-Unzip 16 using pb-assembly from pbbioconda (v 0.0.6 for <lb/>mHomSap3, v 0.0.2 for zebra finch and cow) and a binary build from13 August <lb/>2018, for HG00733. <lb/>Zebra finch parameters: (length_cutoff = 13,653; length_cutoff_pr = 5000; <lb/>pa_daligner_option = -e0.76 -l2,000 -k18 -h70 -w8 -s100; ovlp_daligner_option <lb/>= -k24 -h1024 -e.95 -l1800 -s100; pa_HPCdaligner_option = -v -B128 -M24; <lb/>ovlp_HPCdaligner_option = -v -B128 -M24; pa_HPCTANmask_option = -k18 <lb/>-h480 -w8 -e.8 -s100; pa_HPCREPmask_option = -k18 -h480 -w8 -e.8 -s100; <lb/>pa_DBsplit_option = -x500 -s400; ovlp_DBsplit_option = -s400; <lb/>falcon_sense_option =-output-multi-min-idt 0.70-min-cov 2-max-n-read 400-n-<lb/>core 24; overlap_filtering_setting =-max-diff 100-max-cov 150-min-cov 2-n-<lb/>core 24) <lb/>Cow parameters: (length_cutoff = 14,850; length_cutoff_pr = 12000; <lb/>pa_daligner_option = -e0.76 -l1200 -k18 -h480 -w8 -s100; ovlp_daligner_option <lb/>= -k24 -h480 -e.95 -l1800 -s100; pa_HPCdaligner_option = -v -B128 -M24; <lb/>ovlp_HPCdaligner_option = -v -B128 -M24; pa_HPCTANmask_option = -k18 <lb/>-h480 -w8 -e.8 -s100; pa_HPCREPmask_option = -k18 -h480 -w8 -e.8 -s100; <lb/>pa_DBsplit_option = -x500 -s400; ovlp_DBsplit_option = -s400; <lb/>falcon_sense_option = -output_multi-min_idt 0.70-min_cov 4-max_n_read <lb/>200-n_core 24; overlap_filtering_setting = -max_diff 120-max_cov 120-min_cov <lb/>4-n_core 24) <lb/>mHomSap3 parameters: (length_cutoff = 20,375; length_cutoff_pr = 10,000; <lb/>pa_daligner_option = -k18 -e0.8 -l1000 -h256 -w8 -s100; ovlp_daligner_option <lb/>= -k24 -e.92 -l1000 -h1024 -s100; pa_HPCdaligner_option = -v -B128 -M24; <lb/>ovlp_HPCdaligner_option = -v -B128 -M24; pa_HPCTANmask_option = -k18 <lb/>-h480 -w8 -e.8 -s100; pa_HPCREPmask_option = -k18 -h480 -w8 -e.8 -s100; <lb/>pa_DBsplit_option = -x500 -s400; ovlp_DBsplit_option = -s400; <lb/>falcon_sense_option =-output-multi-min-idt 0.70-min-cov 3-max-n-read 100-n-<lb/>core 4; falcon_sense_skip_contained = False; overlap_filtering_setting = -max-diff <lb/>60-max-cov 60-min-cov 2-n-core 12). <lb/>HG00733 parameters: (length_cutoff = 5000; length_cutoff_pr = 10,000; <lb/>pa_daligner_option = -k18 -e0.75 -l1200 -h256 -w8 -s100; ovlp_daligner_option <lb/>= -k24 -e.92 -l1800 -h600 -s100; pa_HPCdaligner_option = -v -B128 -M24; <lb/>ovlp_HPCdaligner_option = -v -B128 -M24; pa_HPCTANmask_option = -k18 <lb/>-h480 -w8 -e.8 -s100; pa_HPCREPmask_option = -k18 -h480 -w8 -e.8 -s100; <lb/>pa_DBsplit_option = -x500 -s400; ovlp_DBsplit_option = -s400; <lb/>falcon_sense_option =-output-multi-min-idt 0.70-min-cov 4-max-n-read 200-n-<lb/>core 8; falcon_sense_skip_contained = False; overlap_filtering_setting =-max-diff <lb/>60-max-cov 60-min-cov 1-n-core 12). <lb/>We identified and corrected chimeric contigs between nonadjacent genomic <lb/>regions in HG00733, mHomSap, and cow assemblies using Juicebox Assembly <lb/>Tools 22 and D-GENIES 45 . We interrogated the concordance of the Hi-C data with <lb/>the PGA scaffolds visually in JBAT. Off-diagonal signals in the heatmap of Hi-C <lb/>read density are indicative of contig/scaffolding errors. Human and cow contigs <lb/>and scaffolds with discordant Hi-C signals were aligned, using minimap2 with the <lb/>-x asm5 setting, to the human or cow reference genomes. If the contig/scaffold in <lb/>question mapped chimerically (inter-or intra-chromosomally) to each genome, <lb/>they were flagged. We manually broke these contigs between phase blocks and <lb/>reassociated the haplotigs to the two new contigs. <lb/>To remove duplicated haplotypes in the primary contigs from the zebra finch <lb/>FALCON-Unzip assembly, as suggested for highly heterozygous genomes from the <lb/>VGP 46 , we ran purge haplotigs 23 on zebra finch using default settings and coverage <lb/>estimates from PacBio subreads mapped to the primary contigs 23 . We <lb/>recategorized 67.1 Mb of primary contigs as haplotigs (N = 632) and 25.4 Mb of <lb/>repetitive sequences (N = 329) were discarded. <lb/>To evaluate phase assignment, parent-specific k-mers were counted in the <lb/>pseudo-haplotypes before and after contig phasing, before and after scaffold <lb/>phasing, and in trio-binned Canu assemblies. Parental k-mers were identified using <lb/>Illumina data from the parents 9 using k = 21. Parental k-mers were counted in the <lb/>assemblies using the simple-dump utility from Canu v1.7. The proportion of <lb/>correct parental k-mers was used as an overall measure of contig or scaffold <lb/>phasing and was plotted for each contig or scaffold in Fig. 2. <lb/>To evaluate the structural contiguity of FALCON-Phase scaffolds we aligned <lb/>available Strand-seq data 47 to the HG00733 scaffolds. We used breakpointR 48 in <lb/>order to detect regions that are consistently genotyped as &quot;HOM&quot; (majority of <lb/>reads in minus direction) or &quot;HET&quot; (mixture of plus and minus reads) across all <lb/>Strand-seq libraries. Regions genotyped as HOM suggest a homozygous inversion <lb/>or misorientation, while regions genotyped as HET points to either a heterozygous <lb/>inversion, chimerism, or collapsed repetitive region. Phasing accuracy was <lb/>evaluated using SNVs detected based on alignments of contig stage assemblies to <lb/>GRCh38 using minimap2 (version 2.17). We evaluate phasing accuracy of our <lb/>assemblies in comparison to trio-based phasing for HG00733 (ref. 47 ). We compare <lb/>only SNV positions that are shared between phased assemblies and those from trio-<lb/>based phasing. Then the switch error rate and Hamming distance were calculated <lb/>as described in Porubsky et al. 49 . <lb/></body>

			<div type="annex">Reporting summary. Further information on research design is available in the Nature <lb/>Research Reporting Summary linked to this article. <lb/></div>

			<div type="availability">Data availability <lb/>Zebra finch PacBio long reads, Hi-C data, parental short-read data, triobinned parental <lb/>Canu assemblies: [https://vgp.github.io/genomeark/Taeniopygia_guttata/]. FALCON-<lb/>Unzip contigs: [https://www.ncbi.nlm.nih.gov/bioproject/PRJNA604785], [https://www. <lb/>ncbi.nlm.nih.gov/bioproject/PRJNA604786]. FALCON-Phase contigs: [https://www.ncbi. <lb/>nlm.nih.gov/bioproject/PRJNA604789], [https://www.ncbi.nlm.nih.gov/bioproject/ <lb/>PRJNA604788]. FALCON-Phase scaffolds: [https://www.ncbi.nlm.nih.gov/bioproject/ <lb/>PRJNA604793], [https://www.ncbi.nlm.nih.gov/bioproject/PRJNA604794]. <lb/>Cow PacBio long reads, Hi-C data, parental short-read data, triobinned parental canu <lb/>assemblies: [https://www.ncbi.nlm.nih.gov/bioproject/PRJNA432857]. FALCON-Unzip <lb/>contigs: [https://www.ncbi.nlm.nih.gov/bioproject/PRJNA604814], [https://www.ncbi. <lb/>nlm.nih.gov/bioproject/PRJNA604813]. FALCON-Phase contigs: [https://www.ncbi.nlm. <lb/></div>

			<note place="headnote">ARTICLE <lb/>NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-20536-y <lb/></note>

			<page>8 <lb/></page>

			<note place="footnote">NATURE COMMUNICATIONS | (2021) 12:1935 | https://doi.org/10.1038/s41467-020-20536-y | www.nature.com/naturecommunications <lb/></note>

			<div type="availability">nih.gov/bioproject/PRJNA604823], [https://www.ncbi.nlm.nih.gov/bioproject/ <lb/>PRJNA604824]. FALCON-Phase scaffolds: [https://www.ncbi.nlm.nih.gov/bioproject/ <lb/>PRJNA604826], [https://www.ncbi.nlm.nih.gov/bioproject/PRJNA604827]. <lb/>HG00733 PacBio long reads: [https://www.ncbi.nlm.nih.gov/sra/SRR7615963]. Hi-C <lb/>data: [https://www.ncbi.nlm.nih.gov/sra/ERR1225141], [https://www.ncbi.nlm.nih.gov/ <lb/>sra/ERR1225146]. Parental short-read data: [https://www.ncbi.nlm.nih.gov/bioproject/ <lb/>PRJNA42573]. Triobinned parental canu assemblies: [https://obj.umiacs.umd.edu/ <lb/>marbl_publications/triobinning/h_sapiens_HG00733_dad.fasta], <lb/>[https://obj.umiacs.umd.edu/marbl_publications/triobinning/ <lb/>h_sapiens_HG00733_mom.fasta]. FALCON-Unzip contigs: [https://www.ncbi.nlm.nih. <lb/>gov/bioproject/PRJNA604844], [https://www.ncbi.nlm.nih.gov/bioproject/ <lb/>PRJNA604843]. FALCON-Phase contigs: [https://www.ncbi.nlm.nih.gov/bioproject/ <lb/>PRJNA604845], [https://www.ncbi.nlm.nih.gov/bioproject/PRJNA604846]. FALCON-<lb/>Phase scaffolds: [https://www.ncbi.nlm.nih.gov/assembly/GCA_003634875.1] <lb/>mHomSap3 PacBio long reads, Hi-C data, parental short-read data: [https://vgp. <lb/>github.io/genomeark/Homo_sapiens/]. Triobinned parental canu assemblies: [https:// <lb/>genomeark.s3.amazonaws.com/species/Homo_sapiens/mHomSap3/ <lb/>assembly_nhgri_trio_1.6/intermediates/mHomSap3_mat_t1.fasta.gz], [https:// <lb/>genomeark.s3.amazonaws.com/species/Homo_sapiens/mHomSap3/ <lb/>assembly_nhgri_trio_1.6/intermediates/mHomSap3_pat_t1.fasta.gz]. FALCON-Unzip <lb/>contigs: [https://www.ncbi.nlm.nih.gov/bioproject/PRJNA604831], [https://www.ncbi. <lb/>nlm.nih.gov/bioproject/PRJNA604832]. FALCON-Phase contigs: [https://www.ncbi.nlm. <lb/>nih.gov/bioproject/PRJNA604836], [https://www.ncbi.nlm.nih.gov/bioproject/ <lb/>PRJNA604835]. FALCON-Phase scaffolds: [https://www.ncbi.nlm.nih.gov/bioproject/ <lb/>PRJNA604839], [https://www.ncbi.nlm.nih.gov/bioproject/PRJNA604838]. <lb/>HG002 PacBio HiFi Reads: [https://www.ncbi.nlm.nih.gov/sra/SRR10382244], <lb/>[https://www.ncbi.nlm.nih.gov/sra/SRR10382245], [https://www.ncbi.nlm.nih.gov/sra/ <lb/>SRR10382248], [https://www.ncbi.nlm.nih.gov/sra/SRR10382249]. Hi-C data: [https:// <lb/>github.com/human-pangenomics/HG002_Data_Freeze_v1.0]. Parental short-read data: <lb/>[ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/AshkenazimTrio/HG004_NA24143_ <lb/>mother/NIST_Illumina_2x250bps/reads/], [ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/ <lb/>data/AshkenazimTrio/HG003_NA24149_father/NIST_Illumina_2x250bps/reads/]. IPA <lb/>contigs:[https://www.ncbi.nlm.nih.gov/bioproject/PRJNA667512], [https://www.ncbi. <lb/>nlm.nih.gov/bioproject/PRJNA667511]. FALCON-Phase contigs: [https://www.ncbi.nlm. <lb/>nih.gov/bioproject/PRJNA667513], [https://www.ncbi.nlm.nih.gov/bioproject/ <lb/>PRJNA667514]. <lb/></div>

			<div type="availability">Code availability <lb/>The FALCON-Phase code is open source and available under The Clear BSD + <lb/>Attribution License: https://github.com/phasegenomics/FALCON-Phase. <lb/></div>

			<front>Received: 13 May 2020; Accepted: 12 November 2020; <lb/></front>

			<listBibl>References <lb/>1. Kronenberg, Z. N. et al. High-resolution comparative analysis of great ape <lb/>genomes. Science https://doi.org/10.1126/science.aar6343 (2018). <lb/>2. English, A. C. et al. Assessing structural variation in a personal genome-<lb/>towards a human reference diploid genome. BMC Genomics https://doi.org/ <lb/>10.1186/s12864-015-1479-3 (2015). <lb/>3. Merker, J. D. et al. Long-read genome sequencing identifies causal structural <lb/>variation in a Mendelian disease. Genet. Med. https://doi.org/10.1038/ <lb/>gim.2017.86 (2018). <lb/>4. Sedlazeck, F. J., Lee, H., Darby, C. A. &amp; Schatz, M. C. Piercing the dark matter: <lb/>bioinformatics of long-range sequencing and mapping. Nat. Rev. Genet. <lb/>https://doi.org/10.1038/s41576-018-0003-4 (2018). <lb/>5. Church, D. M. et al. Extending reference assembly models. Genome Biol. <lb/>https://doi.org/10.1186/s13059-015-0587-3 (2015). <lb/>6. Church, D. M. et al. Modernizing reference genome assemblies. PLoS Biol. <lb/>https://doi.org/10.1371/journal.pbio.1001091 (2011). <lb/>7. Korlach, J. et al. De novo PacBio long-read and phased avian genome <lb/>assemblies correct and add to reference genes generated with intermediate and <lb/>short reads. Gigascience 6, 1-17 (2017). <lb/>8. Low, W. Y. et al. Haplotype-resolved genomes provide insights into structural <lb/>variation and gene content in Angus and Brahman cattle. Nat. Commun. <lb/>https://doi.org/10.1038/s41467-020-15848-y (2020). <lb/>9. Koren, S. et al. De novo assembly of haplotype-resolved genomes with trio <lb/>binning. Nat. Biotechnol. https://doi.org/10.1038/nbt.4277 (2018). <lb/>10. Cheng, H., Concepcion, G. T., Feng, X., Zhang, H. &amp; Li, H. Haplotype-<lb/>resolved de novo assembly with phased assembly graphs. Preprint at https:// <lb/>arxiv.org/abs/2008.01237 (2020). <lb/>11. Selvaraj, S., Dixon, J. R., Bansal, V. &amp; Ren, B. Whole-genome haplotype <lb/>reconstruction using proximity-ligation and shotgun sequencing. Nat. <lb/>Biotechnol. https://doi.org/10.1038/nbt.2728 (2013). <lb/>12. Bansal, V., Halpern, A. L., Axelrod, N. &amp; Bafna, V. An MCMC algorithm for <lb/>haplotype assembly from whole-genome sequence data. Genome Res. https:// <lb/>doi.org/10.1101/gr.077065.108 (2008). <lb/>13. Chaisson, M. J. P. et al. Resolving the complexity of the human genome using <lb/>single-molecule sequencing. Nature 517, 608-611 (2014). <lb/>14. Patterson, M. et al. WhatsHap: weighted haplotype assembly for future-<lb/>generation sequencing reads. J. Comput. Biol. 22, 498-509 (2015). <lb/>15. Falconer, E. et al. DNA template strand sequencing of single-cells maps <lb/>genomic rearrangements at high resolution. Nat. Methods https://doi.org/ <lb/>10.1038/nmeth.2206 (2012) <lb/>16. Chin, C. S. et al. Phased diploid genome assembly with single-molecule real-<lb/>time sequencing. Nat. Methods https://doi.org/10.1038/nmeth.4035 (2016). <lb/>17. Garg, S. et al. Chromosome-scale, haplotype-resolved assembly of human <lb/>genomes. Nat Biotechnol. https://doi.org/10.1038/s41587-020-0711-0 (2020). <lb/>18. Weisenfeld, N. I., Kumar, V., Shah, P., Church, D. M. &amp; Jaffe, D. B. Direct <lb/>determination of diploid genome sequences. Genome Res. https://doi.org/ <lb/>10.1101/gr.214874.116 (2017). <lb/>19. Patterson, M. et al. WhatsHap: Haplotype assembly for future-generation <lb/>sequencing reads. In Lecture Notes in Computer Science (including subseries <lb/>Lecture Notes in Artificial Intelligence and Lecture Notes in Bioinformatics) <lb/>(Springer, 2014). <lb/>20. Edge, P., Bafna, V. &amp; Bansal, V. HapCUT2: Robust and accurate haplotype <lb/>assembly for diverse sequencing technologies. Genome Res. https://doi.org/ <lb/>10.1101/gr.213462.116 (2017). <lb/>21. Lieberman-Aiden, E. et al. Comprehensive mapping of long-range interactions <lb/>reveals folding principles of the human genome. Science https://doi.org/ <lb/>10.1126/science.1181369 (2009). <lb/>22. Durand, N. C. et al. Juicebox provides a visualization system for Hi-C contact <lb/>maps with unlimited zoom. Cell Syst. https://doi.org/10.1016/j. <lb/>cels.2015.07.012 (2016). <lb/>23. Roach, M. J., Schmidt, S. A. &amp; Borneman, A. R. Purge Haplotigs: synteny <lb/>reduction for third-gen diploid genome assemblies. https://www.biorxiv.org/ <lb/>content/10.1101/286252v1 (2018). <lb/>24. Li, H. Aligning sequence reads, clone sequences and assembly contigs with <lb/>BWA-MEM. Preprint at https://arxiv.org/abs/1303.3997arXiv (2013). <lb/>25. Fungtammasan, A. &amp; Hannigan, B. How well can we create phased, diploid, <lb/>human genomes?: An assessment of FALCON-Unzip phasing using a <lb/>human trio. Preprint at https://www.biorxiv.org/content/10.1101/262196v1 <lb/>(2018). <lb/>26. Chin, C.-S. &amp; Khalak, A. Human genome assembly in 100 minutes. Preprint at <lb/>https://www.biorxiv.org/content/10.1101/705616v1 (2019). <lb/>27. Porubsky, D. et al. A fully phased accurate assembly of an individual human <lb/>genome. Preprint at https://www.biorxiv.org/content/10.1101/855049v1 <lb/>(2019). <lb/>28. Rhie, A., Walenz, B. P., Koren, S. &amp; Phillippy, A. M. Merqury: Reference-free <lb/>quality, completeness, and phasing assessment for genome assemblies. <lb/>Genome Biol. https://doi.org/10.1186/s13059-020-02134-9 (2020). <lb/>29. Korlach, J. et al. De Novo PacBio long-read and phased avian genome <lb/>assemblies correct and add to genes important in neuroscience research. <lb/>Gigascience 6, 1-16 (2017). <lb/>30. Burton, J. N. et al. Chromosome-scale scaffolding of de novo genome <lb/>assemblies based on chromatin interactions. Nat. Biotechnol. https://doi.org/ <lb/>10.1038/nbt.2727 (2013). <lb/>31. Ghurye, J., Pop, M., Koren, S., Bickhart, D. &amp; Chin, C. S. Scaffolding of long <lb/>read assemblies using long range contact information. BMC Genomics. https:// <lb/>doi.org/10.1186/s12864-017-3879-z (2017). <lb/>32. Roach, M. J., Schmidt, S. A. &amp; Borneman, A. R. Purge Haplotigs: Allelic contig <lb/>reassignment for third-gen diploid genome assemblies. BMC Bioinformatics <lb/>https://doi.org/10.1186/s12859-018-2485-7 (2018). <lb/>33. Guan, D. et al. Identifying and removing haplotypic duplication in primary <lb/>genome assemblies. Bioinformatics https://doi.org/10.1093/bioinformatics/ <lb/>btaa025 (2020). <lb/>34. English, A. C. et al. Mind the Gap: Upgrading genomes with Pacific <lb/>Biosciences RS Long-Read Sequencing Technology. PLoS ONE https://doi.org/ <lb/>10.1371/journal.pone.0047768 (2012). <lb/>35. Köster, J. &amp; Rahmann, S. Snakemake-a scalable bioinformatics workflow <lb/>engine. Bioinformatics https://doi.org/10.1093/bioinformatics/bts480 (2012). <lb/>36. Li, H. Minimap2: pairwise alignment for nucleotide sequences, Bioinformatics <lb/>34, 3094-3100 (2018). <lb/>37. Marçais, G. et al. MUMmer4: a fast and versatile genome alignment system. <lb/>PLoS Comput. Biol. https://doi.org/10.1371/journal.pcbi.1005944 (2018). <lb/>38. Li, H. et al. The sequence alignment/map format and SAMtools. <lb/>Bioinformatics 25, 2078-2079 (2009). <lb/>39. Bickhart, D. M. et al. Single-molecule sequencing and chromatin <lb/>conformation capture enable de novo reference assembly of the domestic goat <lb/>genome. Nat. Genet. https://doi.org/10.1038/ng.3802 (2017). <lb/>40. Li, H. Toward better understanding of artifacts in variant calling from high-<lb/>coverage samples. Bioinformatics 30, 2843-2851 (2014). <lb/></listBibl>

			<note place="headnote">NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-20536-y <lb/>ARTICLE <lb/></note>

			<note place="footnote">NATURE COMMUNICATIONS | (2021) 12:1935 | https://doi.org/10.1038/s41467-020-20536-y | www.nature.com/naturecommunications <lb/></note>

			<page>9 <lb/></page>

			<listBibl>41. Faust, G. G. &amp; Hall, I. M. SAMBLASTER: fast duplicate marking and <lb/>structural variant read extraction. Bioinformatics 30, 2503-2505 (2014). <lb/>42. Rao, S. S. P. et al. A 3D map of the human genome at kilobase resolution <lb/>reveals principles of chromatin looping. Cell https://doi.org/10.1016/j. <lb/>cell.2014.11.021 (2014). <lb/>43. Vurture, G. W. et al. GenomeScope: fast reference-free genome profiling from <lb/>short reads. Bioinformatics https://doi.org/10.1093/bioinformatics/btx153 (2017). <lb/>44. Kurtz, S. et al. MUMmer-Versatile and open software for comparing large <lb/>genomes. Genome Biol. https://doi.org/10.1186/gb-2004-5-2-r12 (2004). <lb/>45. Cabanettes, F. &amp; Klopp, C. D-GENIES: dot plot large genomes in an interactive, <lb/>efficient and simple way. PeerJ https://doi.org/10.7717/peerj.4958 (2018). <lb/>46. Rhie, A. et al. Towards complete and error-free genome assemblies of all <lb/>vertebrate species. Preprint at https://www.biorxiv.org/content/10.1101/ <lb/>2020.05.22.110833v1 (2020). <lb/>47. Chaisson, M. J. P. et al. Multi-platform discovery of haplotype-resolved <lb/>structural variation in human genomes. Nat. Commun. 10, 1784 (2019). <lb/>48. Porubsky, D. et al. BreakpointR: An R/Bioconductor package to localize strand <lb/>state changes in Strand-seq data. Bioinformatics https://doi.org/10.1093/ <lb/>bioinformatics/btz681 (2020). <lb/>49. Porubsky, D. et al. Dense and accurate whole-chromosome haplotyping of <lb/>individual genomes. Nat. Commun. https://doi.org/10.1038/s41467-017-<lb/>01389-4 (2017). <lb/></listBibl>

			<div type="acknowledgement">Acknowledgements <lb/>We wish to thank Tonia Brown whose efforts greatly improved the clarity of the <lb/>manuscript. E.D.J. contributions were supported by funds from the Howard Hughes <lb/>Medical Institute and Rockefeller University. We thank Jason Chin and Mark Chaisson <lb/>for helpful discussion. The mention of trade names or commercial products in this <lb/>publication is solely for the purpose of providing specific information and does not imply <lb/>recommendation or endorsement by the U.S. Department of Agriculture. The USDA is <lb/>an equal opportunity provider and employer. <lb/></div>

			<div type="annex">Author contributions <lb/>Z.N.K., S.B.K., and S.T.S. conceived and designed the algorithm. P.P., R.J.H., K.M.M., K. <lb/>K., K.A.M., S.H., O.F., T.P.L.S., E.E.E., I.L., and J.L.W. provided samples or collected data. <lb/>Z.N.K., S.B.K., G.T.C., S.K., A.R, D.P., S.T.S., and W.Y.L. did data analysis and validation. <lb/>Z.N.K., S.B.K., A.M.P, E.E.E., E.D.J., J.L.W., T.P.L.S., S.K., D.P., and S.T.S., wrote and <lb/>revised the manuscript. <lb/></div>

            <div type="annex">Competing interests <lb/>E.E.E. is on the scientific advisory board (SAB) of DNAnexus, Inc. [and was an SAB <lb/>member of Pacific Biosciences, Inc. (2009-2013)]. S.B.K., Z.N.K., P.P., G.T.C., and R.J.H. <lb/>are employees and share holders of Pacific Biosciences, a company developing single-<lb/>molecule sequencing technologies. S.T.S. and I.L. are employee and share holders, and Z. <lb/>N.K. and K.A.M. are shareholder of Phase Genomics, a provider of services and products <lb/>for Hi-C and other proximity-ligation methods. The remaining authors declare no <lb/>competing interests. <lb/></div>

            <div type="annex">Additional information <lb/>Supplementary information is available for this paper at https://doi.org/10.1038/s41467-<lb/>020-20536-y. <lb/>Correspondence and requests for materials should be addressed to Z.N.K. or S.B.K. <lb/>Peer review information Nature Communications thanks Fritz Sedlazeck and the other, <lb/>anonymous, reviewer(s) for their contribution to the peer review of this work. Peer <lb/>reviewer reports are available. <lb/>Reprints and permission information is available at http://www.nature.com/reprints <lb/>Publisher&apos;s note Springer Nature remains neutral with regard to jurisdictional claims in <lb/>published maps and institutional affiliations. <lb/></div>

			<front>Open Access This article is licensed under a Creative Commons <lb/>Attribution 4.0 International License, which permits use, sharing, <lb/>adaptation, distribution and reproduction in any medium or format, as long as you give <lb/>appropriate credit to the original author(s) and the source, provide a link to the Creative <lb/>Commons license, and indicate if changes were made. The images or other third party <lb/>material in this article are included in the article&apos;s Creative Commons license, unless <lb/>indicated otherwise in a credit line to the material. If material is not included in the <lb/>article&apos;s Creative Commons license and your intended use is not permitted by statutory <lb/>regulation or exceeds the permitted use, you will need to obtain permission directly from <lb/>the copyright holder. To view a copy of this license, visit http://creativecommons.org/ <lb/>licenses/by/4.0/. <lb/>© The Author(s) 2021 <lb/></front>

			<note place="headnote">ARTICLE <lb/>NATURE COMMUNICATIONS | https://doi.org/10.1038/s41467-020-20536-y <lb/></note>

			<page>10 <lb/></page>

			<note place="footnote">NATURE COMMUNICATIONS | (2021) 12:1935 | https://doi.org/10.1038/s41467-020-20536-y | www.nature.com/naturecommunications </note>


	</text>
</tei>
