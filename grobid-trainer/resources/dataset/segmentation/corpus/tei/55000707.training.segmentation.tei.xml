<?xml version="1.0" ?>
<tei xml:space="preserve">
	<teiHeader>
		<fileDesc xml:id="0"/>
	</teiHeader>
	<text xml:lang="en">
			<titlePage>Image Selective Smoothing and Edge Detection by Nonlinear Diffusion <lb/>Francine Catté; Pierre-Louis Lions; Jean-Michel Morel; Tomeu Coll <lb/>SIAM Journal on Numerical Analysis, Vol. 29, No. 1. (Feb., 1992), pp. 182-193. <lb/>Stable URL: <lb/>http://links.jstor.org/sici?sici=0036-1429%28199202%2929%3A1%3C182%3AISSAED%3E2.0.CO%3B2-E <lb/>SIAM Journal on Numerical Analysis is currently published by Society for Industrial and Applied Mathematics. <lb/>Your use of the JSTOR archive indicates your acceptance of JSTOR&apos;s Terms and Conditions of Use, available at <lb/>http://www.jstor.org/about/terms.html. JSTOR&apos;s Terms and Conditions of Use provides, in part, that unless you have obtained <lb/>prior permission, you may not download an entire issue of a journal or multiple copies of articles, and you may use content in <lb/>the JSTOR archive only for your personal, non-commercial use. <lb/>Please contact the publisher regarding any further use of this work. Publisher contact information may be obtained at <lb/>http://www.jstor.org/journals/siam.html. <lb/>Each copy of any part of a JSTOR transmission must contain the same copyright notice that appears on the screen or printed <lb/>page of such transmission. <lb/>The JSTOR Archive is a trusted digital repository providing for long-term preservation and access to leading academic <lb/>journals and scholarly literature from around the world. The Archive is supported by libraries, scholarly societies, publishers, <lb/>and foundations. It is an initiative of JSTOR, a not-for-profit organization with a mission to help the scholarly community take <lb/>advantage of advances in technology. For more information regarding JSTOR, please contact support@jstor.org. <lb/>http://www.jstor.org <lb/>Mon Jan 28 13:26:14 2008 <lb/></titlePage>

			<front>012 <lb/> SIAM J. N U M E K . ANAL <lb/>@ 1992 Society for lndustrlal and Applied Mathematics <lb/>Vol. 29 No. 1, pp. 182-193, February 1992 <lb/>IMAGE SELECTIVE SMOOTHING AND EDGE DETECTION BY <lb/>NONLINEAR DIFFUSION* <lb/>FRANCINE CATTE,? PIERRE-LOUIS LIONS,? JEAN-MICHEL MOREL,? A N D TOMEU COLLf <lb/>Abstract. A new version of the Perona and Malik theory for edge detection and image restoration is <lb/>proposed. This new version keeps all the improvements of the original model and avoids its drawbacks: it <lb/>is proved to be stable in presence of noise, with existence and uniqueness results. Numerical experiments <lb/>on natural images are presented. <lb/>Key words. multiscale image analysis, edge detection, parabolic equation, nonlinear diffusion, stability <lb/>AMS(M0S) subject classifications. 49F22, 53A10, 82A60, 76T05, 49A50, 80A15, 40F10 <lb/></front>

			<body>1. Introduction. The &quot;low level&quot; analysis of monodimensional and bidimensional <lb/>signals presents two opposite requirements. We generally wish to extract the tendency <lb/>of the signal. This corresponds to a rather nonlocal analysis of the signal. For instance, <lb/>we may look for regions of an image where the signal is of constant mean. <lb/>On the other hand, we wish to determine accurately where the signal changes its <lb/>tendency. In the case of image analysis, the curves where this happens are called <lb/>&quot;edges&quot; [16]. In the classical theory, the tendency of the signal can be extracted by a <lb/>low pass filtering 1241-[26]. This theory comes from Marr and Hildreth [16] and has <lb/>been better formalized by Witkin, Koenderink, and improved by Canny [6]. The low <lb/>pass filtering is made by convolution with Gaussians of increasing variance. Then the <lb/>&quot;edges&quot; are defined as the set of points where the norm of the gradient of the resulting <lb/>smooth signal has a local maximum. (The set of &quot;edges&quot; is therefore contained in the <lb/>set of the points where the Laplacian of the smoothed signal changes sign.) The <lb/>necessity of a previous low pass filtering is easily understood: if the signal is noisy, <lb/>the gradient will have a lot of irrelevant maxima which must be eliminated. Of course, <lb/>strong oscillations can be due to different causes, for instance, to the presence of <lb/>&quot;textures.&quot; According to the above-mentioned edge detection theory, the boundaries <lb/>of different textured regions can be found only if the mean value of the signal is <lb/>different for each texture. Witkin [25] noticed that the convolution of the signal with <lb/>Gaussians at each scale was equivalent to the solving of the heat equation with the <lb/>signal as initial datum. Denote by uo this datum. Then the &quot;scale space&quot; analysis <lb/>associated with uo consists in solving the system <lb/>(1.1) <lb/>~u ( x , <lb/>t)/dt = Au(x, t), <lb/>U(X, 0)= uO(x). <lb/>The solution of this equation in one dimension and for an initial datum with bounded <lb/>quadratic norm is u(x, t) = G, * u, where <lb/>G,(x) = <lb/>exp (-x2/4a) <lb/>is the Gaussian function. Then x is an edge point for the &quot;scale&quot; t1I2 at points where <lb/>Au(x, t) changes sign and IVU(X, t)l is &quot;large.&quot; Of course, this last condition introduces <lb/></body>

			<front>* Received by the editors September 24, 1990; accepted for publication March 27, 1991. This work was <lb/>supported by U.S. Army contract DAJA 45-88-C-0009. <lb/>t Ceremade, Universitt Paris-Dauphine, Place de Lattre de Tassigny, 75775 Paris Cedex 16, France. <lb/>$ Department d e Matematiques Informatica, Universitat d e les Illes Balears, Carret. Valldemossa km 7.5, <lb/>Palma de Mallorca, Spain. <lb/> 182 <lb/></front>

			<note place="headnote">IMAGE SELECTIVE SMOOTHING AND EDGE DETECTION <lb/></note>

			<page>183 <lb/></page>

			<body>an a priori defined threshold. Unfortunately, it is well known (and it is enough to look <lb/>at the &quot;edges&quot; found by this method to know it well [13]) that the edges at low scales <lb/>give an inexact account of the boundaries which, according to our perception, should <lb/>be considered correct. This is still true for the low pass filtering of Canny [6], [23] <lb/>which is generally used as the best linear filter for white noise elimination and edge <lb/>detection. An important improvement of the edge detection theory has been introduced <lb/>by Malik and Perona [23]. They propose to replace the heat equation by a nonlinear <lb/>equation of the porous medium type: <lb/>auldt = div (g(lVul)Vu), <lb/>u(0) = u,. <lb/>In this equation, g is a smooth nonincreasing function with g(0) = 1, g ( x )2 0, and <lb/>g(x) tending to zero at infinity. The idea is that the smoothing process obtained by <lb/>the equation is &quot;conditional&quot;: if Vu(x) is large, then the diffusion will be low and <lb/>therefore the exact localization of the &quot;edges&quot; will be kept. If Vu(x) is small, then the <lb/>diffusion will tend to smooth still more around x. Thus the choice of g corresponds <lb/>to a sort of thresholding which has to be compared to the thresholding of l~u l <lb/>used <lb/>in the final step of the classical theory. Since this thresholding introduces a nonlinear <lb/>device anyway, it was natural to ask whether it could not be used earlier in the method, <lb/>in the smoothing process itself. The experimental results obtained by Malik and Perona <lb/>are perceptually impressive and show that an &quot;edge detector&quot; based on this theory <lb/>gives edges which remain much more stable across the scales. (This property has been <lb/>sought by many researchers in the past two decades.) <lb/>However, the Malik and Perona model has several serious practical and theoretical <lb/>difficulties which this paper aims to solve. The first is a straightforward objection that <lb/>every researcher in signal analysis will surely raise (and that Malik and Perona <lb/>themselves considered). Assume that the signal is noisy, with white noise, for instance. <lb/>Then the noise introduces very large, in theory unbounded, oscillations of the gradient <lb/>Vu. Thus the conditional smoothing introduced by the model will not help, since all <lb/>these noise edges will be kept! <lb/>Malik and Perona proposed to eliminate this difficulty by a first smoothing of the <lb/>image using some low pass filter. It seems to work well in practice, but it is nonetheless <lb/>a trick which should be avoided in a correct theory. An obvious drawback is the <lb/>introduction in the method of a new parameter, the variance of the Gaussian with <lb/>which this preliminary smoothing should be made. Moreover, the theory seems to adopt <lb/>again what it tried to avoid: a nonadaptive filtering which makes lost the accuracy of <lb/>the edges. <lb/>The second difficulty arises from the equation itself; among the functions g which <lb/>Malik and Perona consider admissible are found functions of the type g(s) = e-&quot; or <lb/>g ( s ) = (1 +s2)-&apos; for which no correct theory of (1.2) is available. Indeed, in order to <lb/>obtain both existence and uniqueness of the solutions, g must verify that sg(s) is <lb/>nondecreasing. If this condition is not verified, we can observe for some functions g <lb/>with sg(s) nonincreasing a nondeterministic and therefore unstable process; the same <lb/>picture in theory can be the initial condition of solutions divergent in time (see [ l l ] <lb/>for simple and explicit examples, and also [8]). In practice, that means that very close <lb/>pictures can produce divergent solutions and therefore diferent edges. This is certainly a <lb/>drawback for most applications; think, for instance, of stereo vision, where this situation <lb/>arises. However, it would be reasonable to try to define a model where the function <lb/>g, which is a sort of thresholding, will be quickly decreasing, as e-&quot;, for instance. <lb/>Before arriving at an improved model, let us just sketch why, if sg(s) is nonincreasing, <lb/>Perona and Malik&apos;s equation will be an ill-posed problem. Without loss of generality, <lb/>

			take the case where the signal is one-dimensional. The equation becomes duldt -<lb/>(g(ut)u&apos;)&apos;= 0, that is, duldt -(gt(u&apos;)u&apos;+ g(ut))u&quot;= 0. If sg(s) is decreasing at some s <lb/>and therefore with a negative derivative -a at s, and if it happens that at some point <lb/>x, ut(x) = s, then the equation looks near x like duldt + a u &quot; = 0. This is the inverse <lb/>heat equation, which actually is known to be ill posed; starting with a smooth initial <lb/>datum, it can develop singularities of any order in arbitrarily small time. (This equation <lb/>is well known in signal processing, since inverting it would provide a perfect deblurring <lb/>algorithm [22].) <lb/>The model which we now propose is a synthesis of Malik and Perona&apos;s ideas <lb/>which avoids the above-mentioned difficulties; it will be robust in the presence of noise <lb/>and will be consistent from the formal viewpoint described above. Moreover, it will <lb/>be based, as in the space scale theory of Witkin, on a single parameter: the scale. <lb/>We shall define the &quot;selective smoothing&quot; of u, at scale t112 as the function u(x, t) <lb/>verifying <lb/>(1.3) <lb/>&amp;/at -div (~(IDG, * ul)vu) = 0 in 10, T [x R, <lb/>u(0) = uo, <lb/>where G,(x) = C U -&quot;ẽxp (-1xI2/4a). It is easily seen that G(x, t) = G,(x) is nothing <lb/>but the fundamental solution of the heat equation. Therefore, the term (DG, * u)(x, t) <lb/>which appears inside the divergence term of (1.3) is simply the gradient of the solution <lb/>at time a of the heat equation with u(x, t) as initial datum. Thus it appears to be an <lb/>estimate of the gradient of u at point x, obtained by the classical Marr-Hildreth-Witkin <lb/>theory, recalled above. The modification of the model of Malik and Perona, therefore, <lb/>is only to replace the gradient lvul by its estimate I D G , * ul. As we shall prove, this <lb/>slight change of the model is enough to avoid both inconsistencies of the Malik and <lb/>Perona model. Indeed, the equation, as announced by those authors, will now diffuse <lb/>if and only if the gradient is estimated to be small, the job of this estimate being done <lb/>by the new term which we introduce. This does not alter the scope of the &quot;anisotropic <lb/>diffusion&quot; model. Indeed, the initial datum in the new equation is u,, and the necessity <lb/>of smoothing the initial datum u, by a Gaussian in order to eliminate the noisy estimates <lb/>of lVul is now removed. Moreover, (1.3) can be proved to have a unique smooth <lb/>solution. The main part of this paper is devoted to the proof of existence, uniqueness, <lb/>and regularity properties for (1.3). We shall work with two-dimensional data-like <lb/>pictures, and therefore defined, without loss of generality, on a square. (With the <lb/>adequate changes in the definition of the convolution (see later), the domain where <lb/>the signal is defined may be a rectangle, a disk, or any open set with smooth enough <lb/>boundary.) <lb/>The function G to be considered can be any &quot;low pass filter,&quot; or, to use the <lb/>terminology of calculus, any smoothing kernel. However, in order to preserve the <lb/>notion of scale in the gradient estimate, it is convenient that this kernel depends on a <lb/>scale parameter. A good and classical example is, as mentioned above, the Gaussian. <lb/>It is important to keep this particular case in mind. Indeed, a question which arises <lb/>immediately in the consideration of model (1.3) is what time is best for &quot;stopping&quot; <lb/>the evolution of the signal u(x, t). This choice is quite important, since it is clear that <lb/>all of the above-mentioned models, including ours, diffuse completely at t + +aand <lb/>give therefore a constant function. Now we may appeal to the Witkin model to answer <lb/>this question: according to this model, time is interpreted as a &quot;scale factor.&quot; (More <lb/>precisely, the solution u(x, t) at time t corresponds to a scale t112. Indeed, roughly <lb/>speaking, u(x, t) appears in the Witkin model as a smooth version of u, obtained by <lb/>convolving it with a filter of spatial width t1I2.) Thus in the model (1.3) it is coherent <lb/>to correlate the stopping time t and the time introduced via the estimator G,. We <lb/></body>

			<page>185 <lb/></page>

			<note place="headnote">IMAGE SELECTIVE SMOOTHING AND EDGE DETECTION <lb/></note>

			<body>should therefore choose a stopping time t of the order of o: Then the spatial scale <lb/>under which the signal is smoothed in regular zones of the image will be of the order <lb/>of t&quot;*. On the parts of the picture where edges are present, the situation is different. <lb/>Since the scope of the equation is to delay diffusion in these zones, the scale at which <lb/>edge information is lost will depend on the shape of the thresholding function g. <lb/>Therefore, even if we wrote above that we should stop the equation at a time of the <lb/>order of a, this is rather a lower estimate and there is no inconsistency in looking at <lb/>what happens to the signal u(x, t) for times greater than a. In experimentation, it <lb/>might be convenient to play with two parameters that are anyway at hand in any edge <lb/>detection model: the scale parameter (spatial width of the filtering) on the one side, <lb/>all2,and the threshold parameter for edges, which is implicit in the shape of g. If g <lb/>is near 1 on some interval containing zero and decreases briskly at the end b of this <lb/>interval, then b is the threshold for edges. Where [~u / <lb/>is greater than b, the edges will <lb/>remain and where it is smaller, they will disappear. Thus it is clear that if our model <lb/>is used as a preliminary step for an edge detection device, we might use the same <lb/>threshold b on the gradient for keeping the edges as the one implicit in g. <lb/>Before beginning with the proofs of the consistency of our model, let us give a <lb/>brief account of several related works which came to our knowledge as this work was <lb/>in the final experimental phase. Osher and Rudin&apos;s theory [22] tries to get as close as <lb/>possible to the inverse heat equation by defining some conservative scheme like <lb/>duldt = -lu,l~(u,,) with initial datum u,. F is a function such that sF(s) 2 0. The <lb/>big advantage of this new method is to have a scheme which lets the image develop <lb/>true edges, that is, shock lines along which u(x, t ) becomes discontinuous in x. <lb/>Nordstrom [21] proposes a new presentation of Perona and Malik&apos;s theory which <lb/>relates it to the well-known variational global edge detection methods of Terzopoulos, <lb/>Blake and Zisserman, and Mumford and Shah [18]. Nordstrom introduces a new term <lb/>in (1.2) which forces u(x, t ) to remain close to u,. Because of the forcing term u -u,, <lb/>the new equation <lb/>duldt -div (g(Vu)Vu) = u,-u <lb/>has a priori the advantage of having a nontrivial steady state, eliminating therefore <lb/>the problem of choosing a stopping time. (Of course, we can do the same in our model <lb/>and the proof below is not altered by this modification.) However, there is the same <lb/>theoretical difficulty as in Malik and Perona&apos;s model for this equation, at least for the <lb/>g proposed by Nordstrom; tg(t) decreases at infinity and the author insists in wanting <lb/>this phenomenon to happen. The maximum y of tg(t) should play the role of edge <lb/>thresholding; if the gradient is locally greater than y, then there would be enhancement <lb/>(and as a matter of fact, the equation behaves locally as an inverse heat equation). <lb/>Conversely, if the gradient happens to have a norm smaller than y, then diffusion will <lb/>continue. This fact eliminates every hope of getting a uniqueness and regularity theorem <lb/>for the solution u(x, t ) . Therefore, the maximum principle stated in the same paper is <lb/>empty; the c2assumption for the solution u(x, t) generally is not verified. Thus the <lb/>observed numerical stability of the attained solution is not likely to be theoretically <lb/>justified and should depend strongly on the kind of discretization that was considered. <lb/>However, the model that we propose could explain this stability. Indeed, discrete <lb/>schemes are likely to introduce an implicit diffusion and therefore to &quot;blurr&quot; the <lb/>computed solution. <lb/>Our scheme contains this blurring explicitly and, as a matter of fact, we &quot;see&quot; no <lb/>significant difference between the experimental results obtained by Perona and Malik, <lb/>by Nordstrom, and by Nitzberg and Shiota [20], whose work we shall comment on <lb/>

			now. The approach of these authors is related to adaptive filtering methods which <lb/>were introduced for TV images denoising by Graham [lo]. The idea is to blur <lb/>selectively and anisotropically the signal with &quot;oblong&quot; Gaussians. The Gaussian used <lb/>for blurring at a point x depends on the intensity and direction of the gradient in the <lb/>neighborhood. Roughly speaking, the blurring will be faster in the direction orthogonal <lb/>to the gradient. Therefore, the signal will be smoothed on both sides of an edge, but <lb/>the edge will be conserved. Since a corner is the crossing point of two edges, there <lb/>will be two directions of &quot;nondiffusion&quot; instead of one, and therefore corners will be <lb/>well conserved by this method. Nitzberg and Shiota&apos;s method is truly &quot;anisotropic&quot; <lb/>at each point, in contrast to Perona and Malik&apos;s diffusion equation, which is quite <lb/>isotropic. Moreover, Nitzberg and Shiota prove by a scaling argument that as the size <lb/>of the Gaussians tends to zero, their diffusion method tends to some ill-posed partial <lb/>differential equation analogous to Malik and Perona&apos;s. Their method appears, therefore, <lb/>to be an alternative solution to ours for avoiding ill posedness, and it provides true <lb/>anisotropic analysis, which our model does not take into account. In our opinion, its <lb/>only drawback is the increased number of parameters. In the same paper is proposed <lb/>another scheme for making (1.2) well posed. The idea is quite similar to that proposed <lb/>here. One just replaces the gradient Vu by some smoothed version v of it by setting <lb/>(we omit the scale parameters) <lb/>duldt = div ((1 +v)-&apos;Vu), doldt = G * IlVul12-v. <lb/>Since the second equation is intended to be a regularization of the steady state <lb/>v = G * Ivu~*, it is clear that this system boils down to our proposed equation. <lb/>However, the case where G has zero variance, that is, no convolution is actually <lb/>done, might still lead to a well-posed system. The same paper states a conjecture of <lb/>Mumford according to which the preceding system (without convolution) should have <lb/>global solutions and approach a step function as time tends to infinity. We therefore <lb/>would have a model quite close to Osher and Rudin&apos;s mentioned above, for which <lb/>this last property is ensured. <lb/>Finally, let us mention an approach very different in technique but quite close in <lb/>spirit and experimental results, namely, that due to Mallat and Zhong [14]. Mallat <lb/>and Zhong use wavelet transform as a multiscale edge detection device, and are able <lb/>to reconstruct an image from its edges. They use this new reconstruction technique to <lb/>build a selective edge removing. The idea is to keep only edges present at several <lb/>scales, to remove the other ones, and then apply the reconstruction algorithm to this <lb/>simplified edge map. The result is visually almost equivalent to our version of <lb/>anisotropic diffusion. Indeed, we also introduced a conditional edge removing by <lb/>plugging the convolution by a Gaussian into our equation. In essence, that means that <lb/>an edge is kept only if present at a coarser scale. <lb/>In the next section we shall state and prove the main existence and uniqueness <lb/>results announced above. In H 3, we describe briefly the numerical scheme which was <lb/>used in experimentations and present some experimental results on pictures. As we <lb/>said, they are not much different from those obtained by the authors mentioned above. <lb/>Now our scope is to obtain a correct and simple theory of what can be &quot;nonlinear <lb/>scale space,&quot; and to define mathematically experimental devices which should be stable <lb/>and reliable. <lb/>2. Consistency of the model: Existence and uniqueness results. In the following, R <lb/>denotes the open set 10, I[ x 10, 1[ of R &apos; , with boundary T. We denote by H~(~R ) , <lb/>k a <lb/>positive integer, the set of all function u(x) defined in R such that u and its distributional <lb/></body>

			<page>187 <lb/></page>

			<note place="headnote">IMAGE SELECTIVE SMOOTHING AND EDGE DETECTION <lb/></note>

			<body>derivatives Dsu of order Is1 =Z,*=,s, 5 k all belong to L 2 ( R ) . Hk(Cl) is a Hilbert space <lb/>for the norm <lb/>We denote by LP(O, T, H k ( R ) ) the set of all functions u, such that, for almost <lb/>every t in (0, T ) , u (+) belong to H (a). LP (0, T, H ( 0 ) ) <lb/>is a normed space for the norm <lb/>p &gt; 1 and k a positive integer. <lb/>We denote by Lm(O,T, %&apos;&quot;(a)) the set of all functions such that, for almost every <lb/>t in (0, T ) , u ( t ) belong to %&quot;(a). Lm(O, T, g m ( R ) )is a normed space for the norm <lb/>IIu I1 <lb/>= inf { C ; IIu(t)ll % -( a ) 5 C, a.e. on (0, TI). <lb/>L~( o , T ,~~(~) ) <lb/>We denote by (~&apos; ( a ) ) <lb/>the dual of H 1 ( R ) . <lb/>Let g :R++ Rt be a decreasing function with g(0)= 1, lim,,,, g ( t )= 0 and t + <lb/>g (~) is smooth. For instance, we can take <lb/>Let u &gt; 0, we suppose that G, is a Gaussian filter <lb/>Let us now study the existence of a solution for the nonlinear partial differential <lb/>equation <lb/>The initial data u, is in L~( R ) <lb/>and <lb/>where ii is a linear and continuous extension of u to R~. <lb/>The definition of ii depends on the boundary condition on r imposed on u ( x , t ) . <lb/>In the case of a Neumann boundary condition, <lb/>THEOREM 2.1. Let u ,~ L 2 ( R ) ; then we have a unique function u ( x , t ) such that <lb/>u E %&apos;([O, T I ; L~( R ) ) <lb/>fl ~~( 0 , <lb/>T ; H 1 ( R ) ) , and verifying <lb/>au <lb/>--div [ g ( l~ G, * u l ) v u ]= 0 on 10, TI x R , <lb/>at <lb/>

			where this system is verijied in the distributional sense. Moreover, this unique solution is <lb/>in %&quot;(lo, T[ x fi). <lb/>Prooj (a) Existence of a solution. In this first section, we show the existence of a <lb/>weak solution of (2.1) by a classical fixed point theorem of Schauder [9], [19]. We <lb/>introduce the space <lb/>This space is a Hilbert space for the graph norm [13]. Let w G W(0, T) f l Lm(O,T, L2(fl)) <lb/>such that <lb/>and ( E , ) the problem <lb/>u(0) = u,. <lb/>Since w E L&quot;(0, T; L2(0)) and g, G are C&quot;, one easily deduces that g(lvG, * wl) E <lb/>Lm(O, T; %&quot;(a)). Thus, since g is decreasing, there exists a constant v &gt;0 such that <lb/>where v depends only on g, G and 11 uollL~( o ) . <lb/>By classical results on parabolic equations [3], [4], we prove that the problem <lb/>(E,) as a unique solution U(w) in W(0, T) [I], [4]. Then we can deduce <lb/>where C,, C2, and C3 are constants which only depends on G, g, and u,. These estimates <lb/>lead us to introduce the subset Wo of W(0, T) defined by <lb/>By (2.2)-(2.4), U is a mapping from W, into W,. Moreover, W, is a nonempty, convex, <lb/>and weakly compact subset of W(0, T). <lb/>In order to use the Schauder theorem, we need to prove that the mapping u is <lb/>weakly continuous from W, into W,. <lb/>Since W(0, T) is contained in L2(0, T; L2(fl)), with compact inclusion, this will <lb/>provide u in W, such that u = U(u). <lb/>Let (wj) be a sequence in W, which converges weakly to some w in Wo and <lb/>uj = U(wj). <lb/>By using (2.2), (2.4), and classical theorems of compact inclusion (the theorem <lb/>of Rellich and Kondrachov [4]), the sequence (wj) of W, contains a subsequence (w,) <lb/></body>

			<page>189 <lb/></page>

			<note place="headnote">IMAGE SELECTIVE SMOOTHING AND EDGE DETECTION <lb/></note>

			<body>such that <lb/>u,+ u weakly in L2(0, T; H&apos;(R)), <lb/>du, du <lb/>-+-<lb/>weakly in L2(0, T; (H1(R))&apos;), <lb/>dt dt <lb/>u, + u in L2(0, T; L~( R ) ) and a.e. on R x 10, T[, <lb/>-du, +-au weakly in L2(0, T; L2(R)), <lb/>i = (1,2), <lb/>axi ax, <lb/>-<lb/>a G * wJ +-a G * w in L2(0, T; L2(R)) and a.e. on R x 10, T[, <lb/>axi <lb/>axi <lb/>Then we can pass to the limit in the relation (Ew,), which yields u = U(w). Moreover, <lb/>by the uniqueness of the solution of ( E , ) ,the whole sequence uJ = tl(wJ) converges <lb/>weakly in W ( 0 ,T) to u = U(w). <lb/>(b) Regularity of the solution. By a classical bootstrap argument, we know that <lb/>u(t) E H 1 ( 0 ) for all t &gt;0; therefore u(t) E H 2 ( 0 ) for all t &gt; 0. Then, by iterating, using <lb/>the general theory of parabolic equations [2], we can deduce that u is a strong solution <lb/>of (2.1 ) and u E Ym(]O,TI x 0 ) . <lb/>(c) Uniqueness of the solution. Let ii and u^ be two solutions of (2.1). We have, <lb/>for almost every t in [0, TI, <lb/>dii <lb/>aii <lb/>(2.5) <lb/>-<lb/>dt <lb/>(t) -div (Z(t)Vfi(t))=0, -<lb/>an <lb/>(t) = 0, fi(0) = u,, <lb/>dii <lb/>aii <lb/>(2.6) <lb/>-dt (t)-div (G(t)Vu^(t)) = 0, -an (t) =0, u^(O)= u,, <lb/>where ~( t ) <lb/>= g ( / (~G , <lb/>* ii)(t)l) and G(t) = g ( l ( V~, * u^)(t)l). <lb/>By using (2.5) and (2.6), we obtain <lb/>d <lb/>(2.7) -(~( t ) <lb/>-ii(t)) -div [Z(t)(Vii(t) -Vu^(t))] = div [ (~( t ) <lb/>-&amp;(t))Vu^(t)]. <lb/>dt <lb/>Now, multiplying (2.7) by ii(t) -6 ( t ) and using (C), <lb/>5 I l~( t &gt; -~( t ) l l L * ( n , l l V u^( t ) l l L 2 j n t l l V~( t ) -v i i ( t ) l I L 2~n ) . <lb/>Moreover, since g and G are C&quot;, we have <lb/>(2.9) <lb/>I I~( t ) -~( f ) l l L = ( n ) g <lb/>CII~(f)-ii(t)IIL2(n), <lb/>where C is a constant which only depends on G, g, and u,. <lb/>By using (2.8) and (2.9), we can write <lb/>and so <lb/>Since G ( O ) = G(0)= uo, by using (2.10) and Gronwall&apos;s lemma [5] we obtain the <lb/>announced uniqueness. <lb/>O <lb/>3. An iterative scheme which converges to the solution of (2.1). <lb/>THEOREM 3.1. Let U O E L 2 ( R ) . The sequence ( u n ) , deJined by ( E n ) , <lb/>du *+&apos; <lb/>( t )-div (~( I v G , * u &quot; ( t ) l v u n + &apos; ( t ) ) ) <lb/>= 0 a.e. on 10, T [ , <lb/>dt <lb/>du &quot;+I <lb/>( t )= 0 a.e. on 10, T [ , <lb/>dn <lb/>converges in %&apos;([0, T I ; L 2 ( R ) ) to the strong solution of (2.1). <lb/>ProoJ: We denote by a n= ~( I v G * unl).By [4,Thm. X.101, the problem ( E n )has <lb/>a unique solution un. It is clear that <lb/>(3.1) <lb/>a n2 g(llVG * u O I I~-( ,~) a.e. on 10, T [ x!2. <lb/>Now we prove that the sequence u&quot; converges in %([O, T I ; L 2 ( R ) ) to u, the strong <lb/>solution of (2.1). <lb/>We can observe that (see the estimate (2.10)) <lb/>Moreover, by using Theorem 2.1, we have <lb/>(3.3) <lb/>l I~O -~( t ) l / 2 , 2 ( , ,~C o <lb/>V t € [ O , T l , <lb/>where Co is a constant which only depends on G, g, and uo. Then for any t E [0, T I , <lb/>we have <lb/>where <lb/>By (3.2) and (3.4),we can deduce <lb/>and thus <lb/>Finally, we obtain by iterating <lb/>1lun+l(t) -<lb/>5 Co-<lb/>u ( t ) l 1 ; 2 (~) <lb/>( J O T a(.) ds)n+&apos; <lb/>( n+ l ) ! <lb/></body>

			<note place="headnote">IMAGE SELECTIVE SMOOTHING AND EDGE DETECTION <lb/></note>

			<page>191 <lb/></page>

			<body>From (3.5) we conclude that the sequence ( u n ) , converges in %([O, TI; L&apos;(R)) to the <lb/>strong solution of (2.1). <lb/>O <lb/>4. Numerical results and experiments. <lb/>4.1. Discretisation. We introduce the lattice of coordinates (ih, jh, n A t ) where <lb/>h = 1 / N + 1 , O S i S N + 1 , O S j S N + 1 ; and we denote u;, an approximation of <lb/>u(ih, jh; n At); a ;, an approximation of ~( I v G * u()(ih, jh, n At). Then we discretise <lb/>[~( I v G * ul)au/ax] by a;,au/ax(ih, jh, (n + 1)At) and a / a x [ g [ l ( v G * u)l]au/ax] by <lb/>1 <lb/>-[(a:-l,,+ ~: , ) U ? ? , &apos;~-(~C Y :~+ <lb/>a:-l,,+ a7+l,j)u:&apos;1 + (a;,+ a7+l,j)uY?:j], <lb/>2h2 <lb/>similarly for a / a y [ g l ( v G * u)lau/ay] by exchanging the roles of i and j. <lb/>Finally, we obtain the implicit scheme <lb/>Now the discrete problem can be written <lb/>where the matrix Ah is tridiagonal by blocks and positive defined. By classical arguments <lb/>[7], we know that the matrix I+AtAh(un) is invertible. <lb/>4.2. Some comments on the results of applying the schema to several images. Figures <lb/>1 and 2 show a tomography picture from the University of Joseph Fourier at Grenoble <lb/>and its &quot;cleaned&quot; version by anisotropic diffusion. As indicated in the introduction, <lb/>the experiments depend on two parameters: the time t (which yields the &quot;scale&quot; of <lb/>diffusion) and the threshold O under which diffusion is strong and above which <lb/>diffusion is low. In Fig. 2, t = 2 and 0 = 10. Figure 3 is an original picture by the <lb/>Institut National de Recherche en Informatique et en Automatique, and Fig. 4 its <lb/>diffusion with t = 2 and O = 20. Notice how texture present in many parts of the picture <lb/>is removed while the edges are kept. Figure 5 is an original Eizo picture. Figure 6 <lb/>shows its diffusion with t = 2 and O = 20. <lb/></body>

			<div type="acknowledgement">Acknowledgment. J. M. Morel thanks J. I. Diaz for valuable conversations. <lb/></div>

			<page>193 <lb/></page>

			<note place="headnote">IMAGE SELECTIVE SMOOTHING AND EDGE DETECTION <lb/></note>

			<listBibl>REFERENCES <lb/>[I] R. A. ADAMS, Sobolev Spaces, Academic Press, New York, 1975. <lb/>[2] 0. A. LADYSHEUSKAYA, V. A. SOLOMIKOV, A N D N. N. URAL&apos;TSEVA, Linear and Quasi linear <lb/>Equation of Parabolic Type, American Mathematical Society, Providence, RI, 1968. <lb/>[3] PH. BENILAN A N D H. BREZIS,Solutions faibles d&apos;iquations d&apos;e&apos;oolution dans les espaces de Hilbert, <lb/>Ann. Inst. Fourier, 22 (1972), pp. 311-329. <lb/>[4] H. BREZIS,Analyse Fonctionnelle, The&apos;orie et Applications, Masson, Paris, 1987. <lb/>[51 -, Operateurs maximaux monotones et semi-groupes de contractions dans les espaces de Hilbert, <lb/>Math. Stud. North-Holland, Amsterdam, 1973. <lb/>[6] J. CANNY, Finding edges and lines in images, Tech. Report 720, Artificial Intelligence Laboratory, <lb/>Massachusetts Institute of Technology, Boston, MA, 1983. <lb/>[7] P. CIARLET, Introduction a I&apos;Analyse Numirique Matricielle et I&apos;Optimisation, Masson, Paris, 1982. <lb/>[8] J. I. DIAZ, A nonlinearparabolic equation arising in imageprocessing, Extracta Matematicae, Universidad <lb/>de Extremadura, 1990. <lb/>[9] G. GAGNEUX, Sur des problbmes unilatiraux diginiris de la theorie des koulements diphasiques en <lb/>milieu poreux, These d&apos;Etat, Universitd de Besan~on, 1982. <lb/>[lo] R. E. GRAHAM, Snow removal: A noise-stripping process for Wsignals, IEEE Trans. Inform. Theory, <lb/>9 (1962) pp. 129-144. <lb/>[ l l ] K. HOLLIGAND J. A. NOHEL, A diffusion equation with a nonmonotone constitutioe function, in <lb/>Proceedings on Systems of Nonlinear Partial Differential Equation, J. Ball, ed., D. Reidel, Boston, <lb/>MA, 1983, pp. 409-422. <lb/>[12] M. KASS, A. WITKIN, A N D D. TERZOPOULOS, Snakes: active contour models, ICCV 1987, IEEE 777, <lb/>1987. <lb/>[I31 J. L. LIONS, ContrGle Optimal de Systbmes Gouuernbpar des ~quations aux Dirivies Partielles, Dunod, <lb/>Paris, 1968. <lb/>[14] S . MALLATAND S . ZHONG,Complete signal representation with multiscale edges, Tech. report 483, <lb/>Robotics Report 219, Computer Science Division, Courant Institute, New York. <lb/>[15] D. MARR, Vision, W. H. Freeman, San Francisco, CA, 1982. <lb/>[16] D. MARR A N D E. HILDRETH, Theory of edge detection, Proc. Roy. Soc. London Ser. B, (1980), <lb/>pp. 187-217. <lb/>[17] J. M. MOREL A N D S. SOLIMINI, Segmentation ofimages by variational methods: a constructioeapproach, <lb/>Rev. Mat. Universidad Complutense Madrid, 1-3 (1988), pp. 169-182. <lb/>[18] D. MUMFORD A N D J. SHAH,Boundary detection by minimizing functionals, IEEE Conference on <lb/>Computer Vision and Pattern Recognition, San Francisco, CA, 1985. <lb/>[19] L. NIRENBERG, Topics in nonlinear functional analysis, Lecture Notes, New York University, <lb/>New York, 1974. <lb/>[20] M. NITZBERG A N D T. SHIOTA, Nonlinear image smoothing with edge and corner enhancement, Tech. <lb/>report 90-2, Division of Applied Sciences, Hanard University, Cambridge, MA, 1990. <lb/>[21] K. N. NORDSTROM, Biased anisotropic diffusion-A unijed approach to edge detection, preprint, <lb/>Department of Electrical Engineering and Computer Sciences, University of California, Berkeley, <lb/>CA, 1989. <lb/>[22] S. OSHER A N D L. RUDIN,Feature-oriented image enhancement using shockjlters, SIAM J. Numer. <lb/>Anal., to appear. <lb/>[23] P. PERONA A N D J. MALIK,Scale space and edge detection using anisotropic diffusion, in Proc. IEEE <lb/>Computer Society Workshop on Computer Vision, 1987. <lb/>[24] A. ROSENFELD A N D M. THURSTON, Edge and curue detection for visual scene analysis, IEEE Trans. <lb/>Comput., C-20 (1971), pp. 562-569. <lb/>[25] A. P. WITKIN, Scale-spacejltering in Proceedings of IJCAI, Karlsruhe, 1983, pp. 1019-1021. <lb/>[26] A. YUILLE A N D T. POGGIO, Scaling theoremsfor zero crossings, IEEE Trans. Pattern Analysis Machine <lb/>Intelligence, 8 (1986), pp. 15-25. </listBibl>


	</text>
</tei>
