<?xml version="1.0" ?>
<tei xml:space="preserve">
	<teiHeader>
		<fileDesc xml:id="0"/>
	</teiHeader>
	<text xml:lang="en">
			<front>Learning dynamical information from static protein and sequencing data <lb/>Philip Pearce, 1 Francis G. Woodhouse, 2 Aden Forrow, 1 Ashley Kelly, 3 Halim Kusumaatmaja, 3 and Jörn Dunkel 1 <lb/>1 Department of Mathematics, Massachusetts Institute of Technology, Cambridge MA 02139-4307 <lb/>2 Department of Applied Mathematics and Theoretical Physics, <lb/>Centre for Mathematical Sciences, University of Cambridge, <lb/>Wilberforce Road, Cambridge CB3 0WA, United Kingdom <lb/>3 Department of Physics, Durham University, Science Laboratories, <lb/>South Road, Durham DH1 3LE, United Kingdom <lb/>(Dated: August 24, 2018) <lb/>

			Many complex processes, from protein folding and virus evolution to brain activity and neuronal <lb/>network dynamics, can be described as stochastic exploration of a high-dimensional energy land-<lb/>scape. While efficient algorithms for cluster detection and data completion in high-dimensional <lb/>spaces have been developed and applied over the last two decades, considerably less is known about <lb/>the reliable inference of state transition dynamics in such settings. Here, we introduce a flexible and <lb/>robust numerical framework to infer Markovian transition networks directly from time-independent <lb/>data sampled from stationary equilibrium distributions. Our approach combines Gaussian mixture <lb/>approximations and self-consistent dimensionality reduction with minimal-energy path estimation <lb/>and multi-dimensional transition-state theory. We demonstrate the practical potential of the in-<lb/>ference scheme by reconstructing the network dynamics for several protein folding transitions and <lb/>HIV evolution pathways. The predicted network topologies and relative transition time scales agree <lb/>well with direct estimates from time-dependent molecular dynamics data and phylogenetic trees. <lb/>The underlying numerical protocol thus allows the recovery of relevant dynamical information from <lb/>instantaneous ensemble measurements, effectively alleviating the need for time-dependent data in <lb/>many situations. Owing to its generic structure, the framework introduced here will be applicable <lb/>to modern cryo-electron-microscopy and high-throughput single-cell RNA sequencing data and can <lb/>guide the design of new experimental approaches towards studying complex multiphase phenomena. <lb/></front>

			<body>Energy landscapes encapsulate the effective dynam-<lb/>ics of a wide variety of physical, biological and chem-<lb/>ical systems 1,2 . Well-known examples include a myr-<lb/>iad of biophysical processes 3-7 , multiphase systems 2 , <lb/>thermally activated hopping in optical traps 8 , chemi-<lb/>cal reactions 1 , brain neuronal expression 9 , and cellular <lb/>development 10-14 . Energetic concepts have also been <lb/>connected to machine learning 15 and to viral fitness land-<lb/>scapes, where pathways with the lowest energy barriers <lb/>may explain typical mutational evolutionary trajectories <lb/>of viruses between fitness peaks 16,17 . Recent advances <lb/>in experimental techniques including cryo-electron mi-<lb/>croscopy (cryo-EM) 3 and single-cell RNA sequencing 18 , <lb/>as well as new online social interaction datasets 19 , are <lb/>producing an unprecedented wealth of high-dimensional <lb/>instantaneous snapshots of biophysical and social sys-<lb/>tems. Although much progress has been made in di-<lb/>mensionality reduction 20-22 and the reconstruction of ef-<lb/>fective energy landscapes in these settings 3,11,14,23 , the <lb/>problem of inferring dynamical information such as pro-<lb/>tein folding or mutation pathways and rates from instan-<lb/>taneous ensemble data remains a major challenge. <lb/>To address this practically important question, we <lb/>introduce here an integrated computational framework <lb/>for identifying metastable states on reconstructed high-<lb/>dimensional energy landscapes and for predicting the rel-<lb/>ative mean first passage times (MFPTs) between those <lb/>states, without requiring explicitly time-dependent data. <lb/>Our inference scheme employs an analytic representa-<lb/>tion of the data based on a Gaussian mixture model <lb/>(GMM) 24 to enable efficient identification of minimum-<lb/>energy transition pathways 25-27 . We show how the es-<lb/>timation of transition networks can be optimized by re-<lb/>ducing the dimension of a high-dimensional landscape <lb/>while preserving its topology. Our algorithm utilizes ex-<lb/>perimentally validated analytical results 8 for transition <lb/>rates 1,28,29 . Thus, it is applicable whenever the time-<lb/>evolution of the underlying system can be approximated <lb/>by a Fokker-Planck-type Markovian dynamics, as is the <lb/>case for a wide range of physical, chemical and biological <lb/>processes 1 . <lb/>Specifically, we illustrate the practical potential by <lb/>inferring protein folding transitions and HIV evolution <lb/>pathways. Current standard methods for coarse-graining <lb/>the conformational dynamics of biophysical structures 30 <lb/>typically estimate Markovian transition rates from time-<lb/>dependent trajectory data in large-scale molecular dy-<lb/>namics simulations 31 . By contrast, we show here that <lb/>protein folding pathways and rates can be recovered with-<lb/>out explicit knowledge of the time-dependent trajecto-<lb/>ries, provided the system is sufficiently ergodic and equi-<lb/>librium distributions are sampled accurately. The agree-<lb/>ment with the trajectory-based estimates suggests that <lb/>the inference of complex transition networks via recon-<lb/>structed energy landscapes can provide a viable and often <lb/>more efficient alternative to traditional time series esti-<lb/>mates, particularly as new experimental techniques will <lb/>offer unprecedented access to high-dimensional ensemble <lb/>data. <lb/></body>

			<page>2 <lb/></page>

			<body>Raw data <lb/>A <lb/>PC1 <lb/>PC2 <lb/>PC3 <lb/>Minimum energy paths <lb/>B <lb/>C <lb/>Original dimensions (10D) <lb/>Reduced dimensions (4D) <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>1 2 3 4 5 <lb/>Mean first passage times <lb/>Simulation <lb/>1 2 3 4 5 <lb/>1 2 3 4 5 <lb/>1 2 3 4 5 <lb/>Predicted <lb/>Scaled <lb/>Unscaled <lb/>Energy <lb/>0 <lb/>1 <lb/>MFPT <lb/>0 <lb/>5 <lb/>4 <lb/>1 <lb/>3 <lb/>2 <lb/>Fit GMM <lb/>Calculate <lb/>MFPTs <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>1 <lb/>MFPT <lb/>0 <lb/>1 <lb/>5 <lb/>3 <lb/>2 <lb/>1 <lb/>4 <lb/>PC1 <lb/>PC2 <lb/>FIG. 1. Inference scheme for estimating transition networks and mean first passage times (MFPTs) from a stationary sample <lb/>set, demonstrated on test data generated from a Gaussian Mixture Model (GMM; Supplementary Information). (A) Inputs are <lb/>the instantaneously measured data, sampled here from a 10-dimensional GMM with 5 Gaussians, plotted in the first 3 principal <lb/>components (PCs). (B) Top: A GMM is fit to the samples to construct the empirical distribution which is then converted to the <lb/>energy landscape using Eq. (1). Background color indicates the projection of the empirical energy landscape onto the first two <lb/>PCs. Minimum energy paths (MEPs, grey lines) between minima 1-5 on the landscape are calculated using the NEB algorithm <lb/>(Supplementary Information). Bottom: Disconnectivity graph illustrating minima on the energy landscape (circles) and saddle <lb/>points between them (squares). (C) A Markov state model (MSM) is constructed with transition rates given by Eq. (2) and <lb/>solved to predict the MFPTs between discrete states (top right; Methods). MFPTs predicted by the MSM agree with direct <lb/>estimates from Brownian dynamics simulations in the inferred energy landscape (top left; Supplementary Information). MFPTs <lb/>calculated in a reduced 4-dimensional space using the scaling given in Eq. (3) recover the MFPTs accurately (bottom left). <lb/>Without the appropriate scaling, the predicted MFPTs are inaccurate (bottom right). <lb/>RESULTS <lb/>Minimum-energy-path (MEP) network <lb/>reconstruction <lb/>The equilibrium distribution p (x) of a particle diffus-<lb/>ing over a potential energy landscape E(x) is the Boltz-<lb/>mann distribution p(x) = exp [−E(x)/k B T ] /Z , where <lb/>k B is the Boltzmann constant, T is the temperature and <lb/>Z is a normalization constant. Given the probability den-<lb/>sity function (PDF) p(x), the effective energy can be in-<lb/>ferred from <lb/>E(x) = −k B T ln[p(x)/p max ], <lb/>(1) <lb/>where p max is the maximum value of the PDF, included <lb/>to fix the minimum energy at zero. Our goal is to esti-<lb/>mate the MFPTs between minima on the landscape us-<lb/>ing only sampled data. We divide this task into three <lb/>steps, as illustrated in Fig. 1 for test data (Supplemen-<lb/>tary Information). In the first step, we approximate the <lb/>empirical PDF by using the expectation maximization <lb/>algorithm to fit a Gaussian mixture model (GMM) in a <lb/>space of sufficiently large dimension d (Methods, Fig 1A). <lb/>Mixtures with a bounded number of components can be <lb/>recovered in time polynomial in both d and the required <lb/>accuracy 32 . The resulting GMM yields an analytical ex-<lb/>pression for E(x) via Eq. (1). <lb/>In the second step, the inferred energy landscape E(x) <lb/>is reduced to an MEP network whose nodes (states) are <lb/>the minima of E(x) (Fig. 1B top). Each edge represents <lb/>an MEP that connects two adjacent minima and passes <lb/>through an intermediate saddle point (Fig. 1B). The <lb/>MEPs are found using the nudged elastic band (NEB) <lb/>algorithm 25,26 , which discretizes paths with a series of <lb/>bead-spring segments (Supplementary Information). <lb/>Markov state model (MSM) <lb/>Given the MEP network, the final step is to infer the <lb/>rates for transitioning from a minimum α to an adjacent <lb/>minimum β. Assuming overdamped Brownian dynamics, <lb/>the directed transition α → β can be characterized by the <lb/>generalized transition Kramers rate 1 <lb/>k αβ = <lb/>ω b <lb/>2πγ <lb/>i ω α <lb/>i <lb/>i ω S <lb/>i <lb/>exp (−E b /k B T ), <lb/>(2) <lb/>where γ is the effective friction, E b is the energy differ-<lb/>ence between the saddle point S on the MEP and the <lb/>minimum α, ω α <lb/>i are the stable angular frequencies at the <lb/>minimum α, while ω S <lb/>i and ω b are the stable and unsta-<lb/>ble angular frequencies at the saddle. Eq. (2) assumes <lb/>isotropic friction but can be generalized to a tensorial <lb/>form 1 if anisotropies are relevant. In most practical ap-<lb/>plications, the error from assuming γ to be isotropic is <lb/></body>

			<page>3 <lb/></page>

			<body>likely negligible compared to other experimental noise <lb/>sources. In principle, Eq. (2) can be refined further by <lb/>including quartic (or higher) corrections to the prefactor <lb/>ω b /γ to account for details of the saddle shape 1 . Such <lb/>corrections can be significant for GMMs (Supplementary <lb/>Information). <lb/>Each edge (αβ) has two weights, k αβ and k βα , assigned <lb/>to it. The rate matrix (k αβ ) completely specifies the <lb/>MSM on the network. Solving the MSM yields the ma-<lb/>trix of pairwise mean first passage times (MFPTs) be-<lb/>tween states (Fig. 1C, Methods). In a simple two-state <lb/>system, the MFPTs are determined up to a time scale <lb/>by detailed balance, but for three or more states the in-<lb/>fluence of landscape topography and the associated state <lb/>network topology (Methods) can lead to interesting hi-<lb/>erarchical ordering of passage times. Identifying these <lb/>hierarchies, and ways to manipulate them, is key to con-<lb/>trolling protein folding or viral evolution pathways. <lb/>Topology-preserving dimensionality reduction <lb/>To ensure that the inference protocol can be efficiently <lb/>applied to larger systems with a high-dimensional energy <lb/>landscape, we derive a general method for reducing the <lb/>dimension D of an energy landscape while preserving its <lb/>topology. A probability density function with C well-<lb/>separated Gaussians in D dimensions can be projected <lb/>onto the d = C − 1 dimensional hyperplane spanning <lb/>the Gaussian means using principal component analysis <lb/>(PCA). In practice, it suffices to choose C to be larger <lb/>than the number of energy minima if their number is not <lb/>known in advance. Reduction to fewer than d = C − 1 <lb/>dimensions does in general not allow a correct recovery <lb/>of the MFPTs. <lb/>To preserve the topology under such a transformation <lb/>-which is essential for the correct preservation of en-<lb/>ergy barriers and MEPs in the reduced-dimensional space <lb/>-one needs to rescale GMM components in the low-<lb/>dimensional space depending on the covariances of the <lb/>Gaussians in the D − d neglected dimensions (Fig. 1C). <lb/>Explicitly, one finds that within the subspace spanned by <lb/>the retained principal components (Supplementary Infor-<lb/>mation) <lb/>p(x D ) = <lb/>C <lb/>i=1 <lb/>φ i p d <lb/>i (x d ) <lb/>det 2πU T <lb/>d Σ i U d <lb/>det (2πΣ i ) <lb/>(3) <lb/>as long as p satisfies certain minimally-restrictive condi-<lb/>tions. Here, U d denotes the first d = C −1 columns of the <lb/>matrix of sorted eigenvectors U of the covariance matrix <lb/>of the Gaussian means, and φ i , p d <lb/>i and Σ i are the mixing <lb/>components, reduced-dimensional PDF and the covari-<lb/>ance matrix of each individual Gaussian in the mixture, <lb/>respectively (Supplementary Information). Neglecting <lb/>the determinant scale-factors in Eq. (3), as is often done <lb/>when GMM models are fitted to PCA-projected data, <lb/>generally leads to inaccurate MFPT estimates (Fig. 1C, <lb/>bottom). Note that Eq. (3) does not represent inversion <lb/>of the transformation performed on the data by PCA, un-<lb/>less all D dimensions are retained; if some dimensions are <lb/>neglected, Eq. (3) represents a rescaling of the marginal <lb/>distribution in the retained dimensions to reconstruct the <lb/>probability density function in the original dimension. In <lb/>other words, the transition rates are best recovered from <lb/>the conditional -not marginal -distributions, which are <lb/>given by Eq. (3) up to a constant factor that does not <lb/>affect energy differences. <lb/>Dimensionality reduction can substantially improve <lb/>the efficiency of the NEB algorithm step: when the MEPs <lb/>in the reduced d-dimensional space have been computed, <lb/>the identified minima and saddles can be transformed <lb/>back into the original data dimension D to calculate <lb/>the Hessian matrices at these points, allowing Kramers&apos; <lb/>rates to be calculated as usual (Fig. 1C, Supplemen-<lb/>tary Information). Alternatively, in specific situations <lb/>where the MEPs lie outside the hyperplane spanning the <lb/>means (Supplementary Information), the MEP in the re-<lb/>duced d-dimensional space can be transformed back to <lb/>the D-dimensional space and used as an initial condition <lb/>in that space, significantly reducing computational cost. <lb/>These results present a step towards a general protocol <lb/>for identifying reaction coordinates or collective variables <lb/>for projection of a high-dimensional landscape onto a re-<lb/>duced space while quantitatively preserving the topology <lb/>of the landscape. <lb/>Protein folding <lb/>To illustrate the vast practical potential of the above <lb/>scheme, we demonstrate the successful recovery of several <lb/>protein folding pathways, using data from previous large-<lb/>scale molecular dynamics (MD) simulations 31 . The pro-<lb/>tein trajectories, consisting of the time-dependent coordi-<lb/>nates of the alpha carbon backbone, were pre-processed, <lb/>treated as a set of static equilibrium measurements, and <lb/>reduced in dimension before fitting a GMM (Methods). <lb/>As is typical for high-dimensional parameter estimation <lb/>with few structural assumptions, the fitting error due to a <lb/>finite sample size n in d dimensions scales approximately <lb/>as <lb/>d/n (Supplementary Information); see Refs. 33,34 <lb/>for advanced techniques tackling sample size limitations. <lb/>Here, d &lt; 10 so the sample size n ∼ 10 5 suffices for effec-<lb/>tive recovery (Methods, Supplementary Information). <lb/>For each of the four analyzed proteins Villin, BBA, <lb/>NTL9 and WW, the reconstructed energy landscapes re-<lb/>veal multiple states including a clear global minimum cor-<lb/>responding to the folded state (Fig. 2A,B). To estimate <lb/>MFPTs, we determined the effective friction γ in Eq. (2) <lb/>for each protein from the condition that the line of best <lb/>fit through the predicted vs. measured MFPTs has unit <lb/>gradient. Although not usually known, γ could in prin-<lb/>ciple be calculated by comparing MD simulations with <lb/>experimental data. Our MFPT predictions agree well <lb/>with direct estimates (Supplementary Information) from <lb/></body>

			<page>4 <lb/></page>

			<body>A <lb/>B <lb/>C <lb/>Villin <lb/>BBA <lb/>NTL9 <lb/>WW <lb/>5 <lb/>2 <lb/>3 <lb/>4 <lb/>1 <lb/>Predicted MFPT (µs) <lb/>Measured MFPT (µs) <lb/>1 <lb/>5 <lb/>2 4 <lb/>3 <lb/>PC1 <lb/>PC2 <lb/>Villin <lb/>BBA <lb/>WW <lb/>PC1 <lb/>PC2 <lb/>PC3 <lb/>NTL9 <lb/>PC1 <lb/>PC2 <lb/>PC3 <lb/>PC1 <lb/>PC2 <lb/>PC3 <lb/>10 -1 10 0 <lb/>10 1 10 2 <lb/>10 -1 <lb/>10 0 <lb/>10 1 <lb/>10 2 <lb/>Energy <lb/>0 <lb/>10 -2 <lb/>10 -2 <lb/>PC3 <lb/>1 <lb/>FIG. 2. Reconstructed MEP networks for protein folding transitions, and comparison of predicted MFPTs with direct estimates <lb/>from molecular dynamics (MD) simulations (Supplementary Information). (A) Left: Low energy states and transition network <lb/>in the first three principal components (PCs) for Villin including predicted transition paths between states (red lines); bottom <lb/>coloring shows two-dimensional projection of the empirical energy landscape onto the first two PCs. Right: Associated discon-<lb/>nectivity graph and illustrations of the five lowest energy states, with state 1 corresponding to the folded state. (B) Low energy <lb/>states, transition paths and empirical energy landscape for BBA, WW and NTL9 proteins, and sketches of their folded states. <lb/>(C) Predicted MFPTs agree well with estimates from MD simulations when energy minima are well separated and become <lb/>less accurate for fast transitions with small MFPTs. Filled shapes correspond to unfolding transitions and unfilled shapes <lb/>correspond to folding transitions for Villin, BBA, NTL9 and WW. Crosses correspond to transitions between intermediate <lb/>states. <lb/>the time-dependent MD trajectories (Fig 2C). Detailed <lb/>analysis confirms that the MFPT estimates are robust <lb/>under variations of the number of Gaussians used in the <lb/>mixture (Fig. S1). Also, the estimated MEPs are in good <lb/>agreement with the typical transition paths observed in <lb/>the MD trajectories (Fig. S2). <lb/>Viral evolution <lb/>As a second proof-of-concept application, we demon-<lb/>strate that our inference scheme recovers the expected <lb/>evolution pathways between HIV sequences as well as <lb/>the key features of a distance-based phylogenetic tree <lb/>(Fig. 3). To this end, we reconstructed an effective energy <lb/>landscape from publicly available HIV sequences sam-<lb/>pled longitudinally at several points in time from multiple <lb/>patients 35 , assuming that the frequency of an observed <lb/>genotype is proportional to its probability of fixation and <lb/>that the high-dimensional discrete sequence space can be <lb/>projected onto a continuous reduced-dimensional pheno-<lb/>type space (Fig. 3A; Supplementary Information). First, <lb/>a Gaussian was fit to each patient and then combined in <lb/>a GMM with equal weights, to avoid bias in the fitness <lb/>landscape towards sequences infecting any specific pa-<lb/>tient (Supplementary Information). Thereafter, we ap-<lb/>plied our inference protocol to reconstruct the effective <lb/>energy landscape, transition network (Fig. 3B) and dis-<lb/>connectivity graph (Fig. 3C), where each state is asso-<lb/>ciated to a separate patient. As expected, states corre-<lb/>sponding to patients infected with different HIV subtypes <lb/>are not connected by MEPs (Fig 3A,B). The discon-<lb/>nectivity graph reproduces the key features of a coarse-<lb/>grained patient-level representation of the phylogenetic <lb/>tree (Fig. 3C). Using our inference scheme, vertical evo-<lb/>lution in the tree can be tracked along the minimum <lb/>energy paths in a reduced-dimensional sequence space <lb/>(Fig. 3B). The energy barriers, represented by the lengths <lb/>of the vertical lines in the disconnectivity graph (Fig. <lb/>3C), provide an estimate for the relative likelihood of <lb/>evolution to fixation via point mutations between fitness <lb/>peaks (energy minima). If mutation rates are known, the <lb/>MEPs can also be used to estimate the time for evolution <lb/>to fixation from one fitness peak to another 36 . <lb/></body>

			<page>5 <lb/></page>

			<body>A <lb/>B <lb/>C <lb/>PC1 <lb/>PC2 <lb/>PC3 <lb/>PC1 <lb/>PC2 <lb/>PC3 <lb/>P2 <lb/>P5 <lb/>Reads/1000 <lb/>1 <lb/>&gt;100 <lb/>P9 P10 P3 P5 P8 P11 P2 <lb/>P9 <lb/>P10 <lb/>P3 <lb/>P8 <lb/>P11 <lb/>P3 <lb/>P8 <lb/>P9 <lb/>P10 <lb/>P5 <lb/>P2 <lb/>P1 (Type 01_AE) <lb/>P6 (Type C) <lb/>P11 <lb/>Energy <lb/>0 <lb/>1 <lb/>P9 P10 P3 <lb/>P5 <lb/>P8 <lb/>P11 P2 <lb/>Disconnectivity Graph <lb/>Phylogenetic Tree <lb/>Distance <lb/>0 <lb/>1 <lb/>P1 P6 <lb/>P1 P6 <lb/>HIV <lb/>FIG. 3. Minimum energy paths (MEPs) on viral fitness landscapes reconstructed from publicly available HIV sequencing data 35 . <lb/>(A) Longitudinal samples of the HIV virus are binarized after multiple sequence alignment (Supplementary Information) and <lb/>plotted in the first 3 PCs. Samples of the same HIV subtype are closer in PC-space. Patient labels correspond to those used <lb/>in 35 . (B) MEPs between minima corresponding to patients infected with Type B HIV, plotted in the first 3 PCs. Paths <lb/>between minima indicate likely evolutionary pathways. Minima corresponding to patients with Type 01 AE and Type C HIV <lb/>were unconnected to the other minima. (C) Disconnectivity graph for connected minima, where vertical evolution frequency <lb/>is assumed to be proportional to the normalized energy barriers (top). The disconnectivity graph reproduces the majority <lb/>of the structure of a distance-based phylogenetic tree (bottom), where the lengths of vertical lines are proportional to the <lb/>Jukes-Cantor sequence distance (scaled to [0, 1]). <lb/>DISCUSSION <lb/>Preserving landscape topology under dimensionality <lb/>reduction <lb/>Finding the appropriate number of collective macro-<lb/>variables to describe an energy landscape is a generic <lb/>problem relevant to many fields. For example, al-<lb/>though some proteins can be described through effec-<lb/>tive one-dimensional reaction coordinates 5 , the accu-<lb/>rate description of their diffusive dynamics over the full <lb/>microscopic energy landscape requires many degrees of <lb/>freedom 37 . Whenever dynamics are inherently high-<lb/>dimensional, topology-preserving dimensionality reduc-<lb/>tion can enable a much faster search of the energy land-<lb/>scape for minima and MEPs. In practice, data dimension <lb/>is often reduced with PCA or similar methods before con-<lb/>structing an energy landscape 37,38 . The extent to which <lb/>commonly used dimensionality reduction techniques al-<lb/>ter MEP network topology or quantitatively preserve en-<lb/>ergy barriers is not well understood. Eq. (3) suggests <lb/>that reducing dimensions using PCA should not intro-<lb/>duce significant errors if the variance of the landscape <lb/>around each state (energy minimum) in the neglected <lb/>dimensions is similar. For instance, we found that the <lb/>protein folding data could be reduced to five dimensions <lb/>while maintaining accuracy (Fig. S1), although addi-<lb/>tional higher energy states may become evident in higher <lb/>dimensions. Overall, our theoretical results demonstrate <lb/>the benefits of combining an analytical PDF with a linear <lb/>dimensionality reduction technique so that the neglected <lb/>dimensions can be accounted for explicitly. <lb/>Biological and biophysical applications <lb/>Rapidly advancing imaging techniques, such as cryo-<lb/>genic electron microscopy (cryo-EM), will allow many <lb/>snapshots of biophysical structures to be taken at the <lb/>atomic level in the near future 3 . A biologically and bio-<lb/>physically important task will be to infer dynamical infor-<lb/>mation from such instantaneous static ensemble measure-<lb/>ments. The protein folding example in Fig. 2 suggests <lb/>that the framework introduced here can help overcome <lb/>this major challenge. Another promising area of future <lb/>application is the analysis of single-cell RNA-sequencing <lb/>data quantifying the expression within individual cells 18 . <lb/>In related recent work, an effective energy landscape of <lb/>single-cell expression snapshots was inferred using the <lb/>Laplacian of a k-nearest neighbor graph on the data, al-<lb/>lowing lineage information to be derived via a Markov <lb/>chain 13 . The GMM-based framework here provides a <lb/>complementary approach for reconstructing faithful low-<lb/>dimensional transition state dynamics from such high-<lb/>dimensional data. <lb/>Furthermore, the proof-of-concept results in Fig. 3 sug-<lb/>gests that our inference scheme for Markovian network <lb/>dynamics can be useful for studying viral and bacte-<lb/>rial evolution, which are often modeled as movements <lb/>through a series of DNA or protein sequences 39 . The fit-<lb/>ness landscape of an organism in sequence space is anal-<lb/>ogous to the negative of an effective energy landscape. <lb/>The process of fixation by a succession of mutants in a <lb/>population, whereby each mutant replaces the previous <lb/>lineage as the population&apos;s most recent common ances-<lb/>tor, has been modeled as a Markov process 40 . Successive <lb/></body>

			<page>6 <lb/></page>

			<body>sweeps to fixation have been observed in long-term evo-<lb/>lution experiments, promising groundbreaking data for <lb/>future analysis as whole-genome sequencing technologies <lb/>improve 41 . <lb/>Outlook and extensions <lb/>The inference protocol opens the possibility to ana-<lb/>lyze previously intractable multi-phase systems: many <lb/>high-dimensional physical, chemical and other stochastic <lb/>processes can be described by a Fokker-Planck dynam-<lb/>ics 1 , with phase equilibria corresponding to maxima of <lb/>the stationary distribution. By taking near-simultaneous <lb/>measurements of many subsystems within a large multi-<lb/>stable Fokker-Planck system, the above scheme allows <lb/>the inference of coexisting equilibria and transition rates <lb/>between them. Other possible applications may include <lb/>neuronal expression 9 and social networks 19 , which have <lb/>been described in terms of effective energy landscapes. <lb/>While we focused here on normal white-noise diffu-<lb/>sive behavior, as is typical of protein folding dynamics, <lb/>the above ideas can in principle be generalized to other <lb/>classes of stochastic exploration processes. Such exten-<lb/>sions will require replacing Eq. (2) through suitable gen-<lb/>eralized rate formulas, as have been derived for correlated <lb/>noise 1,42 . Conversely, the present framework provides a <lb/>means to test for diffusive dynamics: if the MFPTs of <lb/>an observed system differ markedly from those inferred <lb/>by the above protocol, then either important degrees of <lb/>freedom have not been measured; the system is out of <lb/>equilibrium on measurement time scales; or the system <lb/>does not have Brownian transition statistics, necessitat-<lb/>ing further careful investigation of its time dependence. <lb/>To conclude, the conformational dynamics of biophysi-<lb/>cal structures such as viruses and proteins are character-<lb/>ized by their metastable states and associated transition <lb/>networks, and can often be captured through Markovian <lb/>models. Current experimental techniques, such as cryo-<lb/>EM or RNA-sequencing, provide limited dynamical in-<lb/>formation. In these cases, transition networks must be <lb/>inferred from structural snapshots. Here, we have in-<lb/>troduced a numerical framework for inferring Markovian <lb/>state-transition networks via reconstructed energy land-<lb/>scapes from high-dimensional static data. The successful <lb/>application to protein folding and viral evolution path-<lb/>ways illustrates that high-dimensional energy landscapes <lb/>can be reduced in dimension without losing relevant topo-<lb/>logical information. Generally, the inference scheme pre-<lb/>sented here is applicable whenever the dynamics of a <lb/>high-dimensional physical, biological or social system can <lb/>be approximated by diffusion in an effective energy land-<lb/>scape. <lb/>METHODS <lb/>Population landscapes. A Gaussian mixture model <lb/>(GMM) was used to represent the probability density <lb/>function (PDF), or population landscape, of samples. <lb/>The PDF at position x of a GMM with C mixture com-<lb/>ponents in d dimensions is <lb/>p(x) = <lb/>C <lb/>i=1 <lb/>φ i p i (x) <lb/>p i (x) = <lb/>exp − 1 <lb/>2 (x − µ i ) <lb/>T Σ −1 <lb/>i (x − µ i ) <lb/>det (2πΣ i ) <lb/>, <lb/>where φ i are the weights of each component, µ i are the <lb/>means and Σ i are the covariance matrices. More details <lb/>on GMMs and how they were fit to data is given in the <lb/>Supplementary Information. <lb/>Mean first passage times. We form a discrete-state <lb/>continuous-time Markov chain on states given by the <lb/>minima of the energy landscape. For a pair of states α <lb/>and β directly connected by a minimum-energy pathway <lb/>via a saddle, we approximate the transition rate α → β <lb/>by the Kramers rate k αβ in Eq. (2), while if α and β <lb/>are not directly connected we set k αβ = 0. Given these <lb/>rates, the Markov chain has generator matrix M αβ where <lb/>M αβ = k αβ for α = β and M αα = − β:β =α k αβ . Then <lb/>the matrix τ αβ of MFPTs (hitting times) for transitions <lb/>α → β satisfies <lb/>γ <lb/>M αγ τ γβ = −1 for α = β, τ αα = 0. <lb/>Protein data pre-processing. Protein folding tra-<lb/>jectories were obtained from all-atom molecular dy-<lb/>namics (MD) simulations performed by D.E. Shaw <lb/>Research 31 . Data was subsampled by a factor of 5 to re-<lb/>duce the size. For some proteins, residues at the flexible <lb/>tails of proteins were removed from the dataset to reduce <lb/>noise. Pairwise distances between carbon alpha atoms <lb/>on the protein backbone were taken, with a cut off of 6-<lb/>8 Å, depending on the size of the protein. Samples were <lb/>reduced in dimension using principal component analysis <lb/>(PCA). The first five principle components of the protein <lb/>data were found to be sufficient for inference of energy <lb/>landscapes and transition networks (Fig. S1). <lb/></body>

			<div type="availability">Code availability. The source code used in this study <lb/>to learn a dynamical transition network and mean first <lb/>passage times from a Gaussian mixture model is pub-<lb/>licly available from Github (https://github.com/philip-<lb/>pearce/learning-dynamical). Also included are all data <lb/>processing codes required to convert the raw data used <lb/>in this study into the appropriate format. <lb/></div>

			<div type="availability">Data availability. <lb/>Two publicly available <lb/>datasets were used in this study. <lb/>Protein folding <lb/>trajectories 31 are available from D.E. Shaw Research <lb/>(https://www.deshawresearch.com/). HIV sequences 35 <lb/>are available from https://hiv.biozentrum.unibas.ch/. <lb/></div>

			<page>7 <lb/></page>

			<div type="acknowledgement">ACKNOWLEDGMENTS <lb/>We thank D.E. Shaw Research for protein folding tra-<lb/>jectories and Stefano Piana-Agostinetti of D.E. Shaw <lb/>Research for helpful discussions. This work was sup-<lb/>ported by the Royal Society International Exchanges <lb/>award IE160909 (H.K. and J.D.) and Complex Systems <lb/>Scholar Award from the James S. McDonnell Foundation <lb/>(J.D.). <lb/></div>

			<listBibl>1 Hänggi, P., Talkner, P. &amp; Borkovec, M. Reaction-rate the-<lb/>ory: Fifty years after Kramers. Rev Mod Phys 62, 251 <lb/>(1990). <lb/>2 Yukalov, V. Phase transitions and heterophase fluctua-<lb/>tions. Phys Rep 208, 395-489 (1991). <lb/>3 Dashti, A. et al. Trajectories of the ribosome as a Brownian <lb/>nanomachine. Proc Natl Acad Sci USA 111, 17492-17497 <lb/>(2014). <lb/>4 Chung, H. S., Piana-Agostinetti, S., Shaw, D. E. &amp; Eaton, <lb/>W. A. Structural origin of slow diffusion in protein folding. <lb/>Science 349, 1504-1510 (2015). <lb/>5 Neupane, K., Manuel, A. P. &amp; Woodside, M. T. Pro-<lb/>tein folding trajectories can be described quantitatively <lb/>by one-dimensional diffusion over measured energy land-<lb/>scapes. Nat Phys 12, 700-703 (2016). <lb/>6 Hosseinizadeh, A. et al. Conformational landscape of a <lb/>virus by single-particle X-ray scattering. Nat Methods 14, <lb/>877-881 (2017). <lb/>7 Best, R. B. &amp; Hummer, G. Diffusive model of protein <lb/>folding dynamics with Kramers turnover in rate. Phys Rev <lb/>Lett 96, 228104 (2006). <lb/>8 Rondin, L. et al. Direct Measurement of Kramers Turnover <lb/>with a Levitated Nanoparticle. Nat Nanotechnol 12, 1130-<lb/>1133 (2017). <lb/>9 Ezaki, T., Watanabe, T., Ohzeki, M. &amp; Masuda, N. Energy <lb/>landscape analysis of neuroimaging data. Phil Trans R Soc <lb/>A 375, 20160287 (2016). <lb/>10 Corson, F. &amp; Siggia, E. D. Geometry, epistasis, and de-<lb/>velopmental patterning. Proc Natl Acad Sci USA 109, <lb/>5568-5575 (2012). <lb/>11 Lang, A. H., Li, H., Collins, J. J. &amp; Mehta, P. Epige-<lb/>netic Landscapes Explain Partially Reprogrammed Cells <lb/>and Identify Key Reprogramming Genes. PLOS Comput <lb/>Biol 10, e1003734 (2014). <lb/>12 Pusuluri, S. T., Lang, A. H., Mehta, P. &amp; Castillo, H. E. <lb/>Cellular reprogramming dynamics follow a simple 1D re-<lb/>action coordinate. Phys Biol 15, 016001 (2017). <lb/>13 Weinreb, C., Wolock, S., Tusi, B. K., Socolovsky, M. &amp; <lb/>Klein, A. M. Fundamental limits on dynamic inference <lb/>from single-cell snapshots. Proc Natl Acad Sci USA (2018). <lb/>14 Jin, S., MacLean, A. L., Peng, T. &amp; Nie, Q. scEpath: <lb/>Energy landscape-based inference of transition probabili-<lb/>ties and cellular trajectories from single-cell transcriptomic <lb/>data. Bioinformatics 34, 2077-2086 (2018). <lb/>15 Ballard, A. J. et al. Energy landscapes for machine learn-<lb/>ing. Phys Chem Chem Phys 19, 12585-12603 (2017). <lb/>16 Ferguson, A. L. et al. Translating HIV Sequences into <lb/>Quantitative Fitness Landscapes Predicts Viral Vulnera-<lb/>bilities for Rational Immunogen Design. Immunity 38, <lb/>606-617 (2013). <lb/>17 Ebeling, W. &amp; Feistel, R. Studies on Manfred Eigen&apos;s <lb/>model for the self-organization of information processing. <lb/>Eur Biophys J 395-401 (2018). <lb/>18 Shalek, A. K. et al. Single-cell transcriptomics reveals bi-<lb/>modality in expression and splicing in immune cells. Nature <lb/>498, 236-240 (2013). <lb/>19 Marvel, S. A., Strogatz, S. H. &amp; Kleinberg, J. M. Energy <lb/>landscape of social balance. Phys Rev Lett 103, 198701 <lb/>(2009). <lb/>20 Stephens, G. J., Osborne, L. C. &amp; Bialek, W. Searching <lb/>for simplicity in the analysis of neurons and behavior. Proc <lb/>Natl Acad Sci USA 108, 15565-15571 (2011). <lb/>21 Wasserman, L. Topological data analysis. Annu Rev Stat <lb/>Appl 5, 501-532 (2018). <lb/>22 Mattingly, H. H., Transtrum, M. K., Abbott, M. C. &amp; <lb/>Machta, B. B. Maximizing the information learned from <lb/>finite data selects a simple model. Proc Natl Acad Sci USA <lb/>115, 1760-1765 (2018). <lb/>23 Continuous changes in structure mapped by manifold em-<lb/>bedding of single-particle data in cryo-EM. Methods 100, <lb/>61-67 (2016). <lb/>24 Westerlund, A. M., Harpole, T. J., Blau, C. &amp; Delemotte, <lb/>L. Inference of Calmodulin&apos;s Ca 2+ -Dependent Free En-<lb/>ergy Landscapes via Gaussian Mixture Model Validation. <lb/>J Chem Theory Comput 14, 63-71 (2018). <lb/>25 Jónsson, H., Mills, G. &amp; Jacobsen, K. W. Nudged elastic <lb/>band method for finding minimum energy paths of transi-<lb/>tions. In Classical and Quantum Dynamics in Condensed <lb/>Phase Simulations, 385-404 (World Scientific, 1998). <lb/>26 Trygubenko, S. A. &amp; Wales, D. J. A doubly nudged elastic <lb/>band method for finding transition states. J Chem Phys <lb/>120, 2082-2094 (2004). <lb/>27 Kusumaatmaja, H. Surveying the free energy landscapes <lb/>of continuum models: Application to soft matter systems. <lb/>J Chem Phys 142, 124112 (2015). <lb/>28 Kramers, H. A. Brownian motion in a field of force and the <lb/>diffusion model of chemical reactions. Physica 7, 284-304 <lb/>(1940). <lb/>29 Dunkel, J., Ebeling, W., Schimansky-Geier, L. &amp; Hänggi, <lb/>P. Kramers problem in evolutionary strategies. Phys Rev <lb/>E 67, 061118 (2003). <lb/>30 Mardt, A., Pasquali, L., Wu, H. &amp; Noé, F. VAMPnets <lb/>for deep learning of molecular kinetics. Nat Commun 9, 5 <lb/>(2018). <lb/>31 Lindorff-Larsen, K., Piana, S., Dror, R. O. &amp; Shaw, D. E. <lb/>How fast-folding proteins fold. Science 334, 517-520 <lb/>(2011). <lb/>32 Kalai, A. T., Moitra, A. &amp; Valiant, G. Disentangling Gaus-<lb/>sians. Commun ACM 55, 113-120 (2010). <lb/>33 Bühlmann, P., Kalisch, M. &amp; Meier, L. High-Dimensional <lb/>Statistics with a View Toward Applications in Biology. <lb/>Annu Rev Stat Appl 1, 255-278 (2014). <lb/>34 Brenner, M. P., Colwell, L. J. et al. Optimal design of <lb/>experiments by combining coarse and fine measurements. <lb/>Phys Rev Lett 119, 208101 (2017). <lb/>35 Zanini, F. et al. Population genomics of intrapatient HIV-1 <lb/>evolution. Elife 4, e11282 (2015). <lb/>36 Gokhale, C. S., Iwasa, Y., Nowak, M. A. &amp; Traulsen, A. <lb/></listBibl>

			<page>8 <lb/></page>

			<listBibl>The pace of evolution across fitness valleys. J Theor Biol <lb/>259, 613-620 (2009). <lb/>37 Ferguson, A. L., Panagiotopoulos, A. Z., Kevrekidis, I. G. <lb/>&amp; Debenedetti, P. G. Nonlinear dimensionality reduc-<lb/>tion in molecular simulation: The diffusion map approach. <lb/>Chem Phys Lett 509, 1-11 (2011). <lb/>38 Ernst, M., Sittel, F. &amp; Stock, G. Contact-and distance-<lb/>based principal component analysis of protein dynamics. J <lb/>Chem Phys 143, 244114 (2015). <lb/>39 Orr, H. A. Fitness and its role in evolutionary genetics. <lb/>Nat Rev Genet 10, 531-539 (2009). <lb/>40 Sella, G. &amp; Hirsh, A. E. The application of statistical <lb/>physics to evolutionary biology. Proc Natl Acad Sci USA <lb/>102, 9541-9546 (2005). <lb/>41 Barrick, J. E. &amp; Lenski, R. E. Genome dynamics dur-<lb/>ing experimental evolution. Nat Rev Genet 14, 827-839 <lb/>(2013). <lb/>42 Sharma, A., Wittmann, R. &amp; Brader, J. M. Escape rate of <lb/>active particles in the effective equilibrium approach. Phys <lb/>Rev E 95, 012115 (2017). </listBibl>


	</text>
</tei>
