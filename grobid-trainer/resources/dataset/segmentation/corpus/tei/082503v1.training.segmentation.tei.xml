<?xml version="1.0" ?>
<tei xml:space="preserve">
	<teiHeader>
		<fileDesc xml:id="0"/>
	</teiHeader>
	<text xml:lang="en">
			<front>Title <lb/>Fidelity of parent-offspring transmission and the evolution of social behavior in <lb/>structured populations <lb/>Author <lb/>F. Débarre <lb/>ORCID 0000-0003-2497-833X <lb/>Address <lb/>Centre Interdisciplinaire de Recherche en Biologie (CIRB) <lb/>Collège de France <lb/>CNRS UMR 7241 -Inserm U1050 <lb/>11, Place Marcelin Berthelot <lb/>75231 Paris Cedex 05 <lb/>France <lb/>email florence.debarre@normalesup.org <lb/>phone +33 1 44 27 14 09 <lb/>Length <lb/>228 words in the abstract, <lb/>4998 words in the main text, <lb/>4 figures (color) [in the text + at the end], <lb/>1 supplementary material (Appendix), <lb/>1 zipped folder of scripts [uploaded on figshare, <lb/>https://figshare.com/articles/Mutation_and_social_ <lb/>evolution/3207748 ] <lb/> 1 <lb/> Abstract <lb/>The theoretical investigation of how spatial structure affects the evolution of so-<lb/>cial behavior has mostly been done under the assumption that parent-offspring <lb/>strategy transmission is perfect, i.e., for genetically transmitted traits, that muta-<lb/>tion is very weak or absent. Here, we investigate the evolution of social behavior <lb/>in structured populations under arbitrary mutation probabilities. We consider <lb/>populations of fixed size N , structured such that in the absence of selection, all <lb/>individuals have the same probability of reproducing or dying (neutral repro-<lb/>ductive values are the all same). Two types of individuals, A and B , correspond-<lb/>ing to two types of social behavior, are competiting; the fidelity of strategy trans-<lb/>mission from parent to offspring is tuned by a parameter µ. Social interactions <lb/>have a direct effect on individual fecundities. Under the assumption of small <lb/>phenotypic differences (weak selection), we provide a formula for the expected <lb/>frequency of type A individuals in the population, and deduce conditions for <lb/>the long-term success of one strategy against another. We then illustrate this <lb/>result with three common life-cycles (Wright-Fisher, Moran Birth-Death and <lb/>Moran Death-Birth), and specific population structures (graph-structured pop-<lb/>ulations). Qualitatively, we find that some life-cycles (Moran Birth-Death, Wright-<lb/>Fisher) prevent the evolution of altruistic behavior, confirming previous results <lb/>obtained with perfect strategy transmission. We also show that computing the <lb/>expected frequency of altruists on a regular graph may require knowing more <lb/>than just the graph&apos;s size and degree. <lb/></front>

			<page>2 <lb/></page>

			<front>Keywords <lb/>mutation, relatedness, altruism, evolutionary graph theory <lb/></front>

			<page>3 <lb/></page>

			<body>1 Introduction <lb/>Most models on the evolution of social behavior in structured populations study <lb/>the outcome of competition between individuals having different strategies and <lb/>assume that strategy transmission from parents to their offspring is almost per-<lb/>fect (i.e., when considering genetic transmission, that mutation is either vanish-<lb/>ingly small or absent). This is for instance illustrated by the use of fixation prob-<lb/>abilities to assess evolutionary success (e.g., Nowak et al., 2004; Nowak, 2006; <lb/>Ohtsuki et al., 2006). Yet, mutation has been shown to affect the evolutionary <lb/>fate of social behavior (Frank, 1997; Tarnita et al., 2009) and is, more generally, <lb/>a potentially important evolutionary force. Here, we explore the role of imper-<lb/>fect strategy transmission-genetic or cultural-from parents to offspring on the <lb/>evolution of social behavior, when two types of individuals, with different social <lb/>strategies, are competing. We are interested in evaluating the long-term success <lb/>of one strategy over another. <lb/>A population in which mutation is not close (or equal) to zero will spend a <lb/>non-negligible time in mixed states (i.e., in states where both types of individ-<lb/>uals are present), so instead of fixation probabilities, we need to consider long-<lb/>term frequencies to assess evolutionary success (Tarnita et al., 2009; Wakano &amp; <lb/>Lehmann, 2014; Tarnita &amp; Taylor, 2014). We will say that a strategy is favored <lb/>by selection when its expected frequency is larger than what it would be in the <lb/>absence of selection. <lb/>In this study, we consider populations such that, in the absence of selection <lb/>(when social interactions have no effect on fitness), all individuals have equal <lb/>chances of reproducing, and equal chances of dying. In other words, in such a <lb/></body>

			<page>4 <lb/></page>

			<body>population of size N , the neutral reproductive value of each site is 1/N (Taylor, <lb/>1990; Maciejewski, 2014; Tarnita &amp; Taylor, 2014). We provide a formula that gives <lb/>the long-term frequency of a social strategy in any such population, for arbitrary <lb/>mutation rates, and for any life-cycle (provided population size remains equal <lb/>to N ). This formula is a function of the probabilities that pairs of individuals <lb/>are identical by descent. These probabilities are obtained by solving a linear <lb/>system of equations, and we present explicit solutions for population structures <lb/>with a high level of symmetry (structures that we call &quot;n-dimensional graphs&quot;). <lb/>We finally illustrate our results with widely used updating rules (Moran models, <lb/>Wright-Fisher model) and specific population structures. <lb/>2 Models and Methods <lb/>Population structures <lb/>We consider a population of fixed size N , where each individual inhabits a site <lb/>corresponding to the node of a graph D; each site hosts exactly one individual. <lb/>The edges of the graph, {d i j } 1≤i , j ≤N , define where individuals can send their <lb/>offspring to; we consider graphs D that are connected, i.e., such that following <lb/>the edges of the graph, we can go from any node to any other node. Another <lb/>graph, E, with the same nodes as graph D but with edges {e i j } 1≤i , j ≤N , defines <lb/>the social interactions between the individuals; E can be the same graph as D, <lb/>but does not have to be (Taylor et al., 2007a; Ohtsuki et al., 2007; Débarre et al., <lb/>2014). The edges of the two graphs can be weighted (i.e., d i j and e i j can take <lb/>any non-negative value) and directed (i.e., we can have d i j = d j i or e i j = e j i for <lb/>some sites i and j ). Finally, we denote by D and E the adjacency matrices of the <lb/></body>

			<page>5 <lb/></page>

			<body>dispersal and interaction graphs, respectively. <lb/>Regular dispersal graphs In this study, we focus on dispersal graphs that are <lb/>regular, i.e., such that for all sites i , the sum of the edges to i and the sum of the <lb/>edges from i are both equal to ν: <lb/>N <lb/>j =1 <lb/>d i j = <lb/>N <lb/>j =1 <lb/>d j i = ν, <lb/>(1) <lb/>where ν is called degree of the graph when the graph is unweighted. All the <lb/>graphs depicted in the article satisfy eq. (1). Note that there is no specific con-<lb/>straint on the interaction graph E. <lb/>More detailed results are then obtained for regular graphs that display some <lb/>level of symmetry, that we now describe: <lb/>Transitive dispersal graphs A transitive graph is such that for any two nodes <lb/>i and j of the graph, there is an isomorphism that maps i to j (Taylor et al., <lb/>2007a; ?); in other words, the graph looks the same from every node. In figure 1, <lb/>graphs (b)-(e) are transitive. <lb/>Transitive undirected dispersal graphs A graph is undirected if for any <lb/>two nodes i and j , d i j = d j i . In figure 1, graphs (b), (c), (e) are both transitive <lb/>and undirected. <lb/>&quot;n-dimensional&quot; dispersal graphs We call &quot;n-dimensional graphs&quot; tran-<lb/>sitive graphs whose nodes can be relabelled with n-long indices, such that the <lb/>graph is unchanged by circular permutation of the indices in each dimension. <lb/></body>

			<page>6 <lb/></page>

			<body>n-dimensional <lb/>1-D <lb/>2-D <lb/>(a) <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>1 <lb/>2 <lb/>3 <lb/> 4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>(b) <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>(c) <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>(d) <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>(e) <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/> Figure 1: Examples of regular graphs of size 12. The graphs on the first line are <lb/>unoriented and unweighted graphs of degree ν = 3; Graph (d) is oriented, graph (e) <lb/>is weighted. (a) is the Frucht graph, and has no symmetry. Graphs (b) and (d) are <lb/>one-dimensional, graphs (c) and (e) are two-dimensional (see main text). <lb/>The graphs can be directed and weighted. We denote by N the ensemble of <lb/>node indices: N = {0, . . . , N 1 −1}×• • •×{0, . . . , N n −1}, with n <lb/>k=1 N n = N ; number-<lb/>ing is done modulo N k in dimension k. Then for all indices i , j and l of N , node <lb/>labelling is such that for all edges (modulo the size of each dimension), <lb/>d i j = d i +k, j +k . <lb/>(2) <lb/>In figure 1, graphs (b) and (d) are 1-dimensional: we can label their nodes such <lb/>that the adjacency matrices are circulant. Graphs (c) and (e) are 2-dimensional: <lb/>the adjacency matrices are block-circulant, with each block being circulant. In <lb/>1(c), one dimension corresponds to the angular position of a node (N 1 = 6 posi-<lb/>tions), and the other dimension to the radial position of a node (N 2 = 2 positions, <lb/></body>

			<page>7 <lb/></page>

			<body>inner or outer hexagon). In 2(e), one dimension corresponds to the horizontal <lb/>position of a node (N 1 = 4 positions) and the other to the vertical position of a <lb/>node (N 2 = 3 positions). Condition eq. (2) may sound strong, but is satisfied for <lb/>the regular population structures classically studied, like stepping-stones (e.g., <lb/>cycle graphs, lattices), or island models (Taylor, 2010; Taylor et al., 2011). <lb/>Types of individuals and social interactions <lb/>There are two types (A and B ) of individuals in the population, corresponding to <lb/>two strategies of social behavior. There are no mixed strategies: an individual of <lb/>type A plays strategy A, and individuals do not change strategies. The indicator <lb/>variable X i represents the type of the individual present at site i : X i is equal to 1 <lb/>if the individual at site i is of type A, and X i is equal to 0 otherwise (X i = 1 A (i )). <lb/>A N -long vector X gathers the identities of all individuals in the population, and <lb/>X is the population average of X (X = N <lb/>i =1 X i /N ). <lb/>Individuals in the population reproduce asexually. Fecundities are affected <lb/>by social interactions, and are gathered in a N -long vector f . We assume that <lb/>the genotype-phenotype map is such that the two types A and B are close in <lb/>phenotype space: the individual living at site i expresses a phenotype δX i , with <lb/>δ 1 (a feature called &quot;δ-weak selection&quot; by Wild &amp; Traulsen (2007)). <lb/>An individual&apos;s fecundity depends on its own phenotype and on its interac-<lb/>tion neighborhood. Interaction neighborhoods are determined by the interac-<lb/>tion graph E, and the effect of social interactions on fecundity are given by a <lb/></body>

			<page>8 <lb/></page>

			<body>function φ. We assume that the baseline fecundity is φ(0, 0) = 1, so that <lb/>f i (X , δ) = φ δX i , <lb/>l <lb/>e l i δX l <lb/>= 1 + δ X i ∂ (1) φ(0, 0) + <lb/>l <lb/>e l i X l ∂ (2) φ(0, 0) + O(δ 2 ), <lb/>(3a) <lb/>where ∂ (n) φ(0, 0) represents the partial derivative of φ with respect to its n th ele-<lb/>ment, evaluated at (0, 0), and l refers to the sum N <lb/>l =1 . If we write b = ∂ (2) φ(0, 0) <lb/>and −c = ∂ (1) φ(0, 0), then eq. (3a) becomes <lb/>f i (X , δ) = 1 + δ −cX i + b <lb/>l <lb/>e l i X l + O(δ 2 ). <lb/>(3b) <lb/>Our results are valid for any b and c, but throughout the article, we will consider <lb/>the case where b &gt; 0 and c &gt; 0, so that type-A individuals are &quot;altruists&quot;, and <lb/>we will seek to understand the impact of imperfect strategy transmission on the <lb/>frequency of altruists. When δ = 0, all individuals in the population, whichever <lb/>their type, have the same fecundity: the trait is then neutral. <lb/>Reproduction and mutation <lb/>The expected number of successful offspring established at site j at the next <lb/>time step, descending from the individual who is living at site i at the current <lb/>time step, is denoted by B j i ( f (X , δ)), written B j i for simplicity. &quot;Successful off-<lb/>spring&quot; of a focal individual means individuals who descend from this focal in-<lb/>dividual and who are alive and established at the start of the next time step. <lb/>Because there is exactly one individual per site, 0 ≤ B j i ≤ 1. Mutation among <lb/>offspring occurs with probability µ, 0 &lt; µ ≤ 1; when mutation occurs, the off-<lb/></body>

			<page>9 <lb/></page>

			<body>spring are of type A with probability p and of type B otherwise (0 &lt; p &lt; 1). For <lb/>instance, under this mutation scheme, the offspring of an individual of type A <lb/>is also of type A with probability 1 − µ + µp (Taylor et al., 2007b; Nowak et al., <lb/>2010; Tarnita &amp; Taylor, 2014). The parameter p controls the asymmetry of muta-<lb/>tion, and it is also the expected frequency of type-A individuals in the absence <lb/>of selection (i.e., when δ = 0). Although we use the word &quot;mutation&quot;, which hints <lb/>at a genetic transmission of the trait, this framework can also describe vertical <lb/>cultural transmission, so µ does not have to be small. The mutation probability, <lb/>however, cannot be zero; if it were, the all-A and all-B states would be absorb-<lb/>ing: we would end up either with only type-A or only type-B individuals in the <lb/>population, and we would not be able to define a stationary distribution of pop-<lb/>ulation states-for similar reasons, p cannot be 0 nor 1. <lb/>We denote by D i ( f (X , δ)) (or D i for simplicity) the probability that the indi-<lb/>vidual living at site i is dead at the beginning of the next time step, given that the <lb/>population is currently in state X . This probability of death at site i can be ex-<lb/>pressed as a function of the probabilities of birth and establishment of offspring <lb/>at site i , summing over the locations j of the potential parents: <lb/>D i = <lb/>N <lb/>j =1 <lb/>B i j . <lb/>(4) <lb/>There is exactly one individual per site, so at a given site i , there can be at most <lb/>one successfully established offspring at each time step, and 0 ≤ D i ≤ 1. On the <lb/>other hand, the expected number of offspring of the parent currently living at <lb/></body>

			<page>10 <lb/></page>

			<body>site i is 0 ≤ N <lb/>j =1 B j i ≤ N . We denote by <lb/>W i = <lb/>N <lb/>j =1 <lb/>B j i + (1 − D i ) <lb/>(5) <lb/>the expected contribution to the next time step of the individual living in site j : <lb/>this includes this individual&apos;s successful offspring, and the individual itself if it <lb/>survived-a quantity that we can also refer to as &quot;fitness&quot;. <lb/>Finally, we are considering population structures such that in the absence of <lb/>selection (δ = 0), all individuals have the same probability of reproducing, and <lb/>all individuals have the same probability of dying-meaning that all sites in the <lb/>population have the same reproductive value 1/N (Taylor, 1990; Caswell, 2001; <lb/>Maciejewski, 2014); this implies that for all sites i <lb/>N <lb/>j =1 <lb/>B j i ( f (X , 0)) = B * = D i ( f (X , 0)). <lb/>(6) <lb/>Life-cycles <lb/>Most of our results are derived without specifying a life-cycle (also called &quot;up-<lb/>dating rule&quot;). In the Illustrations section, we will give specific examples using <lb/>classical life-cycles: Moran models (Birth-Death and Death-Birth), with exactly <lb/>one birth and one death during a time step, and the Wright-Fisher model, where <lb/>all adults die and are replaced by new individuals at the end of a time step. <lb/></body>

			<page>11 <lb/></page>

			<body>3 Results <lb/>Expected frequency of type-A individuals in the population <lb/>We describe here the key steps of the computation of the expected frequency <lb/>of type-A individuals in the population and refer the reader to Appendix A for <lb/>mathematical details. <lb/>The expected frequency of type-A individuals in the population, denoted by <lb/>E X , can be computed from the stationary distribution of population states, <lb/>considering what happens during one during step. We denote by Ω the set of <lb/>all possible states of the population and by ξ(X , δ, µ) the probability that the <lb/>population is in state X , in a model with strength of selection (phenotype dif-<lb/>ferences) δ and mutation probability µ (ξ is the stationary distribution of pop-<lb/>ulation states). Given state X of the population, at the end of the time step, the <lb/>state of the individual living at site i depends on whether it has survived dur-<lb/>ing the time step (first term within the brackets of eq. (7)), and, if it has been <lb/>replaced, on the type of the newly established offspring (second term within the <lb/>brackets); we then take the expectation over all population states, and obtain: <lb/>E X = <lb/>X ∈Ω <lb/>1 <lb/>N <lb/>N <lb/>i =1 <lb/>(1 − D i )X i + <lb/>N <lb/>j =1 <lb/>B i j X j (1 − µ) + µp ξ(X , δ, µ). <lb/>(7) <lb/>This is the expected frequency of type-A individuals in the population. For in-<lb/>stance, if we run a simulation of the model for a very long time, the average over <lb/>time of the frequency of type-A individuals will provide an estimation of E X ; <lb/>this quantity does not depend on the initial state of the population. <lb/>We then assume that selection is weak, i.e., δ is small, and write a first-order <lb/></body>

			<page>12 <lb/></page>

			<body>expansion of eq. (7) that contains derivatives of ξ, D i and B i j with respect to δ. <lb/>For the last two, we further use the chain rule with the variables f k , which rep-<lb/>resent the fecundity of the individual living at site k. In doing so, we let appear <lb/>quantities that are the expectations of the state of pairs of sites when no selec-<lb/>tion is acting (i.e., when δ = 0; we call these &quot;neutral expectations&quot; and ξ(X , 0, µ) <lb/>is called neutral stationary distribution): <lb/>P j k = <lb/>X ∈Ω <lb/>X j X k ξ(X , 0, µ) = E 0 X j X k . <lb/>(8) <lb/>The fact that these neutral expectations appear in our equations does not <lb/>mean that selection is initially not acting and then &quot;turned on&quot;: selection is act-<lb/>ing all the time, but it is weak because phenotypic differences are small (δ 1). <lb/>At the first order in δ, we can ignore the effect of selection on the expected state <lb/>of pairs of sites, and this is why we only need neutral expectations (eq. (8)). <lb/>Eventually, we deduce that the expected frequency of individuals of type A <lb/>in the population can be written as <lb/>E X ≈ p + <lb/>δ <lb/>µB * <lb/>βb − γc <lb/>N <lb/>, <lb/>(9) <lb/>with <lb/>β = <lb/>j ,k,l i <lb/>(1 − µ) ∂ f k B i j − ∂ f k D j e l k P j l + µ <lb/>i , j ,k,l <lb/>∂ f k B i j e l k p 2 , <lb/>(10a) <lb/>γ = <lb/>j ,k i <lb/>(1 − µ) ∂ f k B i j − ∂ f k D j P j k + µ <lb/>i , j ,k <lb/>∂ f k B i j p 2 , <lb/>(10b) <lb/>with P as defined in eq. (8) and ∂ f k being a shorthand notation for ∂ <lb/>∂ f k δ=0 <lb/>. Eq. (9) <lb/></body>

			<page>13 <lb/></page>

			<body>is an approximation at the first order in δ (we neglect terms in δ 2 and higher). A <lb/>weak mutation approximation of eq. (9) is presented in Appendix A.4. <lb/>The formulas for β and γ (eq. (10a)-eq. (10b)) are still implicit, because we <lb/>need to evaluate the P i j terms, which we now do. <lb/>Expected state of pairs of sites at neutrality <lb/>We recall that P i j , defined in eq. (8), is also the probability that both sites i and j <lb/>are occupied by individuals of type A, at neutrality (i.e., when δ = 0). Under van-<lb/>ishing mutation (µ → 0), convenient connections can be made between identity <lb/>in state and identity-by-descent (Cockerham &amp; Weir, 1993; Rousset et al., 2000), <lb/>and then with coalescence times (Slatkin, 1991, 1993; Rousset, 2004; Allen et al., <lb/>2012). Here as well, we can characterize P i j in terms of probabilities of identity-<lb/>by-descent, Q i j . Two individuals at sites i and j are said to be identical by de-<lb/>scent (IBD) if they share a common ancestor and if no mutation occurred in <lb/>their lineages since this common ancestor (Kimura &amp; Crow, 1964, note though <lb/>that the original definition is with an infinite allele model, where each mutation <lb/>creates a new allele). If two individuals are IBD, then they are both of type A <lb/>with probability p, the expected state of a single individual at neutrality. If two <lb/>individuals are not IBD, then they are both of type A with probability p 2 . Sim-<lb/>plifying, we obtain <lb/>P i j = p 2 +Q i j p (1 − p) <lb/>(11) <lb/> (Allen &amp; Nowak, 2014) (see Appendix B.1 for more details). Eq. (11) also valid <lb/>when i = j . So we can work with IBD relationships. <lb/>To find the probabilities of identity-by-descent, we first write the probability <lb/></body>

			<page>14 <lb/></page>

			<body>that two individuals at sites i and j are IBD given the state X of the population at <lb/>the previous time step, and then take the expectation of this conditional prob-<lb/>ability. We can still do so without specifying the way the population is updated <lb/>(using notation as in Allen et al. (2015)), and the resulting equation is presented <lb/>in Appendix B.1, eq. (B.1). This equation can also be adapted to specific up-<lb/>dating rules, as shown in the Illustrations section (details of the calculations are <lb/>provided in Appendix B). <lb/>Keeping in mind that Q i j = Q j i and that Q i i = 1, we then have to solve a <lb/>linear system of N (N − 1)/2 equations to obtain explicit formulas for all the Q i j <lb/>terms, for any regular graph. More explicit formulas for Q i j can be found for <lb/>regular graphs, and in particular for n-dimensional graphs, as we will see in the <lb/>Illustrations section. Finally, we can gather all probabilities of identity by de-<lb/>scent in a matrix Q. <lb/>Back to the expected frequency of type-A individuals <lb/>Using the relationship between the expected state of pairs of sites P i j and prob-<lb/>abilities of identity-by-descent Q i j (eq. (11)), we can rewrite eq. (9) as follows: <lb/>E X ≈ p + δ <lb/>p(1 − p) <lb/>µB * N <lb/>b <lb/>j ,k,l <lb/>e kl ∂ f l W j Q j k − c <lb/>j ,k <lb/>∂ f k W j Q j k , <lb/>(12) <lb/>where as before ∂ f k is a shorthand notation for ∂ <lb/>∂ f k δ=0 <lb/>; W j , the fitness of indi-<lb/>vidual j , was defined in eq. (5). <lb/>Interpretation For each focal individual at site k, we consider the influence <lb/>that this individual can have on an identical-by-descent individual at site j (Q j k ). <lb/></body>

			<page>15 <lb/></page>

			<body>The focal k can directly provide a benefit to j (b e k j ) and hence affect j &apos;s fitness <lb/>(∂ f j W j ), but k can also provide a benefit to another individual l (b e kl ), and the <lb/>resulting change of l &apos;s fecundity affects j &apos;s fitness (∂ f l W j ). By paying the cost of <lb/>being of type A (c), k affects its own fitness (∂ f k W k ) but also indirectly the fitness <lb/>of j (∂ f k W j ). <lb/>Structure parameter We say that a strategy is favored if its frequency at the <lb/>mutation-selection-drift equilibrium is higher than what it would be in the ab-<lb/>sence of selection. For type A, this translates into E X &gt; p . With eq. (12), this <lb/>condition becomes <lb/>j ,k,l e kl ∂ f l W j Q j k <lb/>j ,k ∂ f k W j Q j k <lb/>κ <lb/>b − c &gt; 0. <lb/>(13) <lb/>Hence, a single parameter, κ, summarizes, for a given life-cycle, the structure <lb/>of the population and the effect of mutation (Tarnita et al., 2009; Taylor &amp; Ma-<lb/>ciejewski, 2012); κ is interpreted as a scaled coefficient of relatedness, that in-<lb/>cludes the effect of competition (Lehmann &amp; Rousset, 2010). <lb/>4 Illustrations <lb/>Updating rules <lb/>The results presented so far were valid for any updating rule, provided it is such <lb/>that population size remains equal to N . We now express the expected frequency <lb/>of type-A individuals for specific updating rules, commonly used in studies on <lb/>the evolution of altruistic behavior in structured populations: the Moran model <lb/>and the Wright-Fisher model. Under a Moran model (Moran, 1962), exactly one <lb/></body>

			<page>16 <lb/></page>

			<body>individual dies and one individual reproduces during one time step; hence, at <lb/>neutrality, B * = 1/N (B * was defined in eq. (6)). The order of the two events <lb/>matters, so two updating rules are distinguished (Ohtsuki &amp; Nowak, 2006; Oht-<lb/>suki et al., 2006): Birth-Death and Death-Birth. In both cases, payoffs are com-<lb/>puted at the start of each time step, before anything happens. <lb/>Moran model, Birth-Death <lb/>Any regular graph Under a Birth-Death (BD) updating, an individual j is cho-<lb/>sen to reproduce with a probability equal to its relative fecundity in the popula-<lb/>tion ( f j / l f l ); then its offspring disperses at random along the D graph, and so <lb/>displaces another individual i with a probability d j i /ν, so that <lb/>B i j = <lb/>f j <lb/>l f l <lb/>d j i <lb/>ν <lb/>, and D j = <lb/>N <lb/>i =1 <lb/>B j i = <lb/>i f i d i j <lb/>ν l f l <lb/>. <lb/>(14) <lb/>Note that with this updating rule, the probability of dying D j depends on the <lb/>composition of the population. With these probabilities of reproducing and dy-<lb/>ing eq. (12) becomes, using the matrix notation, <lb/>E X ≈ p + δ <lb/>p(1 − p) <lb/>µ <lb/>b <lb/>1 <lb/>N <lb/>Tr (E • Q) − <lb/>1 <lb/>N ν <lb/>Tr (E • D • Q) − c 1 − <lb/>1 <lb/>N ν <lb/>Tr (D • Q) , <lb/>(15) <lb/>where Tr (M) denotes the trace of a matrix M, i.e., the sum of its diagonal ele-<lb/>ments. The factors of the benefits b and costs c contain direct (first terms) and <lb/>indirect (second terms) effects. The term Tr (E • Q) /N , associated to direct effects <lb/>of a benefit b, is the average probability of identity by descent with a social inter-<lb/>actant. It is discounted by the indirect effects Tr (E • D • Q) /(N ν), corresponding <lb/></body>

			<page>17 <lb/></page>

			<body>to the effects of a change in fecundity of competitors; with this updating rule, <lb/>competitors are one dispersal step away. Under a Birth-Death updating rule in-<lb/>deed, the survival of an individual at site k is reduced if another individual j <lb/>sends its offspring to site k, an event that occurs if the two are neighbors on <lb/>the dispersal graph (d j k ). So the competition neighborhood is determined by D <lb/>(Grafen &amp; Archetti, 2008). Similarly, the direct cost of a social interaction is dis-<lb/>counted by the effects on competitors (Tr (D • Q) /(N ν)). We can further note that <lb/>for all dispersal graphs, 1 − 1 <lb/>N ν Tr (D • Q) ≥ 0, i.e., that costs are always costly. We <lb/>will see below that benefits are not always beneficial (b&apos;s factor can be negative). <lb/>Probabilities of identity by descent With this updating rule, the probabil-<lb/>ities of identity by descent satisfy, for any i and j = i , <lb/>Q i j = <lb/>1 <lb/>2ν k <lb/>d k j Q ki + d ki Q k j . <lb/>(16) <lb/>(see Appendix B.2 for details on the derivation). For generic regular graphs, we <lb/>have to solve a system of N (N − 1)/2 equations to find the probabilities of iden-<lb/>tity by descent. <lb/>Transitive undirected graphs When the graph is transitive and undirected, <lb/>probabilities of identity by descent verify <lb/>Q = λ M I N − <lb/>1 − µ <lb/>ν <lb/>D <lb/>−1 <lb/>, <lb/>(17) <lb/>where I N is the identity matrix, and λ M is such that Q i ,i = 1 for all i (the M index <lb/>stands for &quot;Moran&quot;). In addition, we have 0 ≤ λ M ≤ 1. With eq. (17), eq. (15) <lb/></body>

			<page>18 <lb/></page>

			<body>simplifies into <lb/>E X ≈ p + δ <lb/>p(1 − p) <lb/>µ <lb/>b <lb/>−µ <lb/>1 − µ <lb/>Tr (E • Q) <lb/>N <lb/>+ <lb/>λ M <lb/>1 − µ <lb/>Tr (E) <lb/>N <lb/>− c 1 − <lb/>1 − λ M <lb/>1 − µ <lb/>. (18) <lb/>The term Tr (E) /N corresponds to social interactions with oneself; it is usually <lb/>considered as null in the case of pairwise interactions, but is not for common <lb/>good type of interactions (when benefits are pooled and then redistributed). So <lb/>unless interactions with oneself are strong (large Tr (E) /N ), the factor modulat-<lb/>ing the effect of benefits b is negative, and as a result the expected frequency of <lb/>altruists cannot be greater than what it would be in the absence of selection (i.e., <lb/>E X ≤ p.) <lb/>Evaluating probabilities of identity by descent in transitive regular graphs <lb/>still requires the inversion of a N by N matrix (eq. (17)), which can limit applica-<lb/>tions. Results are simpler in graphs that match our definition of &quot;n-dimensional <lb/>graphs&quot;; they depend on the dimensionality n of the graph and are presented in <lb/>Appendix B.2. <lb/>Moral model, Death-Birth <lb/>Any regular graph Under a Death-Birth (DB) updating, the individual who is <lb/>going to die is chosen first, uniformly at random (i is chosen with probability <lb/>1/N ). Then, all individuals produce offspring, and one of them (one offspring of <lb/>parent j wins with probability f j d j i / l f l d l i ) displaces the individual chosen <lb/>to die. When d i i = 0, one needs to clarify whether the individual chosen to die <lb/>reproduces before dying or not; here we assume that this is the case, but some <lb/></body>

			<page>19 <lb/></page>

			<body>alternative formulations do not. Under this updating rule, we have <lb/>D j = <lb/>1 <lb/>N <lb/>, and B i j = <lb/>1 <lb/>N <lb/>f j d j i <lb/>l f l d l i <lb/>. <lb/>(19) <lb/>Using matrix notation, eq. (12) becomes <lb/>E X ≈ p+δ <lb/>p(1 − p) <lb/>µ <lb/>b <lb/>1 <lb/>N <lb/>Tr (E • Q) − <lb/>1 <lb/>N ν 2 Tr E • D • D T • Q − c 1 − <lb/>1 <lb/>N ν 2 Tr D • D T • Q , <lb/>(20) <lb/>where T denotes transposition. We can again identify direct and indirect effects <lb/>of benefits and costs; the direct effects are the same as for the Birth-Death up-<lb/>dating rule, but the indirect effects differ, reflecting the fact that competitors are <lb/>now two dispersal steps away (Grafen &amp; Archetti, 2008; Débarre et al., 2014). Un-<lb/>der a Death-Birth updating rule indeed, individuals j and k are competing for <lb/>a site i whose occupant has just been chosen to die if both j and k can send <lb/>their offspring to i ; this depends on d j i d ki , leading to the D • D T products in <lb/>eq. (20). Again, we can also note that 1 − 1 <lb/>N ν 2 Tr D • D T • Q ≥ 0, i.e., that the costs <lb/>are indeed costly. <lb/>Probabilities of identity by descent With the Death-Birth model as de-<lb/>fined above, the system of equations for the probabilities of identity by descent <lb/>at neutrality is the same as in eq. (16). <lb/></body>

			<page>20 <lb/></page>

			<body>Transitive undirected graphs When the graph is transitive and undirected, <lb/>eq. (17) still holds and eq. (20) simplifies into <lb/>E X ≈ p + δ <lb/>p(1 − p) <lb/>µ <lb/>b <lb/>−µ (2 − µ) <lb/>(1 − µ) 2 <lb/>Tr (E • Q) <lb/>N <lb/>+ <lb/>λ M <lb/>1 − µ <lb/>Tr (E • D) <lb/>N ν <lb/>+ <lb/>λ M <lb/>(1 − µ) 2 <lb/>Tr (E) <lb/>N <lb/>− c <lb/>−µ (2 − µ) <lb/>(1 − µ) 2 + <lb/>λ M <lb/>1 − µ <lb/>Tr (D) <lb/>N ν <lb/>+ <lb/>λ M <lb/>(1 − µ) 2 . <lb/>(21) <lb/>Wright-Fisher <lb/>Under a Wright-Fisher model, generations are non-overlapping: all adults pro-<lb/>duce offspring, then all adults die and the offspring disperse and compete for <lb/>establishment, so that <lb/>D j = 1, and B i j = <lb/>f j d j i <lb/>l f l d l i <lb/>. <lb/>(22) <lb/>In a Wright-Fisher model, at neutrality, B * = 1 (the entire population is renewed <lb/>at each generation; in a Moran model we had B * = 1/N ); eq. (22) differing from <lb/>its Moran Death-Birth equivalent (eq. (19)) by only a factor 1/N , we end up with <lb/>the same equation as eq. (20) for the expected frequency of type-A individuals <lb/>in the population. The difference between the Moran Death-Birth and Wright-<lb/>Fisher life-cycles however lies in the evaluation of probabilities of identity by <lb/>descent. <lb/>Probabilities of identity by descent Under a Wright-Fisher model, the en-<lb/>tire population is replaced, so the equation is different from the one obtained <lb/>under a Moran model; probabilities of identity by descent of two different indi-<lb/></body>

			<page>21 <lb/></page>

			<body>viduals satisfy (i = j ) <lb/>Q i j = (1 − µ) 2 <lb/>k,l <lb/>d ki <lb/>ν <lb/>d l j <lb/>ν <lb/>Q kl . <lb/>(23) <lb/>(see Appendix B.3 for details of the derivation.) <lb/>Undirected transitive graphs When the dispersal graph is undirected (D = <lb/>D T ) and transitive, the probabilities of identity by descent verify <lb/>Q = λ W F I N − <lb/>(1 − µ) 2 <lb/>ν 2 DD <lb/>−1 <lb/>, <lb/>(24) <lb/>with λ W F such that for all i , Q i i = 1, and the W F index stands for &quot;Wright-Fisher&quot;. <lb/>With this, the expected frequency of type-A individuals becomes <lb/>E X ≈ p + δ <lb/>p(1 − p) <lb/>µ <lb/>b <lb/>−µ (2 − µ) <lb/>(1 − µ) 2 <lb/>Tr (E • Q) <lb/>N <lb/>+ <lb/>λ W F <lb/>(1 − µ) 2 <lb/>Tr (E) <lb/>N <lb/>− c <lb/>−µ (2 − µ) <lb/>(1 − µ) 2 + <lb/>λ W F <lb/>(1 − µ) 2 . <lb/>(25) <lb/>We can immediately see the difference with the Moran Death-Birth case (eq. (21)), <lb/>caused by a different equation for the probabilities of identity by descent Q. Cru-<lb/>cially missing in eq. (25) is the positive term λ M <lb/>1−µ <lb/>Tr(E•D) <lb/>N ν : without it, the factor as-<lb/>sociated to the benefits b is negative unless interactions with oneself (Tr (E)) are <lb/>strong enough, as was the case with the Moran Birth-Death updating. <lb/>As for the Moran model, evaluating probabilities of identity by descent in <lb/>undirected transitive graphs (eq. (24)) involves the computation of the inverse <lb/>of a N by N matrix. More explicit results can be obtained for &quot;n-dimensional <lb/>graphs&quot;; they are presented in Appendix B.3. <lb/></body>

			<page>22 <lb/></page>

			<body>Specific population structures <lb/>All numerical examples given in this section are derived with b &gt; 0 and c &gt; 0, so <lb/>type-A individuals can be called altruists. <lb/>As an illustration, we explore the impact of mutation on the expected pro-<lb/>portion of type-A individuals in graph-structured populations, in which the same <lb/>graph defines dispersal and interactions among individuals (Lieberman et al., <lb/>2005; Hindersin &amp; Traulsen, 2015; McAvoy &amp; Hauert, 2015), so that E = D. <lb/>Undirected transitive graphs When the graph undirected and transitive, the <lb/>equations for the expected frequency of altruists (type-A individuals) can be fur-<lb/>ther simplified as follows: <lb/>Moran, Birth-Death <lb/>E X ≈ p + δ <lb/>p(1 − p) <lb/>µ <lb/>b <lb/>−µ ν <lb/>(1 − µ) 2 (1 − λ M ) + <lb/>λ M <lb/>1 − µ <lb/>d 11 − c <lb/>λ M − µ <lb/>1 − µ <lb/>. <lb/>(26) <lb/>Moran, Death-Birth <lb/>E X ≈ p + δ <lb/>p(1 − p) <lb/>µ <lb/>b <lb/>−µ (2 − µ) ν <lb/>(1 − µ) 3 (1 − λ M ) + <lb/>λ M <lb/>1 − µ <lb/>k d 2 <lb/>1k <lb/>ν <lb/>+ <lb/>λ M <lb/>(1 − µ) 2 d 11 <lb/>− c <lb/>−µ (2 − µ) + λ M <lb/>(1 − µ) 2 <lb/>+ <lb/>λ M <lb/>(1 − µ) <lb/>d 11 <lb/>ν <lb/>. <lb/>(27) <lb/>In both cases, λ M is obtained from eq. (17). Under a Wright-Fisher updating, <lb/>eq. (25) cannot be much further simplified. <lb/></body>

			<page>23 <lb/></page>

			<body>Small graphs <lb/>For regular graphs of small size, the probabilities of identity by descent can be <lb/>calculated directly using eq. (16) (Moran model) or eq. (23) (Wright-Fisher). In <lb/>figure 2, we show the value of E X on three regular graphs that have the same <lb/>size (N = 12) and the same degree (ν = 3), and we consider three common life-<lb/>cycles in populations of fixed size (Moran Death-Birth, Moran Birth-Death, Wright-<lb/>Fisher). We compare the prediction based on eq. (9) (curves) to the outputs of <lb/>stochastic simulations (points). For all life-cycles, increasing the mutation prob-<lb/>ability µ makes E X closer to its value at the mutation-drift equilibrium (p). The <lb/>curves corresponding to different structures are almost undistinguishable under <lb/>a Moran model (figures 2(a) and (b))-the curve corresponding to the graph with <lb/>no symmetry (red, squares) being a bit less similar though). In the Wright-Fisher <lb/>model (figure 2(c)) however, the effects of the three structures are clearly differ-<lb/>ent, even when µ becomes very small: knowing only the size (N ) and degree (ν) <lb/>of a regular graph is not enough in this case to precisely predict the expected <lb/>frequency of altruists in the population. <lb/>Large graphs: variations on a circle <lb/>When the number of nodes gets larger, we have to concentrate on graphs with <lb/>a high level of symmetry. Here we will consider 1-dimensional graphs (graphs <lb/>whose nodes can be relabelled to satisfy eq. (2)) that are undirected, and hence <lb/>that can be categorised as undirected transitive graphs. For simplicity, we can <lb/>consider a circle graph, such that the nodes are arranged on a circle, and each <lb/>node is connected to its two neighbors only. Here, we assume that the num-<lb/></body>

			<page>24 <lb/></page>

			<body>Population structures <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>(a) Death-Birth <lb/>Mutation (µ) <lb/>E[X] <lb/>0.00 <lb/>0.10 <lb/>0.20 <lb/>0.46 <lb/>0.47 <lb/>0.48 <lb/>0.49 <lb/>0.50 <lb/>0.51 <lb/>0.52 <lb/>• • • <lb/>• <lb/>• <lb/>• <lb/>(b) Birth-Death <lb/>Mutation (µ) <lb/>E[X] <lb/>0.00 <lb/>0.10 <lb/>0.20 <lb/>0.46 <lb/>0.47 <lb/>0.48 <lb/>0.49 <lb/>0.50 <lb/>0.51 <lb/>0.52 <lb/>• <lb/>• <lb/>• <lb/>• <lb/>• <lb/>• <lb/>(c) Wright-Fisher <lb/>Mutation (µ) <lb/>E[X] <lb/>0.00 <lb/>0.10 <lb/>0.20 <lb/>0.46 <lb/>0.47 <lb/>0.48 <lb/>0.49 <lb/>0.50 <lb/>0.51 <lb/>0.52 <lb/>• <lb/>• <lb/>• <lb/>• <lb/>• <lb/>• <lb/>Figure 2: Expected frequency of type-A individuals E X , depending on popu-<lb/>lation structure (legend on the first line), updating rule ((a): Moran Death-Birth, <lb/>(b): Moran Birth-Death, (c): Wright-Fisher), and mutation probability µ (horizontal <lb/>axis): Comparison between the theoretical prediction (curves) and the outcomes <lb/>of numerical simulations (points). The horizontal dotted gray line corresponds to <lb/>p, the expected frequency of type-A individuals when there is no selection (i.e., <lb/>when δ = 0). Other parameters: δ=0.005, p = 1/2. <lb/>ber of nodes is infinite: N → ∞. As previously, a given node hosts exactly one <lb/>individual (see figure 3(a)). <lb/>Under a Moran model, using eq. (B.12b), we find for µ &gt; 0 <lb/>λ M = µ(2 − µ), <lb/>(28a) <lb/>and, although the quantity is not needed to compute E X under a Moran model, <lb/>the probability of identity by descent between two neighbors on the circle is <lb/></body>

			<page>25 <lb/></page>

			<body>given by <lb/>Q M = <lb/>1 − (2 − µ)µ <lb/>1 − µ <lb/>, <lb/>(28b) <lb/>and we recover the formula presented in, e.g., Allen et al. (2012) (see Appendix B.2.4 <lb/>for details). This result is plotted in figure 3(c). We however need to note that the <lb/>first-order approximation for E X fails when both µ → 0 and N → ∞: this is <lb/>because the integral behind eq. (28a) does not converge when µ → 0. Similarly, <lb/>for instance, the first order approximation for the probability that two neighbors <lb/>are identical by descent 1−µ(N −1), which was obtained by Taylor et al. (2007a), <lb/>fails when N is too large compared to µ. <lb/>The circle graph is too particular a graph for a Wright-Fisher updating. In-<lb/>deed, while we find the same equation for λ W F as for λ M in this case (eq. (28a)), <lb/>the probability of identity by descent between neighbors is equal to 0. This is <lb/>because all individuals reproduce at each time step, and their offspring can only <lb/>establish on the node on the left or on the right of their parent, so that related-<lb/>ness cannot build up. We can however modify the graph to allow for establish-<lb/>ment in the parent&apos;s node: with probability (1 − m) the offspring remain where <lb/>the parent was, otherwise they move to the right or the left-hand side node (with <lb/>probability m/2 for each; see figure 32(b)). In this case, we find the following <lb/>probability of identity by descent between neighbors: <lb/>Q W F = <lb/>µ (2 − µ) + 2 (1 − µ) 2 m (1 − m) − µ (2 − µ) µ + 2 m (1 − µ) 2 − µ − 2 m (1 − µ) <lb/>2 (1 − µ) 2 m (1 − m) <lb/>. <lb/>(29) <lb/>(See Appendix B.3.4 for details.) The result is plotted in figure 3(d) for different <lb/>values of the emigration probability m. <lb/></body>

			<page>26 <lb/></page>

			<body>(a) Circle graph <lb/>(b) . . . with self-loops <lb/>1 − m <lb/>m <lb/>2 <lb/>m <lb/>2 <lb/>(c) Moran updating <lb/>Mutation (µ) <lb/>Pr. neighbors IBD (Q <lb/>M ) <lb/>0.0 <lb/>0.4 <lb/>0.8 <lb/>0.0 <lb/>0.2 <lb/>0.4 <lb/>0.6 <lb/>0.8 <lb/>1.0 <lb/>(d) Wright-Fisher updating <lb/>Mutation (µ) <lb/>Pr. neighbors IBD (Q <lb/>M ) <lb/>0.0 <lb/>0.4 <lb/>0.8 <lb/>0.0 <lb/>0.2 <lb/>0.4 <lb/>0.6 <lb/>0.8 <lb/>1.0 <lb/>0.5 <lb/>0.75 <lb/>0.9 <lb/>0.999 <lb/>m = <lb/>Figure 3: Circle graphs, without (a) or with self-loops ((b); the weight of the self-<lb/>loop is 1 − m), and Probability that two neighbors on the graph are identical by <lb/>descent, as function of the mutation probability µ, for the Moran updating on an <lb/>infinite circle graph (c), and for the Wright-Fisher updating on an infinite circle <lb/>graph with self loops (d). In (d), emigration probabilities m take values 0.5, 0.75, <lb/>0.9, 0.999 (increasingly lighted curves). <lb/>5 Discussion <lb/>While most studies on the evolution of cooperation assume an almost perfect fi-<lb/>delity of strategy transmission from parent to offspring, here, we explored the <lb/>effect of arbitrary mutation on the evolution of social behavior in structured <lb/>populations. We provide a formula (eq. (12)) that gives the expected frequency <lb/>of a given strategy, for any life-cycle, any mutation probability, and that is valid <lb/>in populations of fixed size that are such that the reproductive values of all sites <lb/>are equal (i.e., when all individuals have the same fecundity, they all have the <lb/></body>

			<page>27 <lb/></page>

			<body>same chance of actually reproducing). The formula depends on the probability <lb/>of identity by descent of pairs of individuals, and we show how to compute those <lb/>in general. <lb/>Identity by descent and expected state of pairs of sites <lb/>The effects of social interactions depend on the actual types of the individuals <lb/>who interact. With imperfect strategy transmission from parents to their off-<lb/>spring (µ &gt; 0), common ancestry does not guarantee that two individuals are <lb/>of the same type. The concept of identity by descent, as we use it in this arti-<lb/>cle, adds to common ancestry the condition that no mutation has occured in <lb/>the two individuals&apos; lineages since the common ancestor (Kimura &amp; Crow, 1964; <lb/>Taylor et al., 2007b), and hence garanties that the two individuals are of the same <lb/>type. Two individuals that are not IBD can be treated independently, and we can <lb/>hence relate the probability that the individuals at two sites i and j to their ex-<lb/>pected state (eq. (11) and Allen &amp; Nowak (2014)). Finally, equations with proba-<lb/>bilities of identity by descent are much simpler than those for the expected state <lb/>of pairs of sites. <lb/>A structure parameter κ <lb/>Tarnita et al. (2009) and Taylor &amp; Maciejewski (2012) showed that, when so-<lb/>cial interactions affect fecundities, there exists a parameter independent of the <lb/>terms of the interaction matrix that summarizes the effects of population struc-<lb/>ture (in terms of dispersal patterns and also of who interacts with whom) and <lb/>depends on the rule chosen to update the population and on mutation; here we <lb/>provide a generic formula for such a structure parameter. This parameter, κ, can <lb/></body>

			<page>28 <lb/></page>

			<body>be interpreted as a scaled relatedness (Queller, 1994; Lehmann &amp; Rousset, 2010), <lb/>which includes the effect of competition. Eq. (13) provides a generic formula for <lb/>κ, for any life-cycle and population structure (provided condition eq. (1) is sat-<lb/>isfied). <lb/>The actual value of the scaled relatedness κ depends on the life-cycle and <lb/>on the mutation probability µ. First, κ includes competition (what we call &quot;in-<lb/>direct effects&quot;), and the scale of competition depends on the life-cycle (Grafen <lb/>&amp; Archetti, 2008; Débarre et al., 2014). Second, even direct effects-and so even <lb/>what is referred to as relatedness-do depend on the life-cycle and µ. <lb/>Finally, there is a single structure parameter κ because social interactions <lb/>only affect fecundity. Previous studies assuming vanishing or absent mutation <lb/>have shown that the parameter will be different if social interactions instead <lb/>influence survival (Nakamaru &amp; Iwasa, 2006; Taylor, 2010) and that we need <lb/>more than one parameter if social interactions affect both fecundity and sur-<lb/>vival (Débarre et al., 2014). <lb/>Updating rules and the evolution of altruism <lb/>We illustrate our results with specific updating rules, with either exactly new in-<lb/>dividual at each time step (Moran Birth-Death, Moran Death-Birth), or exactly <lb/>N new individuals, i.e., the entire population being renewed at each time step <lb/>(Wright-Fisher). Previous studies done under the assumption of vanishing mu-<lb/>tation rates (and with undirected transitive dispersal graphs) found that updat-<lb/>ing rules had a great impact on the evolution of altruism, and in particular, that <lb/>selection did not favor altruism (benefits given to others exclusively) under a <lb/>Wright-Fisher or Moran Birth-Death updating (the &quot;cancellation result&quot;; Taylor, <lb/></body>

			<page>29 <lb/></page>

			<body>1992; Taylor et al., 2011; Ohtsuki et al., 2007; Lehmann et al., 2007); the result <lb/>holds with imperfect strategy transmission as well. This is because the compe-<lb/>tition radius (individuals one dispersal step away [D] with a Moran Birth-Death <lb/>updating, individuals two dispersal steps away [D.D] with a Wright-Fisher up-<lb/>dating) matches the radius on which identities by descent are computed (see <lb/>eq. (17) and eq. (24)). On the other hand, under a Death-Birth updating, com-<lb/>petition is against individuals two dispersal steps away, but identity by descent <lb/>is computed using individuals one dispersal step away: competition is &quot;diluted&quot;, <lb/>and altruism can be favored by selection. Again, note that the conclusions for <lb/>the Moran model depend on which trait is affected by the social behavior: al-<lb/>truism is favored under a Birth-Death updating if survival, instead of fecundity, <lb/>is affected by social behavior (Nakamaru &amp; Iwasa, 2006; Taylor, 2010; Débarre <lb/>et al., 2014). <lb/>Implications for adaptive dynamics <lb/>Our results are obtained by considering the changes that occur during one time <lb/>step from a given population state, chosen from the stationary distribution of <lb/>population states-hence the phrase &quot;long-term&quot;, which differs from the use <lb/>made by, for instance Van Cleve (2015), where it refers to a trait substitution <lb/>sequence. Yet, our results can also be used in that context. The adaptive dy-<lb/>namics framework describes evolution as a series of trait substitutions (Geritz <lb/>et al., 1997; Champagnat et al., 2006; Champagnat &amp; Lambert, 2007; Lehmann, <lb/>2012; Lehmann &amp; Rousset, 2014) and is based on the assumption that mutations <lb/>are rare and incremental; in a finite population, trait evolution proceeds along <lb/>a gradient of fixation probabilities. Computing those fixations probabilities can <lb/></body>

			<page>30 <lb/></page>

			<body>be challenging in spatially structured populations. <lb/>Yet, the existence of a single parameter (in this case, defined as σ = (κ − <lb/>1)/(κ + 1), Tarnita et al., 2009) to characterize population structure and update <lb/>rules led to the extension of the adaptive dynamics framework to populations <lb/>with arbitrary structure (Allen et al., 2013), the structure parameter however re-<lb/>maining unspecified in general. Our formula for κ (eq. (13)) is valid for arbitrary <lb/>mutation, so a fortiori for vanishing mutation probabilities, and can therefore be <lb/>used to explicitly study adaptive dynamics in structured populations (provided <lb/>the reproductive values of all sites are equal). <lb/></body>

			<div type="availability">Data accessibility <lb/>All codes are provided as a zipped folder, and can be downloaded from https:// <lb/>figshare.com/articles/Mutation_and_social_evolution/3207748. They will <lb/>be uploaded on Dryad when the manuscript is accepted. <lb/></div>

			<div type="annex">Competing interests <lb/>I have no competing interests. <lb/></div>

			<page>31 <lb/></page>

			<div type="acknowledgement">Acknowledgements <lb/>I thank Sally Otto and François Bienvenu for comments on the manuscript and <lb/>Ben Allen for clarifications. The simulations were run on the Migale cluster <lb/>(http://migale.jouy.inra.fr/). <lb/></div>

			<div type="annex">Funding <lb/>We thank the Agence Nationale de la Recherche for funding (grant ANR-14-ACHN-<lb/>0003-01). <lb/></div>

			<listBibl>References <lb/>Allen, B. &amp; Nowak, M. A. 2014: Games on graphs. EMS surveys in mathematical <lb/>sciences 1(1):113-151. <lb/>Allen, B.; Nowak, M. A. &amp; Dieckmann, U. 2013: Adaptive dynamics with interac-<lb/>tion structure. The American Naturalist 181(6):E139-E163. <lb/>Allen, B.; Sample, C.; Dementieva, Y.; Medeiros, R. C.; Paoletti, C. &amp; Nowak, M. A. <lb/>2015: The molecular clock of neutral evolution can be accelerated or slowed <lb/>by asymmetric spatial structure. PLoS Comput Biol 11(2):1-32. <lb/>Allen, B.; Traulsen, A.; Tarnita, C. E. &amp; Nowak, M. A. 2012: How mutation affects <lb/>evolutionary games on graphs. Journal of Theoretical Biology 299:97 -105. <lb/>Evolution of Cooperation. <lb/>Caswell, H. 2001: Matrix population models. Wiley Online Library. <lb/>Champagnat, N.; Ferrière, R. &amp; Méléard, S. 2006: Unifying evolutionary dynam-<lb/>ics: from individual stochastic processes to macroscopic models. Theoretical <lb/>population biology 69(3):297-321. <lb/>Champagnat, N. &amp; Lambert, A. 2007: Evolution of discrete populations and the <lb/>canonical diffusion of adaptive dynamics. The Annals of Applied Probability <lb/>17(1):102-155. <lb/></listBibl>

			<page>32 <lb/></page>

			<listBibl>Cockerham, C. C. &amp; Weir, B. S. 1993: Estimation of gene flow from F-statistics. <lb/>Evolution 47(3):855-863. <lb/>Débarre, F.; Hauert, C. &amp; Doebeli, M. 2014: Social evolution in structured popu-<lb/>lations. Nature Communications 5. <lb/>Frank, S. A. 1997: The price equation, fisher&apos;s fundamental theorem, kin selec-<lb/>tion, and causal analysis. Evolution 51(6):1712-1729. <lb/>Gandon, S. &amp; Rousset, F. 1999: Evolution of stepping-stone dispersal <lb/>rates. Proceedings of the Royal Society of London B: Biological Sciences <lb/>266(1437):2507-2513. <lb/>Geritz, S.; Kisdi, E.; Meszena, G. &amp; Metz, J. 1997: Evolutionarily singular strate-<lb/>gies and the adaptive growth and branching of the evolutionary tree. Evolu-<lb/>tionary Ecology 12(1):35-57. <lb/>Grafen, A. &amp; Archetti, M. 2008: Natural selection of altruism in inelastic viscous <lb/>homogeneous populations. Journal of Theoretical Biology 252(4):694 -710. <lb/>Hindersin, L. &amp; Traulsen, A. 2015: Most undirected random graphs are amplifiers <lb/>of selection for birth-death dynamics, but suppressors of selection for death-<lb/>birth dynamics. PLoS Comput Biol 11(11):1-14. <lb/>Kimura, M. &amp; Crow, J. F. 1964: The number of alleles that can be maintained in a <lb/>finite population. Genetics 49(4):725-738. <lb/>Lehmann, L. 2012: The stationary distribution of a continuously varying strat-<lb/>egy in a class-structured population under mutation-selection-drift balance. <lb/>Journal of Evolutionary Biology 25(4):770-787. <lb/>Lehmann, L.; Keller, L. &amp; Sumpter, D. J. T. 2007: The evolution of helping and <lb/>harming on graphs: the return of the inclusive fitness effect. Journal of Evolu-<lb/>tionary Biology 20(6):2284-2295. <lb/>Lehmann, L. &amp; Rousset, F. 2010: How life history and demography promote or <lb/>inhibit the evolution of helping behaviours. Philosophical Transactions of the <lb/>Royal Society B: Biological Sciences 365(1553):2599-2617. <lb/>Lehmann, L. &amp; Rousset, F. 2014: The genetical theory of social behaviour. Philo-<lb/>sophical Transactions of the Royal Society of London B: Biological Sciences <lb/>369(1642). <lb/>Lieberman, E.; Hauert, C. &amp; Nowak, M. A. 2005: Evolutionary dynamics on <lb/>graphs. Nature 433(7023):312-316. <lb/></listBibl>

			<page>33 <lb/></page>

			<listBibl>Maciejewski, W. 2014: Reproductive value in graph-structured populations. <lb/>Journal of Theoretical Biology 340:285 -293. <lb/>Malécot, G. 1975: Heterozygosity and relationship in regularly subdivided pop-<lb/>ulations. Theoretical Population Biology 8(2):212 -241. <lb/>McAvoy, A. &amp; Hauert, C. 2015: Structural symmetry in evolutionary games. Jour-<lb/>nal of The Royal Society Interface 12(111). <lb/>Moran, P. 1962: The statistical processes of evolutionary theory. Clarendon <lb/>Press; Oxford University Press. <lb/>Nakamaru, M. &amp; Iwasa, Y. 2006: The coevolution of altruism and punishment: <lb/>Role of the selfish punisher. Journal of Theoretical Biology 240(3):475 -488. <lb/>Nowak, M.; Sasaki, A.; Taylor, C. &amp; Fudenberg, D. 2004: Emergence of cooper-<lb/>ation and evolutionary stability in finite populations. Nature 428(6983):646-<lb/>650. <lb/>Nowak, M. A. 2006: Five rules for the evolution of cooperation. Science <lb/>314(5805):1560-1563. <lb/>Nowak, M. A.; Tarnita, C. E. &amp; Wilson, E. O. 2010: The evolution of eusociality. <lb/>Nature 466(7310):1057-1062. <lb/>Ohtsuki, H.; Hauert, C.; Lieberman, E. &amp; Nowak, M. A. 2006: A simple rule <lb/>for the evolution of cooperation on graphs and social networks. Nature <lb/>441(7092):502-505. <lb/>Ohtsuki, H. &amp; Nowak, M. A. 2006: The replicator equation on graphs. Journal of <lb/>Theoretical Biology 243(1):86 -97. <lb/>Ohtsuki, H.; Nowak, M. A. &amp; Pacheco, J. M. 2007: Breaking the symmetry <lb/>between interaction and replacement in evolutionary dynamics on graphs. <lb/>Phys. Rev. Lett. 98:108106. <lb/>Queller, D. C. 1994: Genetic relatedness in viscous populations. Evolutionary <lb/>Ecology 8:70-73. 10.1007/BF01237667. <lb/>Rousset, F. 2004: Genetic Structure and Selection in Subdivided Populations. <lb/>Princeton University Press, Princeton, NJ. <lb/>Rousset, F.; Billiard, S. et al. 2000: A theoretical basis for measures of kin selection <lb/>in subdivided populations: finite populations and localized dispersal. Journal <lb/>of Evolutionary Biology 13(5):814-825. <lb/></listBibl>

			<page>34 <lb/></page>

			<listBibl>Slatkin, M. 1991: Inbreeding coefficients and coalescence times. Genetical re-<lb/>search 58(02):167-175. <lb/>Slatkin, M. 1993: Isolation by distance in equilibrium and non-equilibrium pop-<lb/>ulations. Evolution 47(1):264-279. <lb/>Tarnita, C. E.; Ohtsuki, H.; Antal, T.; Fu, F. &amp; Nowak, M. A. 2009: Strategy selection <lb/>in structured populations. Journal of Theoretical Biology 259(3):570 -581. <lb/>Tarnita, C. E. &amp; Taylor, P. D. 2014: Measures of relative fitness of social behaviors <lb/>in finite structured population models. The American Naturalist 184(4):477-<lb/>488. <lb/>Taylor, P. 2010: Birth-death symmetry in the evolution of a social trait. Journal <lb/>of Evolutionary Biology 23(12):2569-2578. <lb/>Taylor, P.; Lillicrap, T. &amp; Cownden, D. 2011: Inclusive fitness analysis on mathe-<lb/>matical groups. Evolution 65(3):849-859. <lb/>Taylor, P. &amp; Maciejewski, W. 2012: An inclusive fitness analysis of synergistic in-<lb/>teractions in structured populations. Proceedings of the Royal Society B: Bio-<lb/>logical Sciences . <lb/>Taylor, P. D. 1990: Allele-frequency change in a class-structured population. The <lb/>American Naturalist 135(1):pp. 95-106. <lb/>Taylor, P. D. 1992: Inclusive fitness in a homogeneous environment. Proceedings <lb/>of the Royal Society of London. Series B: Biological Sciences 249(1326):299-<lb/>302. <lb/>Taylor, P. D.; Day, T. &amp; Wild, G. 2007a: Evolution of cooperation in a finite homo-<lb/>geneous graph. Nature 447(7143):469-472. <lb/>Taylor, P. D.; Day, T. &amp; Wild, G. 2007b: From inclusive fitness to fixation proba-<lb/>bility in homogeneous structured populations. Journal of Theoretical Biology <lb/>249(1):101 -110. <lb/>Van Cleve, J. 2015: Social evolution and genetic interactions in the short and <lb/>long term. Theoretical Population Biology 103:2 -26. <lb/>Wakano, J. Y. &amp; Lehmann, L. 2014: Evolutionary branching in deme-structured <lb/>populations. Journal of theoretical biology 351:83-95. <lb/></listBibl>

			<page>35 <lb/></page>

			<listBibl>Wild, G. &amp; Traulsen, A. 2007: The different limits of weak selection and the <lb/>evolutionary dynamics of finite populations. Journal of Theoretical Biology <lb/>247(2):382 -390. <lb/>Wolfram Research, Inc. 2015: Mathematica Edition: Version 10.1. Wolfram Re-<lb/>search, Inc., Champaign, Illinois. <lb/></listBibl>

			<page>36 <lb/></page>

			<note place="headnote">Appendix A <lb/></note>

			<div type="annex">A Expected frequency of type-A individuals <lb/>Conditional expectations <lb/>We denote by E X i (t + 1)|X (t ) the expected state of the individual at site i at <lb/>time t + 1, given that the population is in state X at time t . Because X i is an <lb/>indicator variable, E X i (t + 1)|X (t ) = P [X i (t + 1) = 1|X (t )]. Site i is occupied by <lb/>an individual of type A at time t + 1 if: i) it was occupied by an individual of type <lb/>A at time t and this individual has not been replaced (i.e., has not died) between <lb/>t and t + 1 (first term in eq. (A.1)), or ii) the individual has been replaced by a <lb/>new one, whose parent was in site j at t ; in this case, either the parent was of <lb/>type A and the offspring is not a mutant; or, whichever the type of the parent, <lb/>the offspring is a mutant and mutated into type A (second term of eq. (A.1)): <lb/>E X i (t + 1)|X (t ) = (1 − D i )X i + <lb/>j <lb/>B i j X j (1 − µ) + µp . <lb/>(A.1) <lb/>Unconditional expectations <lb/>We now want to consider the long-term outcome of competition. We denote by <lb/>ξ(X , δ, µ) the probability that the population is in state X , given phenotype dif-<lb/>ference δ between the two types and a mutation rate µ, and by Ω the ensemble <lb/>of all possible population states. By definition, the expectation of the state of the <lb/>population is given by E X = X ∈Ω X ξ(X , δ, µ). <lb/>When the stationary distribution is reached (i.e., for very large t ), E X (t + <lb/>1) = E X (t ) = E X ; we consider the population average of X , X = i X i /N . <lb/></div>

			<page>37 <lb/></page>

			<note place="headnote">Appendix A <lb/></note>

			<div type="annex">From eq. (A.1), we obtain <lb/>E X = <lb/>X ∈Ω <lb/>N <lb/>i =1 <lb/>1 <lb/>N <lb/>N <lb/>j =1 <lb/>B i j X j − D i X i − µ <lb/>N <lb/>j =1 <lb/>B i j (X j − p) + X i ξ(X , δ, µ), <lb/>which, after simplifications , becomes <lb/>X ∈Ω <lb/>1 <lb/>N <lb/>N <lb/>j =1 i <lb/>B i j − D j X j − µ <lb/>i j <lb/>B i j (X j − p) ξ(X , δ, µ) = 0. <lb/>(A.2) <lb/>Weak selection approximation While eq. (A.2) is valid for any µ and δ, we now <lb/>assume that δ, which scales the phenotype difference, is small, so that we can <lb/>neglects terms of order δ 2 and higher. We note that in the absence of selection <lb/>(i.e., when the expressed phenotypes are identical, δ = 0), the expected state of <lb/>a site j when the stationary distribution is reached is equal to the probability <lb/>that a mutated offspring is of type A (i.e., X ∈Ω X j ξ(X , 0, µ) = p; see section A.3 <lb/>below for more details). Using eq. (6) and the compact notation ∂ δ to represent <lb/>∂ <lb/>∂δ δ=0 <lb/>, a first-order expansion of eq. (A.2) yields, after simplifications: <lb/>0 = <lb/>δ <lb/>N X ∈Ω j i <lb/>∂ δ B i j − ∂ δ D j X j − µ <lb/>i j <lb/>∂ δ B i j (X j − p) ξ(X , 0, µ) <lb/>− <lb/>δµ <lb/>N X ∈Ω j <lb/>B * (X j − p) ∂ δ ξ(X , δ, µ) + O(δ 2 ). <lb/>(A.3a) <lb/></div>

			<page>38 <lb/></page>

			<note place="headnote">Appendix A <lb/></note>

			<div type="annex">Because ξ is a probability distribution, X ∈Ω ∂ δ ξ(X , δ, µ) = 0; reorganizing eq. (A.3a), <lb/>we obtain <lb/>∂ δ E X = <lb/>1 <lb/>µ N B * <lb/>X ∈Ω <lb/>j <lb/>i <lb/>∂ δ B i j − ∂ δ D j X j ξ(X , 0, µ) <lb/>− <lb/>X ∈Ω <lb/>µ <lb/>i , j <lb/>∂ δ B i j (X j − p) ξ(X , 0, µ) + O <lb/>δ <lb/>µB * . <lb/>(A.3b) <lb/>We can now use the chain rule: <lb/>∂ δ B i j = <lb/>N <lb/>k=0 <lb/>∂B i j <lb/>∂ f k δ=0 <lb/>∂ δ f k , <lb/>(A.4a) <lb/>∂ δ D j = <lb/>N <lb/>k=0 <lb/>∂D j <lb/>∂ f k δ=0 <lb/>∂ δ f k , <lb/>(A.4b) <lb/>where the ∂ δ f k terms are computed using the definition of f presented in eq. (3b). <lb/>We also denote by P j k the expected state of a pair of sites ( j , k) evaluated when <lb/>there are no social interactions (δ = 0): <lb/>P j k = <lb/>X ∈Ω <lb/>X j X k ξ(X , 0, µ). <lb/>(A.5) <lb/>Doing so, we realize that we can write eq. (A.3b) as <lb/>∂ δ E X = <lb/>1 <lb/>µN B * βb − γc + O <lb/>δ <lb/>µB * , <lb/>(A.6) <lb/>with β and γ as defined in eq. (10). <lb/>Plugging eq. (A.6) in the following equation <lb/>E X = p + δ ∂ δ E X + O(δ 2 ), <lb/>(A.7) <lb/></div>

			<page>39 <lb/></page>

			<note place="headnote">Appendix A <lb/></note>

			<div type="annex">we recover eq. (9). <lb/>In the absence of selection (δ = 0) <lb/>In the absence of selection, neither D i nor B i j depend on the state of the popula-<lb/>tion, because all individuals now have the same fecundity. Consequently, when <lb/>δ = 0, and given that neutral reproductive values are all equal (eq. (6) in the main <lb/>text),eq. (A.1) becomes <lb/>E X i (t + 1)|X (t ) = (1 − B * )X i + <lb/>j <lb/>B 0 <lb/>i j X j (1 − µ) + µpB * . <lb/>(A.8) <lb/>We now take the expectation of eq. (A.8) over the neutral distribution of states <lb/>(ξ(X , 0, µ)); since B 0 <lb/>i j does not depend on X , we have <lb/>E 0 X i = (1 − B * )E 0 X i + <lb/>j <lb/>B 0 <lb/>i j E 0 X j (1 − µ) + µpB * , <lb/>(A.9a) <lb/>and we obtain after simplifying <lb/>E 0 X i = p. <lb/>(A.9b) <lb/>Weak mutation <lb/>When µ = 0, there is no stationary distribution of states, because the states X = 0 <lb/>and X = 1 (loss of type-A and loss of type-B individuals, respectively) are ab-<lb/>sorbing. We can nevertheless extend ξ by continuity at µ = 0, so that ξ(X , δ, 0) = <lb/>lim µ→0 ξ(X , δ, µ). Then, it does not matter whether we Taylor-expand ξ first in δ <lb/>then in µ or first in µ and then in δ, and so we can consider µ <lb/>δ and δ <lb/>µ <lb/></div>

			<page>40 <lb/></page>

			<note place="headnote">Appendix A <lb/></note>

			<div type="annex">(Tarnita &amp; Taylor, 2014). <lb/>Weak selection then weak mutation Starting from eq. (A.3a), a first order ex-<lb/>pansion near µ = 0 yields <lb/>0 = <lb/>1 <lb/>N X ∈Ω j i <lb/>∂ δ B i j − ∂ δ D j X j ∂ µ ξ(X , 0, µ) − <lb/>1 <lb/>N X ∈Ω i , j <lb/>∂ δ B i j (X j − p)ξ(X , 0, 0) <lb/>− <lb/>1 <lb/>N X ∈Ω j <lb/>B * (X j − p)∂ δ ξ(X , δ, 0) + O <lb/>δ <lb/>µ <lb/>+ O(µ). <lb/>(A.10) <lb/>Here we have δ µ 1. Notation ∂ µ stands for ∂ <lb/>∂µ µ=0 <lb/>. <lb/>Weak mutation then weak selection Starting from eq. (A.2), a first order ex-<lb/>pansion near µ = 0 and then a first order expansion near δ = 0 yields <lb/>0 = <lb/>1 <lb/>N X ∈Ω j i <lb/>∂ δ B i j − ∂ δ D j X j ∂ µ ξ(X , 0, µ) − <lb/>1 <lb/>N X ∈Ω i , j <lb/>∂ δ B i j (X j − p)ξ(X , 0, 0) <lb/>− <lb/>1 <lb/>N X ∈Ω j <lb/>B * (X j − p)∂ δ ξ(X , δ, 0) + O <lb/>µ <lb/>δ <lb/>+ O(δ). <lb/>(A.11) <lb/>Here we have µ δ 1. <lb/>At the first orders, eq. (A.10) and eq. (A.11) are the same. <lb/>When µ → 0, the population is either in state X = 0 or in state X = 1, so <lb/>ξ(1, δ, 0) = 1 − ξ(0, δ, 0) = lim <lb/>µ→0 <lb/>E X , <lb/>(A.12a) <lb/></div>

			<page>41 <lb/></page>

			<note place="headnote">Appendix A <lb/></note>

			<div type="annex">and as a result <lb/>∂ δ ξ(1, δ, 0) = −∂ δ ξ(0, δ, 0) . <lb/>(A.12b) <lb/>In addition, when δ = 0, <lb/>ξ(1, 0, µ) = p. <lb/>(A.12c) <lb/>So at the first orders, reorganizing eq. (A.10) (or equivalently eq. (A.11)), we ob-<lb/>tain the following equation for the derivative with respect to δ of the expected <lb/>state of the population when µ → 0 (Tarnita &amp; Taylor, 2014): <lb/>∂ δ ξ(1, δ, 0) ≈ <lb/>1 <lb/>B * <lb/>1 <lb/>N X ∈Ω j i <lb/>∂ δ B i j − ∂ δ D j X j ∂ µ ξ(X , 0, µ) <lb/>− <lb/>1 <lb/>N <lb/>p(1 − p) <lb/>i , j <lb/>∂ δ B i j (1) − ∂ δ B i j (0) . <lb/>(A.13) <lb/></div>

			<page>42 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">B Probabilities of identity by descent <lb/>We first start by showing the link between the expected state of a pair of sites <lb/>(P i j ) and probabilities of identity by descent (Q i j ), for any life-cycle. <lb/>Any life-cycle <lb/>Notation <lb/>To be able to consider any life-cycle, we use notation similar to what is used in <lb/>Allen et al. (2015). At each time step, from 1 to N individuals are replaced, de-<lb/>pending on the updating rule; R denotes the set of individuals that are replaced <lb/>(i.e., the sites where an individual is replaced by another one). For each site i <lb/>where a replacement happened (i ∈ R), α(i ) gives the index of the site where the <lb/>parent of the new individual lived, while for individuals that were not replaced, <lb/>∀i ∈ {1, . . . , N }\R, α(i ) = i 1 . Finally, ρ(R, α) denotes the probability of the replace-<lb/>ment event (R, α). In the absence of selection, this probability does not depend <lb/>on the current state of the population. <lb/>Expected state of a pair of sites <lb/>Considering two different sites i and j , depending on the updating rule, at each <lb/>time step, i) either none of the individuals are replaced-then they are both of <lb/>type A if they already were [first term in eq. (B.1)], ii) either one of the individ-<lb/>uals (i or j ) is replaced-then they are both of type A if the surviving individual <lb/>is A and if either the parent of the other individual was of type A and no mu-<lb/></div>

			<note place="footnote">1 Here we extend the notation used in Allen et al. (2015), because in their study, α : R → {1, . . . , N } <lb/></note>

			<page>43 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">tation occurred, or the offspring mutated into type A whichever the type of its <lb/>parent [second and third terms in eq. (B.1)]), or finally iii) both individuals are <lb/>replaced-then the probability that both offspring are of type A is P α(i )α( j ) (1−µ+ <lb/>µp) 2 + 2(p − P α(i )α( j ) )(1 − µ + µp)(µp) + (1 − 2p + P α(i )α( j ) )(µp) 2 , which simplifies <lb/>into the fourth term in eq. (B.1)). We obtain the following equation: <lb/>∀(i , j ) ∈ {1, . . . , N } 2 , i = j , <lb/>P i j = <lb/>R,α <lb/>i ∉R, j ∉R <lb/>q(R, α) P α(i )α( j ) <lb/>+ <lb/>R,α <lb/>i ∉R, j ∈R <lb/>q(R, α) P α(i )α( j ) (1 − µ) + pµp <lb/>+ <lb/>R,α <lb/>i ∈R, j ∉R <lb/>q(R, α) P α(i )α( j ) (1 − µ) + pµp <lb/>+ <lb/>R,α <lb/>i ∈R, j ∈R <lb/>q(R, α) P α(i )α( j ) (1 − µ) 2 + (2 − µ)µp 2 . <lb/>(B.1) <lb/>Identity by descent <lb/>Considering two different sites i and j , depending on the updating rule, at each <lb/>time step, i) either none of the individuals are replaced-then they are identical <lb/>by descent (IBD) if they already were [first term in eq. (B.1)], ii) either one of the <lb/>individuals (i or j ) is replaced-then they are both IBD if the surviving individ-<lb/>ual and the parent of the new individual were and no mutation occurred [second <lb/>and third terms in eq. (B.1)]), or finally iii) both individuals are replaced-then <lb/>then are IBD if their two parents were and no mutation occurred in either [fourth <lb/></div>

			<page>44 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<body>term in eq. (B.1)]. We obtain the following equation: <lb/>∀(i , j ) ∈ {1, . . . , N } 2 , i = j , <lb/>Q i j = <lb/>R,α <lb/>i ∉R, j ∉R <lb/>ρ(R, α)Q α(i )α( j ) + <lb/>R,α <lb/>i ∉R, j ∈R <lb/>ρ(R, α)Q α(i )α( j ) (1 − µ) <lb/>+ <lb/>R,α <lb/>i ∈R, j ∉R <lb/>ρ(R, α)Q α(i )α( j ) (1 − µ) + <lb/>R,α <lb/>i ∈R, j ∈R <lb/>ρ(R, α)Q α(i )α( j ) (1 − µ) 2 . <lb/>(B.2) <lb/>For all pairs i = j , eq. (B.1) and eq. (B.2) are equivalent when we set <lb/>Q i j = <lb/>P i j − p 2 <lb/>p(1 − p) <lb/>, <lb/>(B.3) <lb/>and eq. (B.3) is also valid when i = j (in this case Q i i = 1 and P i i = p). So we can <lb/>use the recursion on Q presented in eq. (B.2) together with eq. (B.3). <lb/>Finally, while Q i j is an expectation over the stationary distribution of pop-<lb/>ulation states, we also introduce the indicator variable q i j (t ), equal to 1 if, in a <lb/>realization of the process, the individuals at sites i and j are IBD at time t . We <lb/>also denote by Q the matrix gathering the Q i j terms. <lb/>Moran model <lb/>In a Moran model, exactly one individual died and one individual reproduces <lb/>during one time step. Given a state X at time t , for i = j , probabilities of identity <lb/>by descent verify <lb/>E q i j (t + 1)|X (t ) =q i j (t ) 1 − <lb/>2 <lb/>N <lb/>+ <lb/>1 − µ <lb/>N k <lb/>d k j q ki (t ) + d ki q k j (t ) <lb/>ν <lb/>. <lb/>(B.4) <lb/></body>

			<page>45 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">Taking the expectation of this quantity over the stationary distribution of states, <lb/>we obtain <lb/>Q i j = <lb/>1 − µ <lb/>2ν k <lb/>d k j Q ki + d ki Q k j <lb/>(i = j ), <lb/>(B.5) <lb/>and Q i j = 1 when i = j . Eq. (B.5) is valid for any regular graph; all the Q i j terms <lb/>can be found by solving a system of N (N − 1)/2 equations (since Q i j = Q j i ). We <lb/>can also write eq. (B.5) in matrix form: <lb/>Q = <lb/>1 − µ <lb/>2ν <lb/>(QD + D T Q) + L, <lb/>(B.6) <lb/>where D is the adjacency matrix of the dispersal graph (with elements d i j ), T <lb/>denotes transposition, and L is a diagonal matrix whose i th diagonal element is <lb/>1 − k d ki Q ki /ν (i.e., such that Q i i = 1). <lb/>Transitive undirected graphs <lb/>When the dispersal graph is transitive, then all the elements on the diagonal of <lb/>L are equal, so we can write L = λ M I N , where I N is the N by N identity matrix. <lb/>When the graph is also undirected, D = D T , and we also show by induction that <lb/>DQ = QD (Grafen &amp; Archetti, 2008). <lb/>Let us assume without loss of generality that initially (t = 0) all individuals are <lb/>IBD (q i j (0) = 1 N N , where 1 N N is the N -by-N matrix containing only ones) and <lb/>of type B (X (0) = {0, . . . , 0}). Also, let us denote by ζ 0 (X , t ) the probability that <lb/>the population is in state X at time t given that it was in state {0, . . . , 0} at time 0, <lb/>and by E t expectations with respect to that distribution, at time t . Then from <lb/></div>

			<page>46 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">eq. (B.4), since q i i = 1, and given that the graph is regular, <lb/>E 1 q = 1 − <lb/>2 <lb/>N <lb/>1 N N + 2 <lb/>1 − µ <lb/>N <lb/>1 N N + λ 1 I N , <lb/>(B.7) <lb/>so <lb/>D • E 1 q = 1 − <lb/>2 <lb/>N <lb/>ν1 N N + 2 <lb/>1 − µ <lb/>N <lb/>ν1 N N + λ 1 D = E 1 q • D. <lb/>(B.8) <lb/>Then, assuming that D and E t q commute, and given that we assume D = D T , <lb/>E t +1 q = 1 − <lb/>2 <lb/>N <lb/>E t q + <lb/>2(1 − µ) <lb/>N <lb/>D • E t q + λ t I N , <lb/>(B.9) <lb/>so <lb/>D • E t +1 q = 1 − <lb/>2 <lb/>N <lb/>D • E t q + <lb/>2(1 − µ) <lb/>N <lb/>D 2 • E t q + λ t D = E t +1 q • D (B.10) <lb/>And so, when t → ∞, we have D • Q = Q • D. <lb/>Then with a transitive undirected dispersal graph, eq. (B.6), simplifies into <lb/>Q = <lb/>1 − µ <lb/>ν <lb/>D • Q + λ M I N , <lb/>(B.11) <lb/>and so (for µ &gt; 0), <lb/>Q = λ M I N − <lb/>1 − µ <lb/>ν <lb/>D <lb/>−1 <lb/>, <lb/>(B.12a) <lb/></div>

			<page>47 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">with <lb/>λ M = <lb/>1 <lb/>I N − <lb/>1−µ <lb/>ν D <lb/>−1 <lb/>1,1 <lb/>. <lb/>(B.12b) <lb/>Eq. (B.11) also implies <lb/>Q = <lb/>(1 − µ) 2 <lb/>ν 2 D • D • Q + λ M <lb/>1 − µ <lb/>ν <lb/>D + λ M I N . <lb/>(B.13) <lb/>It is possible to find more explicit formulae when the graphs are transitive and <lb/>when they are n-dimensional, and we do so for 1-D and 2-D graphs. <lb/>One-dimensional graphs <lb/>On a 1-D graph, numbering the different nodes modulo N , for all i and j , by <lb/>definition of a 1-D graph, d i j = d 0, j −i = d j −i , and as a result similar equalities <lb/>hold for the expected states of pairs of sites: Q i j = Q 0, j −i = Q j −i . We can hence <lb/>rewrite eq. (B.5) as follows, keeping in mind that Q i j = Q j i and that node num-<lb/>bering is done modulo N : <lb/>Q i j = Q j −i = <lb/>1 − µ <lb/>2ν k <lb/>d 0, j −k Q 0,k−i + d 0,i −k Q 0, j −k <lb/>(i = j ) <lb/>= <lb/>1 − µ <lb/>2ν k <lb/>d 0,k P 0, j −i −k + d 0,k P 0, j −i +k [change of variables k = j − k] <lb/>= <lb/>1 − µ <lb/>2ν k <lb/>dk P j −i −k + dk P j −i +k , <lb/>so that <lb/>Ql = <lb/>1 − µ <lb/>2ν <lb/>k <lb/>dk Ql−k + dk Ql+k + δ l λ M , <lb/>(B.14) <lb/></div>

			<page>48 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">where δ l = 1 when l ≡ 0 and δ l = 0 otherwise, and λ is as defined in the previous <lb/>section, i.e., such that Q0 = 1: <lb/>λ M = 1 − <lb/>1 − µ <lb/>ν k <lb/>dk Qk . <lb/>(B.15) <lb/>(Recall that Ql = Q−l ). <lb/>To solve for Ql , we can follow the same method as in Malécot (1975); Gandon <lb/>&amp; Rousset (1999) and use discrete Fourier transforms, defining the transforms of <lb/>Q and of d as follows: <lb/>Q q = <lb/>N −1 <lb/>l =0 <lb/>Ql exp −ı <lb/>2πql <lb/>N <lb/>, <lb/>(B.16a) <lb/>D q = <lb/>N −1 <lb/>l =0 <lb/>dl exp −ı <lb/>2πql <lb/>N <lb/>. <lb/>(B.16b) <lb/>and in particular (ν being the degree of the dispersal graph) <lb/>D 0 = <lb/>l <lb/>dl = ν. <lb/>(B.16c) <lb/>We obtain <lb/>Q q =λ M + <lb/>N −1 <lb/>l =0 <lb/>1 − µ <lb/>2ν <lb/>k <lb/>dk Ql−k + dk Ql+k exp −ı <lb/>2πql <lb/>N <lb/>, <lb/>(B.17a) <lb/>=λ M + <lb/>1 − µ <lb/>2ν <lb/>D q Q q + D −q Q q . <lb/>(B.17b) <lb/>Solving for Q q , we obtain <lb/>Q q = <lb/>λ M <lb/>1 − <lb/>1−µ <lb/>2ν D q + D −q <lb/>. <lb/>(B.17c) <lb/></div>

			<page>49 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">To recover Q, we now use an Inverse Discrete Fourier Transform <lb/>Qr = <lb/>1 <lb/>N <lb/>N −1 <lb/>q=0 <lb/>Q q exp ı <lb/>2πqr <lb/>N <lb/>; <lb/>(B.18) <lb/>combining eq. (B.17c) and eq. (B.18), we obtain <lb/>Qr = <lb/>1 <lb/>N <lb/>N −1 <lb/>q=0 <lb/>λ M <lb/>1 − <lb/>1−µ <lb/>2ν D q + D −q <lb/>exp ı <lb/>2πqr <lb/>N <lb/>. <lb/>(B.19a) <lb/>When r = 0, we have Q0 = 1, so combining this with eq. (B.19a), we can now <lb/>evaluate λ: <lb/>λ M = <lb/>N <lb/>N −1 <lb/>q=0 <lb/>1 <lb/>1− <lb/>1−µ <lb/>2ν (Dq+D−q) <lb/>. <lb/>(B.19b) <lb/>Finally, when the graph is not oriented, D q = D −q . <lb/>Two-dimensional graphs <lb/>Similar calculations are done with two-dimensional graphs. Numbering is done <lb/>modulo N 1 for the first dimension, and modulo N 2 for the second dimension <lb/>(N 1 N 2 = N ). The 2-D equivalent of eq. (B.14) is <lb/>Ql 1 <lb/>l 2 <lb/>= <lb/>1 − µ <lb/>2ν <lb/>N 1 −1 <lb/>k 1 =0 <lb/>N 2 −1 <lb/>k 2 =0 <lb/>dk 1 <lb/>k 2 <lb/>Ql 1 −k 1 <lb/>l 2 −k 2 <lb/>+ dk 1 <lb/>k 2 <lb/>Ql 1 +k 1 <lb/>l 2 +k 2 <lb/>+ δl 1 <lb/>l 2 <lb/>λ M , <lb/>(B.20) <lb/>where δk 1 <lb/>k 2 <lb/>= 1 when (k 1 , k 2 ) ≡ (0, 0) (modulo N 1 and N 2 ), and δk 1 <lb/>k 2 <lb/>= 0 otherwise, <lb/>and <lb/>λ M = 1 − <lb/>1 − µ <lb/>ν <lb/>N 1 −1 <lb/>l 1 =0 <lb/>N 2 −1 <lb/>l 2 =0 <lb/>dk 1 <lb/>k 2 <lb/>Qk 1 <lb/>k 2 <lb/>. <lb/>(B.21) <lb/></div>

			<page>50 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">We then use 2-D Discrete Fourier Transforms: <lb/>Qq1 <lb/>q 2 <lb/>= <lb/>N 1 −1 <lb/>l 1 =0 <lb/>N 2 −1 <lb/>l 2 =0 <lb/>Ql 1 <lb/>l 2 <lb/>exp −ı <lb/>2πq 1 l 1 <lb/>N 1 <lb/>exp −ı <lb/>2πq 2 l 2 <lb/>N 2 <lb/>, <lb/>(B.22a) <lb/>Dq1 <lb/>q 2 <lb/>= <lb/>N 1 −1 <lb/>l 1 =0 <lb/>N 2 −1 <lb/>l 2 =0 <lb/>dl 1 <lb/>l 2 <lb/>exp −ı <lb/>2πq 1 l 1 <lb/>N 1 <lb/>exp −ı <lb/>2πq 2 l 2 <lb/>N 2 <lb/>, <lb/>(B.22b) <lb/>and obtain <lb/>Qq1 <lb/>q 2 <lb/>= λ M + <lb/>1 − µ <lb/>2ν <lb/>Dq1 <lb/>q 2 <lb/>+ D−q1 <lb/>−q 2 <lb/>Pq1 <lb/>q 2 <lb/>. <lb/>(B.23a) <lb/>Solving for Qq1 <lb/>q 2 <lb/>, <lb/>Qq1 <lb/>q 2 <lb/>= <lb/>λ M <lb/>1 − <lb/>1−µ <lb/>2ν D q 1 <lb/>q 2 + D −q 1 <lb/>−q 2 <lb/>. <lb/>(B.23b) <lb/>Finally, an Inverse Fourier Transform gives us Qr 1 <lb/>r 2 <lb/>: <lb/>Qr 1 <lb/>r 2 <lb/>= <lb/>1 <lb/>N q 1 ,q 2 <lb/>λ M <lb/>1 − <lb/>1−µ <lb/>2ν D q 1 <lb/>q 2 + D −q 1 <lb/>−q 2 <lb/>exp ı <lb/>2πq 1 r 1 <lb/>N 1 <lb/>exp ı <lb/>2πq 2 r 2 <lb/>N 2 <lb/>, <lb/>(B.23c) <lb/>with C such that P0 <lb/>0 <lb/>= p: <lb/>λ M = <lb/>N <lb/>q 1 ,q 2 <lb/>1 <lb/>1− <lb/>1−µ <lb/>2ν D <lb/>q 1 <lb/>q 2 +D <lb/>−q 1 <lb/>−q 2 <lb/>. <lb/>(B.23d) <lb/>And when the graph is undirected, D −q 1 <lb/>−q 2 = D q 1 <lb/>q 2 . <lb/></div>

			<page>51 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">Illustration: infinite circle <lb/>On a circle graph (like in figure 3(a)), the Fourier transform of the dispersal dis-<lb/>tance is <lb/>D q = 2 cos <lb/>2πq <lb/>N <lb/>. <lb/>(B.24) <lb/>We can evaluate λ M using eq. (B.19b), <lb/>λ M = <lb/>N <lb/>N −1 <lb/>q=0 <lb/>1 <lb/>1−(1−µ) cos <lb/>2πq <lb/>N <lb/>, <lb/>(B.25a) <lb/>and when population size is infinite, this becomes <lb/>λ M = <lb/>1 <lb/>1 <lb/>0 <lb/>1 <lb/>1−(1−µ) cos(2πx) dx <lb/>= µ(2 − µ). <lb/>(B.25b) <lb/>But we note that the integral does not converge when µ → 0. Finally, we compute <lb/>probabilities of identity by descent using eq. (B.19a), and obtain eq. (28b) in the <lb/>main text for neighbors on the the circle (q = 1). <lb/>Wright-Fisher model <lb/>In a Wright-Fisher model, all individuals are replaced at each time step. Given a <lb/>state X at time t , for i = j , probabilities of identity by descent verify <lb/>E q i j (t + 1)|X (t ) =(1 − µ) 2 <lb/>k,l <lb/>d ki d l j <lb/>ν 2 q kl (t ). <lb/>(B.26) <lb/></div>

			<page>52 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">Taking the expectation of this quantity over the stationary distribution of states, <lb/>we obtain <lb/>Q i j = <lb/>(1 − µ) 2 <lb/>ν 2 <lb/>k,l <lb/>d ki d l j Q kl <lb/>(i = j ), <lb/>(B.27) <lb/>and Q i j = 1 when i = j . Eq. (B.27) is valid for any regular graph; all the Q i j terms <lb/>can be found by solving a system of N (N − 1)/2 equations (since Q i j = Q j i ). We <lb/>can also write eq. (B.5) in matrix form: <lb/>Q = <lb/>(1 − µ) 2 <lb/>ν 2 (D T QD) + L, <lb/>(B.28) <lb/>where D is the adjacency matrix of the dispersal graph (with elements d i j ), T <lb/>denotes transposition, and L is a diagonal matrix whose i th diagonal element is <lb/>such that Q i i = 1. <lb/>Transitive undirected graphs <lb/>When the dispersal graph is transitive, then all the elements on the diagonal of <lb/>L are equal, so we can write L = λ W F I N , where I N is the N by N identity matrix. <lb/>Like in the case of a Moran updating, when the graph is also undirected, D = D T , <lb/>and we also show by induction that DQ = QD (Grafen &amp; Archetti, 2008). <lb/>Let us assume without loss of generality that initially (t = 0) all individuals are <lb/>IBD (q i j (0) = 1 N N , where 1 N N is the N -by-N matrix containing only ones) and <lb/>of type B (X (0) = {0, . . . , 0}). Also, let us denote by ζ 0 (X , t ) the probability that <lb/>the population is in state X at time t given that it was in state {0, . . . , 0} at time 0, <lb/>and by E t expectations with respect to that distribution, at time t . Then from <lb/></div>

			<page>53 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">eq. (B.26), since q i i = 1, and given that the graph is regular, <lb/>E 1 q = <lb/>(1 − µ) 2 <lb/>ν 2 1 N N + λ 1 I N , <lb/>(B.29) <lb/>so <lb/>D • E 1 q = <lb/>(1 − µ) 2 <lb/>ν 2 ν1 N N + λ 1 D = E 1 q • D. <lb/>(B.30) <lb/>Then, assuming that D and E t q commute, and given that we assume an undi-<lb/>rected dispersal graph (D = D T ), <lb/>E t +1 q = <lb/>(1 − µ) 2 <lb/>ν 2 D • D • E t q + λ t I N , <lb/>(B.31) <lb/>so <lb/>D • E t +1 q = <lb/>(1 − µ) 2 <lb/>ν 2 D • D • D • E t q + λ t D = E t +1 q • D <lb/>(B.32) <lb/>And so, when t → ∞, we have D • Q = Q • D. <lb/>Then with a transitive undirected dispersal graph, eq. (B.28), simplifies into <lb/>Q = <lb/>(1 − µ) 2 <lb/>ν 2 D • D • Q + λ W F I N , <lb/>(B.33) <lb/>and so (for µ &gt; 0), <lb/>Q = λ W F I N − <lb/>(1 − µ) 2 <lb/>ν 2 DD <lb/>−1 <lb/>, <lb/>(B.34a) <lb/></div>

			<page>54 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">with <lb/>λ W F = <lb/>1 <lb/>I N − <lb/>(1−µ) 2 <lb/>ν 2 DD <lb/>−1 <lb/>1,1 <lb/>. <lb/>(B.34b) <lb/>It is possible to find more explicit formulae when the graphs are transitive and <lb/>when they are n-dimensional, and we do so for 1-D and 2-D graphs. <lb/>One-dimensional graphs <lb/>In a 1D graph, we can rewrite eq. (B.27) as follows, were Qm = Q 0m (numbering <lb/>being done modulo N ): <lb/>Qm = <lb/> <lb/> <lb/> <lb/> <lb/> <lb/> <lb/> <lb/>k,l <lb/>dk dl <lb/>ν 2 Qm−l+k (m = 0) <lb/>1 <lb/>(m = 0). <lb/>(B.35) <lb/>Using a Discrete Fourier Transform (see eq. (B.16)), we obtain, <lb/>Q q = <lb/>(1 − µ) 2 <lb/>ν 2 D q D −q Q q + λ W F , <lb/>(B.36a) <lb/>with <lb/>λ W F =1 − <lb/>k,l <lb/>dk dl <lb/>ν 2 Q−l+k . <lb/>(B.36b) <lb/>Solving for Q q , we obtain <lb/>P q = <lb/>λ W F <lb/>1 − <lb/>(1−µ) 2 <lb/>ν 2 D q D −q <lb/>. <lb/>(B.36c) <lb/></div>

			<page>55 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">Appendix B <lb/>Then using an Inverse Fourier Transform to recover Q (see eq. (B.18)), we obtain <lb/>Qr = <lb/>1 <lb/>N <lb/>N −1 <lb/>q=0 <lb/>λ W F <lb/>1 − <lb/>(1−µ) 2 <lb/>ν 2 D q D −q <lb/>exp ı <lb/>2πqr <lb/>N <lb/>(B.37) <lb/>Noting that Q0 = 1, we can evaluate λ: <lb/>λ W F = <lb/>N <lb/>N −1 <lb/>q=0 <lb/>1 <lb/>1− <lb/>(1−µ) 2 <lb/>ν 2 D q D −q <lb/>. <lb/>(B.38) <lb/>Two-dimensional graphs <lb/>Following the same method as previously, we obtain <lb/>Qr 1 <lb/>r 2 <lb/>= <lb/>1 <lb/>N q 1 ,q 2 <lb/>λ W F <lb/>1 − <lb/>(1−µ) 2 <lb/>ν 2 <lb/>D q 1 <lb/>q 2 D −q 1 <lb/>−q 2 <lb/>exp ı <lb/>2πq 1 r 1 <lb/>N 1 <lb/>exp ı <lb/>2πq 2 r 2 <lb/>N 2 <lb/>, <lb/>(B.39a) <lb/>with <lb/>λ W F = <lb/>N <lb/>q 1 ,q 2 <lb/>1 <lb/>1− <lb/>(1−µ) 2 <lb/>ν 2 <lb/>D <lb/>q 1 <lb/>q 2 D <lb/>−q 1 <lb/>−q 2 <lb/>. <lb/>(B.39b) <lb/>Illustration: Circle graph with self-loops <lb/>On a circle graph with self-loops (like in figure 3(b)), the Fourier transform of the <lb/>dispersal distance is <lb/>D q = (1 − m) + m cos <lb/>2πq <lb/>N <lb/>. <lb/>(B.40) <lb/></div>

			<page>56 <lb/></page>

			<note place="headnote">Appendix B <lb/></note>

			<div type="annex">(Here ν = 1, while with the circle graph we had ν = 2; this does not matter for <lb/>IBD). We can evaluate λ W F using eq. (B.38), <lb/>λ W F = <lb/>N <lb/>N −1 <lb/>q=0 <lb/>1 <lb/>1−(1−µ) 2 (1−m)+m cos <lb/>2πq <lb/>N <lb/>2 <lb/>, <lb/>(B.41a) <lb/>and when population size is infinite, this becomes <lb/>λ W F = <lb/>1 <lb/>1 <lb/>0 <lb/>1 <lb/>1−(1−µ) 2 ((1−m)+m cos(2πx)) 2 dx <lb/>, <lb/>= <lb/>2 (2 − µ)µ(−µ − 2(1 − µ)m + 2)(µ + 2(1 − µ)m) <lb/>(2 − µ)(−µ − 2(1 − µ)m + 2) + µ(µ + 2(1 − µ)m) <lb/>, <lb/>(B.41b) <lb/>according to Mathematica (Wolfram Research, Inc., 2015) (isn&apos;t this amazing?). <lb/>Here as well, the integral does not converge when µ → 0. Finally, we compute <lb/>probabilities of identity by descent using eq. (B.39a), and obtain eq. (29) in the <lb/>main text for neighbors on the the circle (q = 1). <lb/></div>

			<page>57 <lb/></page>

			<note place="headnote">Appendix C <lb/></note>

			<div type="annex">C Derivatives of B i j and D j for specific life-cycles <lb/>Birth-Death updating <lb/>With a Moran Birth-Death updating rule (see eq. (14)), the derivatives of B i j and <lb/>D j with respect to f k are <lb/>∂B i j <lb/>∂ f k δ=0 <lb/>= <lb/>d j i <lb/>ν <lb/>δ j ,k N − 1 <lb/>N 2 <lb/>, <lb/>(C.1a) <lb/>∂D j <lb/>∂ f k δ=0 <lb/>= <lb/>d k j <lb/>N ν <lb/>− <lb/>1 <lb/>N 2 , <lb/>(C.1b) <lb/>with <lb/>δ j ,k = <lb/> <lb/> <lb/> <lb/> <lb/> <lb/> <lb/> <lb/>1 when j = k, <lb/>0 otherwise. <lb/>(C.2) <lb/>Consequently, <lb/>∂W j <lb/>∂ f k δ=0 <lb/>= <lb/>δ j ,k <lb/>N <lb/>− <lb/>d k j <lb/>N ν <lb/>. <lb/>(C.3) <lb/>Death-Birth updating <lb/>With a Moran Death-Birth updating rule (see eq. (19)), the derivatives of B i j and <lb/>D j with respect to f k are given by the following equations: <lb/>∂B i j <lb/>∂ f k δ=0 <lb/>= <lb/>δ k, j d ki ν − d j i d ki <lb/>N ν 2 <lb/>, <lb/>(C.4a) <lb/>∂D j <lb/>∂ f k δ=0 <lb/>= 0, <lb/>(C.4b) <lb/></div>

			<page>58 <lb/></page>

			<note place="headnote">Appendix C <lb/></note>

			<div type="annex">with δ k, j as defined in eq. (C.2). As a result, <lb/>∂W j <lb/>∂ f k δ=0 <lb/>= <lb/>δ k, j <lb/>N <lb/>− <lb/>N <lb/>i =1 <lb/>d j i d ki <lb/>N ν 2 . <lb/>(C.5) <lb/>Wright-Fisher updating <lb/>With a Wright-Fisher updating rule (see eq. (22)), the derivatives of B i j and D j <lb/>with respect to f k are <lb/>∂B i j <lb/>∂ f k δ=0 <lb/>= <lb/>δ k, j d ki ν − d j i d ki <lb/>ν 2 <lb/>, <lb/>(C.6a) <lb/>∂D j <lb/>∂ f k δ=0 <lb/>= 0. <lb/>(C.6b) <lb/>with δ k, j as defined in eq. (C.2). Finally, <lb/>∂W j <lb/>∂ f k δ=0 <lb/>= δ k, j − <lb/>N <lb/>i =1 <lb/>d j i d ki <lb/>ν 2 . <lb/>(C.7) <lb/></div>

			<page>59 <lb/></page>

			<note place="headnote">Appendix C <lb/></note>

			<div type="annex">Figures <lb/>876 <lb/>Figure 1 <lb/>877 <lb/>n-dimensional <lb/>1-D <lb/>2-D <lb/>(a) <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>(b) <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>(c) <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>(d) <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>(e) <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>Figure 1: Examples of regular graphs of size 12. The graphs on the first line are <lb/>unoriented and unweighted graphs of degree ν = 3; Graph (d) is oriented, graph (e) <lb/>is weighted. (a) is the Frucht graph, and has no symmetry. Graphs (b) and (d) are <lb/>one-dimensional, graphs (c) and (e) are two-dimensional (see main text). <lb/></div>

			<page>60 <lb/></page>

			<note place="headnote">Appendix C <lb/></note>

			<div type="annex">Figure 2 <lb/>878 <lb/>Population structures <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>1 <lb/>2 <lb/>3 <lb/>4 <lb/>5 <lb/>6 <lb/>7 <lb/>8 <lb/>9 <lb/>10 <lb/>11 <lb/>12 <lb/>(a) Death-Birth <lb/>Mutation (µ) <lb/>E[X] <lb/>0.00 <lb/>0.10 <lb/>0.20 <lb/>0.46 <lb/>0.47 <lb/>0.48 <lb/>0.49 <lb/>0.50 <lb/>0.51 <lb/>0.52 <lb/>• • • <lb/>• <lb/>• <lb/>• <lb/>(b) Birth-Death <lb/>Mutation (µ) <lb/>E[X] <lb/>0.00 <lb/>0.10 <lb/>0.20 <lb/>0.46 <lb/>0.47 <lb/>0.48 <lb/>0.49 <lb/>0.50 <lb/>0.51 <lb/>0.52 <lb/>• <lb/>• <lb/>• <lb/>• <lb/>• <lb/>• <lb/>(c) Wright-Fisher <lb/>Mutation (µ) <lb/>E[X] <lb/>0.00 <lb/>0.10 <lb/>0.20 <lb/>0.46 <lb/>0.47 <lb/>0.48 <lb/>0.49 <lb/>0.50 <lb/>0.51 <lb/>0.52 <lb/>• <lb/>• <lb/>• <lb/>• <lb/>• <lb/>• <lb/>Figure 2: Expected frequency of type-A individuals E X , depending on popu-<lb/>lation structure (legend on the first line), updating rule ((a): Moran Death-Birth, <lb/>(b): Moran Birth-Death, (c): Wright-Fisher), and mutation probability µ (horizontal <lb/>axis): Comparison between the theoretical prediction (curves) and the outcomes <lb/>of numerical simulations (points). The horizontal dotted gray line corresponds to <lb/>p, the expected frequency of type-A individuals when there is no selection (i.e., <lb/>when δ = 0). Other parameters: δ=0.005, p = 1/2. <lb/></div>

			<page>61 <lb/></page>

			<note place="headnote">Appendix C <lb/></note>

			<div type="annex">Figure 3 <lb/>879 <lb/>(a) Circle graph <lb/>(b) . . . with self-loops <lb/>1 − m <lb/>m <lb/>2 <lb/>m <lb/>2 <lb/>(c) Moran updating <lb/>Mutation (µ) <lb/>Pr. neighbors IBD (Q <lb/>M ) <lb/>0.0 <lb/>0.4 <lb/>0.8 <lb/>0.0 <lb/>0.2 <lb/>0.4 <lb/>0.6 <lb/>0.8 <lb/>1.0 <lb/>(d) Wright-Fisher updating <lb/>Mutation (µ) <lb/>Pr. neighbors IBD (Q <lb/>M ) <lb/>0.0 <lb/>0.4 <lb/>0.8 <lb/>0.0 <lb/>0.2 <lb/>0.4 <lb/>0.6 <lb/>0.8 <lb/>1.0 <lb/>0.5 <lb/>0.75 <lb/>0.9 <lb/>0.999 <lb/>m = <lb/>Figure 3: Circle graphs, without (a) or with self-loops ((b); the weight of the self-<lb/>loop is 1 − m), and Probability that two neighbors on the graph are identical by <lb/>descent, as function of the mutation probability µ, for the Moran updating on an <lb/>infinite circle graph (c), and for the Wright-Fisher updating on an infinite circle <lb/>graph with self loops (d). In (d), emigration probabilities m take values 0.5, 0.75, <lb/>0.9, 0.999 (increasingly lighted curves). <lb/></div>

			<page>62 </page>


	</text>
</tei>
