<?xml version="1.0" ?>
<tei xml:space="preserve">
	<teiHeader>
		<fileDesc xml:id="0"/>
	</teiHeader>
	<text xml:lang="en">
			<front>LIMIX: genetic analysis of multiple traits <lb/>Christoph Lippert * , †,1 , Franceso Paolo Casale * ,2 , Barbara Rakitsch 3 , and <lb/>Oliver Stegle * , †,2 <lb/>1 Microsoft Research, Los Angeles, California, USA <lb/>2 European Molecular Biology Laboratory, European Bioinformatics Institute, Wellcome Trust Genome <lb/>Campus, Hinxton, Cambridge, United Kingdom <lb/>3 Machine Learning and Computational Biology Research Group, Max Planck Institutes Tübingen, <lb/>Germany <lb/>Multi-trait mixed models have emerged as a promising approach for joint analyses <lb/>of multiple traits. In principle, the mixed model framework is remarkably general. <lb/>However, current methods implement only a very specific range of tasks to optimize <lb/>the necessary computations. Here, we present a multi-trait modeling framework <lb/>that is versatile and fast: LIMIX enables to flexibly adapt mixed models for a broad <lb/> range of applications with different observed and hidden covariates, and variable <lb/>study designs. To highlight the novel modeling aspects of LIMIX we performed <lb/>three vastly different genetic studies: joint GWAS of correlated blood lipid pheno-<lb/>types, joint analysis of the expression levels of the multiple transcript-isoforms of <lb/>a gene, and pathway-based modeling of molecular traits across environments. In <lb/>these applications we show that LIMIX increases GWAS power and phenotype pre-<lb/>diction accuracy, in particular when integrating stepwise multi-locus regression into <lb/>multi-trait models, and when analyzing large numbers of traits. An open source <lb/>implementation of LIMIX is freely available at: https://github.com/PMBio/limix. <lb/> * These authors have contributed equally. <lb/> † Please address correspondence to lippert@microsoft.com and oliver.stegle@ebi.ac.uk. <lb/></front>

			<page>1 <lb/></page>

			<body>1 Introduction <lb/>The goal of genetic analyses of quantitative traits is to determine the sources of phenotypic <lb/>variation, attributing it to effects of single loci, polygenic background and confounding factors. <lb/>Linear mixed models (LMMs) have emerged as a powerful approach for this purpose and have <lb/>been successfully applied to genome-wide association studies (GWAS) in structured popula-<lb/>tions [1, 2, 3, 4], quantification of the proportion of heritability that can be attributed to sets of <lb/>SNPs [5, 6], prediction of phenotype from genotype [7], and to account for hidden confounding <lb/>factors, for example in expression quantitative trait loci (eQTL) mapping [8, 9]. Recently, there <lb/>has been increasing interest in methods that combine multiple traits that are correlated due to <lb/>shared (but hidden) genetic or non-genetic influences in a single model. By properly modeling <lb/>this trait correlation, a study can yield increased power to detect genuine genetic associations <lb/>and better interpretation. Consequently, multi-trait LMMs that account for such correlations <lb/>have been proposed, first in the field of animal breeding [10] and, more recently, also in the <lb/>context of GWAS [11, 12]. In genetics, the use of general-purpose mixed modeling tools is rare <lb/>(e.g. ref. [13]), mainly because these lack the computational efficiency that is required to handle <lb/>larger sample sizes. Instead, a number of rigid and highly specialized tools have been developed <lb/>that speed up the specific computations that are needed for a particular task, such as GWAS <lb/>testing [1, 2, 3, 4, 12], or variance component estimation [5, 6]. <lb/>However, because different multi-trait studies tend to have variable study designs, methods <lb/>have to be flexible enough to adapt the model, but still remain tractable for larger datasets. <lb/>Multiple trait-variates can for example correspond to repeated measurements of a single phe-<lb/>notype over time [14], in different tissues [15, 16], or under different environments [17, 18], but <lb/>also to different phenotypes such as expression values for multiple genes [17, 19, 20, 18], or the <lb/>variates of a blood profile [21]. Moreover, practical analyses often suggest iterative changes to <lb/>the model, both to increase power and to test for specific genetic architectures. Starting from <lb/>simple models of single traits, these can be extended to multi-trait models and subsequently to <lb/>stepwise multiple loci models [22]. At each stage, it is important to adjust model parameters, <lb/>and to objectively guide analysis decisions by rigorously comparing alternative models. This <lb/>will require model checking strategies, methods for robust parameter estimation, as well as to <lb/>address statistical problems such as overfitting. <lb/>Here we present LIMIX, a multi-trait mixed modeling framework that has the flexibility <lb/>to perform a broad range of genetic analyses in one tool, without sacrificing computational <lb/>efficiency. LIMIX enables modeling genetic or environmental factors by combining different <lb/>fixed effects, sample covariances and trait covariances. Thanks to sophisticated parameter <lb/></body>

			<page>2 <lb/></page>

			<body>regularization LIMIX can robustly infer complex covariances between large numbers of traits <lb/>without overfitting, thereby enabling joint analysis of tens or even hundreds of phenotypes, <lb/>substantially more than previous methods. Finally, LIMIX is computationally efficient, utilizing <lb/>speedups to circumvent unnecessary computations in multi-trait modeling that scale as the cube <lb/>of the number of traits [23, 24, 12]. At the same time, LIMIX extends efficient association <lb/>tests [3, 4] to multi-trait association tests for flexible genetic designs. We analyzed three very <lb/>different datasets to highlight novel modeling aspects of LIMIX. We show how to combine <lb/>multi-trait modeling and stepwise multi-locus association analyses by considering correlated <lb/>blood lipid traits from the Northern Finland Birth Cohort 1996 (NFBC1966) [21]. Next, we <lb/>jointly analyze abundance estimates of multiple transcript-isoforms of the same gene, estimated <lb/>from RNA-Seq in human [20], thereby improving detection power and interpretation of the <lb/>genetic architecture of isoform expression. We also demonstrate how multi-trait LMMs can <lb/>readily be extended to the joint genetic analysis of entire pathways consisting of dozens of <lb/>genes, both within and between environments [17]. And finally, we assess alternative models in <lb/>terms of their ability to predict phenotype from genotype. <lb/>2 Results <lb/>Improved flexibility and efficiency in multi-trait LMMs <lb/>Similar to genetic studies of single phenotypes using established univariate LMMs, LIMIX <lb/>represents each phenotype as the sum of a number of fixed effects and random effects. Depending <lb/>on the application, LIMIX allows free specification of each fixed and random effect, both for <lb/>univariate and multi-trait models. For example, in multi-trait GWAS covariates and the single <lb/>nucleotide polymorphism (SNP) tested are modeled as fixed effects and background variation, <lb/>such as population structure and noise, as random effects [3, 4, 22, 12] that are modulated using <lb/>an additional trait-trait covariance matrix. <lb/>Unlike previous computationally efficient single-trait and multi-trait LMMs [3, 4, 12, 11], <lb/>models defined in LIMIX are not restricted to rigid designs to achieve speedups. Instead, models <lb/>can be built freely and LIMIX automatically determines possible computational speedups [3, 4, <lb/>23, 24, 12] depending on the model specification and analysis task. <lb/>Combining multi-trait with multi-locus models improves GWAS of lipid related traits <lb/>Four lipid-related traits in the NFBC1966 [11, 22, 12] have been analyzed using joint association <lb/>tests of single loci to multiple-traits [11, 12] and in a separate study using models involving <lb/></body>

			<page>3 <lb/></page>

			<body>multiple loci effects on single traits [22]. Here, we revisit these data to show the advantages of <lb/>combining these two models into a single multiple-trait and multiple-loci analysis (see Online <lb/>Methods). This combination enables to explicitly test for allelic heterogeneity [22], i.e. multiple <lb/>independent genetic signals from loci that are in linkage disequilibrium (LD), across different <lb/>traits. Additionally, we show how additional tests for alternative genetic designs enable further <lb/>interpretation of multiple-trait associations. <lb/>A single-locus association scan using a four-degrees-of-freedom any effect test across all phe-<lb/>notypes, similar to [12], yielded significant associations at ten different loci (α = 5 × 10 −8 , <lb/>λ GC = 0.99, Supplementary Table 1); see top panel in Figure 1a. Next, we compared these <lb/>associations to the joint multi-trait multi-locus model. At an inclusion cutoff of 5 × 10 −8 the <lb/>multi-locus model uncovered 14 independent genetic effects, uncovering four independent sec-<lb/>ondary effects at four of the ten associated loci. Multiple SNPs selected by the model for each <lb/>of the CRP, LIPC and CETP genes and the CEACAM16-TOMM40-APOE region suggest the <lb/>presence of genetic heterogeneity in these well-characterized regions, which is in line with pre-<lb/>vious findings [25]. Moreover, at two of the regions, CRP and CEACAM16-TOMM40-APOE, <lb/>the secondary SNP selected by the model was not significant in the single-locus association <lb/>test, indicating an increase in GWAS power (An example is shown in Figure 1b lower panel, <lb/>Supplementary Table 1). <lb/>To further tease apart effects that are shared between traits from trait-specific effects, we <lb/>complemented the analysis with one specific effect test per phenotype and a common effect test <lb/>across all phenotypes (see Online Methods). All tests were well-calibrated (see Supplementary <lb/>Table 1 for λ GC and Q − Q-plots in Supplementary Figure 1). The common effect test identified <lb/>significant associations at 9 of the 10 loci detected by the any effect multi-locus test-all but <lb/>the LIPC gene and a region on chromosome 8 between PPP1R3B and TNKS that had been <lb/>associated with LDL levels in a larger study [26]. Notably, the phenotype-specific effect tests <lb/>yielded significant associations at six out of the common effect loci, suggesting that many <lb/>effects have both a common and specific component. This trend is also visible in independent <lb/>single-trait analyses (Supplementary Table 1), suggesting that pleiotropic effects across all four <lb/>phenotypes are scarce, unlike pairwise pleiotropy previously reported on the same dataset [11]. <lb/>Statistical tests for dissecting isoform-specific genetic regulation of gene expression <lb/>Association analyses for alternative genetic designs in LIMIX can also be applied to tease apart <lb/>common from differential expression regulation of multiple isoform variants of single genes. Here, <lb/>we analyzed deep RNA-Seq profiles for 464 HapMap samples [20], where we estimated the abun-<lb/></body>

			<page>4 <lb/></page>

			<body>dance of multiple isoforms for individual genes [27] (see Online Methods). We considered 9,246 <lb/>genes with at least two expressed isoforms and used alternative LMMs to test for cis associa-<lb/>tions between proximal sequence variants (± 1mb around genes) and alternative isoform levels <lb/>of these genes. Hidden confounding factors (beyond population structure) are a major concern <lb/>in eQTL analyses [28, 29]. Consequently, we used LIMIX to estimate an extended sample-to-<lb/>sample covariance that captures hidden confounding (similar to the PANAMA model [9]; see <lb/>Supplementary Figure 2). As expected from previous results for single trait LMMs [9], account-<lb/>ing for hidden confounding increased power in multiple trait LMMs. Moreover, the observed <lb/>power increase was even marginally larger in the multiple trait case than in the single trait case <lb/>(Figure 2a; see Supplementary Table 2 for a list of significant associations). <lb/>At a nominal significance level of FDR ≤ 1% (using Q-values [30]), the multi-trait model <lb/>identified 3,648 genes (39.5%) with at least one eQTL in cis, 4.8% more than a single-trait <lb/>LMM applied to each isoform independently (3,834 genes with an eQTL in cis, Figure 2a). <lb/>Additionally, multi-trait testing enabled classifying individual eQTLs into genetic effects that <lb/>affect whole-gene expression (common effect test eQTLs) and genetic effects that are isoform-<lb/>specific (specific effect test eQTLs) (Figure 2b, Supplementary Figure 3). <lb/>Notably, for 29.4% of the genes with a cis eQTL (relative to any effect test, Figure 2b) <lb/>the multi-trait model identified both an isoform-specific eQTL and a common effect eQTL in <lb/>the same region, suggesting the presence of multiple independent genetic effects within single <lb/>genes. To investigate this, we performed multi-locus analysis in the cis region of each gene <lb/>jointly across all isoforms, yielding two or more independent associations (test statistics were <lb/>calibrated; Supplementary Figure 4) for almost a third of all genes with an eQTL (28.3 %) <lb/>and three or more independent associations for 27.8% of these (Figure 2c). A good example <lb/>is PRR5L, a gene with four expressed isoforms (out of twenty-one annotated ones), where two <lb/>unique eQTLs could be detected. The first lead eQTL corresponds to a common effect and the <lb/>secondary eQTL was specific to one of the isoforms (Figure 2d). <lb/>Genome-wide, both the primary eQTLs and the independent higher-order associations all <lb/>tended to occur near the transcription start site, which gives confidence that the multi-locus <lb/>associations found are genuine [28, 20] (Supplementary Figure 5). <lb/>Variance component models to characterize genotype-environment interactions on gene <lb/>expression <lb/>Similar to the definition of flexible testing designs for fixed effects, LIMIX enables constructing <lb/>interpretable designs for random effects. To show this, we revisited a yeast genetics dataset <lb/></body>

			<page>5 <lb/></page>

			<body>where gene expression levels have been measured under two conditions [17]. We demonstrate <lb/>how to partition phenotypic variance, not only across genetic regions [6], but also within and <lb/>between environments. <lb/>For this application, we considered an LMM that estimates components of expression vari-<lb/>ability for environmental effects, cis genetic effects, trans genetic effects, and their respective <lb/>interactions (cis GxE, trans GxE) (see Online Methods). Unlike related methods for cross-tissue <lb/>heritability estimation [15], we tease apart individual genetic effects, simultaneously estimating <lb/>the phenotypic variation that is due to environment-persistent effects and due to genotype-<lb/>environment interactions (GxE). <lb/>In genome-wide averages, we found that cis variation generally was more persistent to changes <lb/>in environment, indicating that large parts of gene-environment interactions are are due to trans <lb/>variation (cis GxE versus trans GxE) (see Figure 3a). Consequently, when grouping genes <lb/>by annotated yeast pathways and ranking pathways by their average proportion of variance <lb/>explained by GxE effects (the sum of cis GxE and trans GxE) (see Online Methods), we <lb/>obtain processes that are enriched for trans variation (Figure 3b). These processes are plausibly <lb/>implicated with the environmental stimulus (Supplementary Table 3). For example, Lysine <lb/>biosynthesis (sce00300), consisting of 11 genes, has previously been found to be controlled by <lb/>an interaction of genetic and environmental factors [31]. <lb/>Pathway-based genetic analysis across multiple environments <lb/>Next, to study how this variance components analysis complements multi-trait GWAS, we used <lb/>multi-trait LMMs for association testing of the Lysine biosynthesis pathway, where we jointly <lb/>considered all genes in the pathway (11) under both conditions (22 expression levels in total). <lb/>Notably, this analysis shows how LIMIX can be used to integrate substantially more traits than <lb/>previous applications of multi-trait LMMs [11, 12], and simultaneously spans both the axes of <lb/>multiple genes in a pathway and multiple environments. First, we used LIMIX to construct a <lb/>multi-trait single-locus model across all 22 traits. While other multi-trait methods, e.g. [12], <lb/>can in principle be used to test for associations between single loci and this number of traits, we <lb/>found LIMIX to greatly increase GWAS power (Optimally regularized model as in LIMIX versus <lb/>an unregularized multi-trait LMM [12], Figure 4a, Supplementary Figure 6). This difference <lb/>in power is because LIMIX allows for regularization of trait-trait covariances (Supplementary <lb/>Figure 7, Online Methods), which we found to be critical for analyzing datasets with more than <lb/>a handful of traits (Supplementary Figure 6; see also the Section below). <lb/>Next, turning our attention to the eQTL mapping results from this 22-degrees-of-freedom any <lb/></body>

			<page>6 <lb/></page>

			<body>effect test, the multi-trait LMM identified 4 significantly associated regions on chromosomes <lb/>two, three, seven and fourteen (Bonferroni adjusted α = 0.05; see Figure 4b, upper panel). <lb/>Analogous to the analysis on the NFBC data, we observed that multi-locus tests in combination <lb/>with multi-trait modeling yielded an additional increase in detection power (10 distinct loci, 6 <lb/>more than single-locus testing), suggesting complex genetic control of this pathway (Figure 4b, <lb/>lower panel; Supplementary Table 4). Notably, we found that simpler pairwise multi-trait <lb/>LMMs, where individual genes are tested independently but jointly across both environments <lb/>(for example as in MTMM [11]), were underpowered (Figure 4c, Supplementary Table 4). The <lb/>full multi-trait multi-locus model built in LIMIX uncovered five additional eQTLs that could <lb/>not be detected by any other approach, 2 additional cis associations and 3 additional trans <lb/>associations (Supplementary Table 4). This shows that multi-trait tests can add power not only <lb/>for detecting trans effects, but also for detecting cis eQTLs, which are expected to target a <lb/>single gene. <lb/>In addition to joint testing across all genes end environments, LIMIX allows to define application-<lb/>specific tests to leverage the structure in the data, here phenotypic measurements that span <lb/>both multiple genes in a pathway and two environmental conditions. To show this, we con-<lb/>structed a specific effect test for one of the two conditions (glucose), jointly testing for genotype-<lb/>environment interactions across all genes (11 degrees-of-freedom test, Online Methods). In com-<lb/>bination with the multi-locus model above, this test revealed GxE effects at two trans eQTLs, <lb/>one on chromosome sixteen and one on chromosome fifteen (see Supplementary Figure 8c). The <lb/>latter is located at ATP19, which encodes a subunit of a large enzyme complex (F1F0 ATP) <lb/>required for ATP synthesis [32]. <lb/>Finally, we repeated similar analyses on an even larger pathway (glycine, serine and threonine <lb/>metabolism, sce00260, 24 genes), showing how LIMIX can be used for larger problems, and <lb/>finding similar increases in mapping power (Supplementary Figure 9). <lb/>Assessing and validating genetic models <lb/>The covariance models considered in these applications have been fit using out-of-sample pre-<lb/>diction performance to adjust regularization and to guide model selection. <lb/>To validate this approach and to show that appropriately regularized models improve pheno-<lb/>type prediction on independent test data, we assessed the fitted models in a holdout experiment. <lb/>First, we compared independent single-trait models (ST) to one joint multi-trait model (MT), <lb/>re-estimating the parameters on each set of training data and computing best linear unbiased <lb/>prediction (BLUP; see Online Methods) to predict the phenotypes of the test samples. On <lb/></body>

			<page>7 <lb/></page>

			<body>each dataset, we performed multiple repeats of cross validation, resulting in between 10 (human <lb/>eQTL data) and 500 (NFBC) independent splits in training and test data (Online Methods). <lb/>Without inclusion of fixed effects, the multi-trait model tended to show significant improvements <lb/>in prediction over the single-trait model in all three application domains (Figure 5, Supplemen-<lb/>tary Figures 10-12). Next, we performed multi-locus modeling in each of the single-trait models <lb/>and in the multi-trait model by running forward selection on the training data. Adding the loci <lb/>detected in this way as fixed effects in the LMM consistently further improved the predictions <lb/>over the corresponding model without fixed effects, both for independent BLUPs (ST multi-<lb/>locus versus ST) as well as for the joint multi-trait BLUP (MT multi-locus versus MT). The <lb/>improved prediction performance suggests that the SNPs obtained from multi-locus modeling <lb/>tag genuine genetic signal. <lb/>In the human eQTL study, we considered the largest number of independent prediction ex-<lb/>periments, where for each of the 9,246 genes a separate experiment was carried out. When <lb/>comparing predictions from a naive single-trait LMM (ST) to the multi-locus multi-trait LMM <lb/>(MT multi-locus), the number of genes with correlation coefficient between predicted and true <lb/>expression values of at least 0.5 increased from 1 to 73 and the number of genes with correla-<lb/>tion coefficient of 0.1 or better went up from 2,370 to 3,438 (Figure 5). Notably, comparing <lb/>individual contributions of multi-locus modeling and multi-trait modeling, we observed that for <lb/>genes that could be accurately predicted (large ρ), multi-locus modeling was more important <lb/>than multi-trait modeling, whereas genes that where hard to predict (low ρ) benefited mostly <lb/>from multi-trait modeling (Figure 5). For a comparison of isoform predictions to predictions of <lb/>gene-level expression estimates [33] and stratification by the number of isoforms or heritability, <lb/>see Supplementary Figure 12). <lb/>3 Discussion <lb/>We have shown how a flexible mixed model framework allows to systematically extend LMMs <lb/>to the genetic analysis of multiple related phenotypes. Whereas so far multi-trait analysis has <lb/>been limited to GWAS on small groups of phenotypes [11, 12], due to computational complexity <lb/>or overfitting, LIMIX can perform a much wider range of LMM applications on much larger <lb/>numbers of phenotypes. We gave several example applications of LIMIX that address important <lb/>questions about how genetics affect related phenotypes. These include association tests of <lb/>different genetic designs, multi-locus analyses, variance components analysis, modeling of gene-<lb/>environment interactions, and phenotype prediction. <lb/>In three different analyses we have demonstrated how multi-trait LMMs can be most effective <lb/></body>

			<page>8 <lb/></page>

			<body>in practice. Whereas multi-trait LMMs [12, 11] and multi-locus LMMs [22] have been proposed <lb/>in isolation, we find that multi-trait LMMs are particularly powerful if combined with multi-<lb/>locus analyses. Owing to fast algorithms [23, 24, 12, 3, 4], it is now feasible to build complex <lb/>models with a fairly large number of independent genetic effects that jointly affect a set of <lb/>phenotypes in cohorts involving thousands of samples. In all cases these richer genetic models <lb/>revealed extensive allelic heterogeneity [22]. <lb/>Second, we have shown how multi-trait LMMs increase power and interpretation in genetic <lb/>analyses of different sets of molecular phenotypes. As one example, we analyzed individual <lb/>isoforms in human eQTL studies, where multi-trait analysis was used to dissect traditional gene-<lb/>level genetic effects, revealing extensive isoform-specific genetic regulation. The use of LIMIX <lb/>enabled to combine important concepts, such as accounting for expression heterogeneity [8, 9] <lb/>with multi-trait modeling as well as tests involving multiple loci [22]. In a second example <lb/>from yeast genetics, we have shown how multi-trait LMMs can be used to dissect genetic effects <lb/>on genes in a pathway along two different axes, genes and environmental conditions. Our <lb/>results show how genotype-environment interaction tests can be performed jointly for all genes <lb/>in a pathway to increase power. Finally, we found that multi-trait multi-locus models improve <lb/>genetic prediction of gene expression, a challenging task that has recently gained considerable <lb/>attention [33]. <lb/>LIMIX implements efficient algorithms that speed up multi-trait LMMs for analysis of larger <lb/>numbers of traits [23, 24, 12]. Beyond the challenge of computational scalability, it is a well <lb/>known problem in statistics that covariance estimation suffers from overfitting as the dimension <lb/>of the trait-covariance increases [34], mainly because the parameters of these models grow <lb/>quadratically whereas data only linearly. <lb/>Here, we address this problem by an automated model selection approach, which based on <lb/>out-of-sample prediction tunes model complexity and regularization, thereby enabling the joint <lb/>genetic analysis of even hundreds of traits (Online Methods). We have demonstrated the effec-<lb/>tiveness of this approach in the yeast experiments, where we show that non-regularized mod-<lb/>els [12, 11] can lead to loss of power and poor prediction performance. The use of regularization <lb/>to improve covariance estimation is well established in various different contexts [34, 23, 24], <lb/>including its use for estimating genetic covariance matrices [35], however, to the best of our <lb/>knowledge has not been used for multi-trait LMMs in GWAS. In our experiments we find that <lb/>appropriate regularization of genetic models becomes increasingly important as the number of <lb/>phenotype increases. <lb/>Finally, multi-trait LMMs should offer the greatest benefits if the phenotypes are correlated <lb/></body>

			<page>9 <lb/></page>

			<body>due to (partially) shared genetic causes or common environmental factors. Choosing the most <lb/>effective analysis approach is non-trivial and as discussed in previous work [11, 12], an indepen-<lb/>dent analysis of individual phenotypes can often be equally powered or even superior to complex <lb/>modeling choices. While there is no silver bullet solution, LIMIX provides a wide range of mod-<lb/>els and approaches that can be objectively compared within the same framework. The in-depth <lb/>applications of multi-trait modeling in the context of three application domains as presented <lb/>here can serve as an example to guide future studies. Moreover, these applications show how the <lb/>difficult task of selecting the most appropriate model can be addressed in a principled manner <lb/>by out-of-sample prediction, a tool of tremendous value to determine model complexity and to <lb/>validate complex genetic models. <lb/>Online methods <lb/>Multi-trait linear mixed models in LIMIX <lb/>Let N and P denote the number of samples and the number of traits in the genetic study. LIMIX <lb/>models the N × P matrix of phenotype values as the sum of any number J of matrix-variate <lb/>fixed effects F j and any number I of matrix-variate random effects U i : <lb/>Y = <lb/>J <lb/>j=1 <lb/>F j + <lb/>I <lb/>i=1 <lb/>U i . <lb/>(1) <lb/>Here, fixed and random effects are denoted by F j and U i respectively. This formulation gener-<lb/>alizes a wide range of previously proposed LMMs in genetics [1, 3, 12, 36, 37, 11, 22]. <lb/>Fixed effects Fixed effects represent known phenotypic covariates like gender, age, or ethnicity. <lb/>In the case of a GWAS, additionally the SNP being tested is modeled as a fixed effect. For each <lb/>sample n and trait p the j th fixed effect F j,n,p in (1) is given by the product of an effect size β j , <lb/>a sample design X n,j and a trait design A p,j : <lb/>F j,n,p = X n,j A p,j β j . <lb/>(2) <lb/>This fixed effect formulation generalizes the approach taken in single-trait LMMs, where fixed <lb/>effects are represented as the product of a sample design matrix and the fitted effect size. The <lb/>trait design matrix A is a design parameter that allows to specify alternative fixed effect designs <lb/>in multiple trait LMMs (see multi-trait models below). <lb/>Random effects Random effects are used to account for hidden influences such as a set of <lb/>unknown causal variants, population structure or relatedness between samples. Even though <lb/></body>

			<page>10 <lb/></page>

			<body>these effects are unobserved, the distribution of the corresponding random effect can be de-<lb/>scribed in terms of its covariance matrix. In LIMIX the covariance matrix of each random effect <lb/>U i is assumed to factor into an N -by-N sample-to-sample covariance matrix R i and a P -by-P <lb/>trait-to-trait covariance matrix C i as follows: <lb/>Cov(U i,n,p , U i,n ,p ) = C i,p,p • R i,n,n . <lb/>(3) <lb/>Again, this form generalizes random effects models in single-trait LMMs, where covariances are <lb/>modeled between samples only. <lb/>LIMIX supports a flexible number of random effect terms in the model. For each random <lb/>effect, both the trait and sample covariances can be chosen from a comprehensive class of <lb/>covariance models, including models for population structure and relatedness [1, 3], models for <lb/>hidden confounders inferred from high-dimensional phenotype data as in PANAMA [9], principal <lb/>components models [38, 39], non-linear kernel functions [40], as well as combinations like sums <lb/>and products of any of the aforementioned [41] (Supplementary Note 1). LIMIX performs <lb/>efficient and robust parameter estimation and model checking for each of these covariance <lb/>models. <lb/>Efficient estimation In general, parameter estimation in multi-trait mixed models would be <lb/>cubic in the number of values considered for Y , yielding a runtime of O(N 3 P 3 ). Due to <lb/>the poor scalability this form of estimation is applicable only to small to medium-sized data <lb/>sets. LIMIX utilizes specialized algorithms that, depending on the structure in the data, can <lb/>speed up computation. For example in multi-trait analyses with up to two random effects <lb/>the runtime of LIMIX is reduced to O(N 3 + P 3 ), whenever the matrix of phenotypes is fully <lb/>observed [24, 12, 23, 42, 43] (Supplementary Note 1). For parameter inference, LIMIX uses a <lb/>combination of gradient-based parameter inference (for random effects) and closed-form updates <lb/>for fixed effects (Supplementary Note 1). <lb/>Statistical testing By default LIMIX offers three different statistical tests for fixed effects <lb/>using different trait design matrices, which are similar to those proposed in [11]. The any effect <lb/>test is a P degrees-of-freedom test, where P is the number of traits, that tests whether there is <lb/>at least one effect between the SNP and the phenotypes. The common effect test has 1 degree <lb/>of freedom and tests if a SNP has the same effect size (and direction) across all the phenotypes. <lb/>The specific effect test for trait p has 1 degree of freedom and tests if a SNP has a different <lb/>effect on trait p. <lb/></body>

			<page>11 <lb/></page>

			<body>Tests for designs different from the aforementioned ones can be performed by choosing ap-<lb/>propriate trait design matrices both for the alternative and the null models. <lb/>Predictions LIMIX implements best linear unbiased prediction (BLUP) [44, 45, 24] for phe-<lb/>notype prediction from the model in Equation (1), combining random effects and fitted fixed <lb/>effects. Given the wealth of models made available in LIMIX, prediction in combination with <lb/>cross-validation is indispensable for monitoring overfitting, model validation, and model selec-<lb/>tion (see also Cross-validation below). Moreover, the prediction tool from LIMIX can be used <lb/>to impute missing phenotype values. <lb/>Multi-trait models used in experiments <lb/>Here, we describe the different models built in LIMIX that have been used in this manuscript. <lb/>Variance decomposition For the yeast eQTL analysis we jointly modeled the expression levels <lb/>of each gene across E = 2 environments and used an LMM with an environment-specific mean <lb/>modeled as fixed effect, two genetic random effect terms, accounting for contributions from <lb/>proximal (cis) and distal (trans) genetic variation, and a non-genetic random effect term (noise) <lb/>Y = [µ 1 , µ 2 ] ⊗ 1 N,1 + U cis + U trans + Ψ, <lb/>(4) <lb/>where µ 1 and µ 2 are environment-specific mean values. The variances of the random effects U cis , <lb/>U trans , are each decomposed into an environment-persistent and environment specific variance <lb/>component, whereas the noise ψ is fitted as free-form covariance <lb/>U cis ∼ N <lb/> <lb/> 0, <lb/> <lb/> c 2 <lb/>p 1 P,P + <lb/> <lb/> <lb/>c 2 <lb/>1 <lb/>0 <lb/>0 c 2 <lb/>2 <lb/> <lb/> <lb/> <lb/> ⊗ R cis <lb/> <lb/> , <lb/>U trans ∼ N <lb/> <lb/> 0, <lb/> <lb/> t 2 <lb/>p 1 P,P + <lb/> <lb/> <lb/>t 2 <lb/>1 <lb/>0 <lb/>0 t 2 <lb/>2 <lb/> <lb/> <lb/> <lb/> ⊗ R trans <lb/> <lb/> , <lb/>Ψ ∼ N <lb/> <lb/> 0, <lb/> <lb/> <lb/> <lb/> <lb/>σ 2 <lb/>1 <lb/>σ 1,2 <lb/>σ 1,2 σ 2 <lb/>2 <lb/> <lb/> <lb/> <lb/> ⊗ I <lb/> <lb/> . <lb/>(5) <lb/>The samples-to-sample covariance matrices R cis and R trans are calculated as a genomic related-<lb/>ness matrix estimated from the SNP data, where all SNPs within 100kb from the transcription <lb/>start site where considered as cis and the remaining SNPs as trans. This model is similar to <lb/>previous approaches that estimate persistent heritability values [46, 15] and builds on meth-<lb/>ods to estimate genetic variance components [5, 6]. We estimated the mean values µ 1 , and <lb/>µ 2 , the environment persistent variances and covariances for cis variation (c 2 <lb/>p ), trans variation <lb/></body>

			<page>12 <lb/></page>

			<body>(t 2 <lb/>p ), as well as the environment specific variances for all environments and the noise covariance <lb/>parameters (σ 2 <lb/>1 , σ 2 <lb/>2 , σ 1,2 ), resulting in a total of 11 parameters, by maximum likelihood. <lb/>For each gene, the environment persistent variance component was reported as the variance <lb/>of the block covariance (e.g. c 2 <lb/>p for cis) and environment specific variance components were <lb/>reported as the average of the two corresponding environment-specific variances (e.g. c 2 <lb/>1 and c 2 <lb/>2 <lb/>for cis GxE). The variance explained by direct environmental effects was estimated from the <lb/>effect sizes of the fixed effects, µ 1 and µ 2 and the residual noise variance was estimated as the <lb/>average of the noise variances (σ 2 <lb/>1 and σ 2 <lb/>2 ). The overall variance components from both fixed <lb/>and random effects were normalized to sum to 1 and subsequently averaged across the different <lb/>sets of genes considered in Fig.3. <lb/>For the pathway analysis, we considered only pathways for which at least 10 genes are con-<lb/>tained in the Kegg pathway datbase [47], resulting in 77 pathways. <lb/>Genome-wide association studies For multi-trait GWAS we used an LMM with trait-specific <lb/>means modeled as fixed effects, a fixed effect containing the SNP being tested, a random effect <lb/>accounting for genomic relatedness, and random noise: <lb/>vec(Y ) ∼ N [µ 1 , . . . , µ P ] ⊗ 1 N,1 + (A ⊗ x) β, σ 2 <lb/>g (C ⊗ R + δ Σ ⊗ I) . <lb/>(6) <lb/>Here, vec(Y ) denotes a stacking operation to creating an extended phenotpye vector from the <lb/>phenotype matrix. This representation allows to express multivariate normal models as stan-<lb/>dard normal models with Kronecker-structured fixed effects and covariances; see Supplementary <lb/>Note 1. The parameter µ p denotes the mean for phenotype p ∈ (1, . . . , P ) plus covariate effects, <lb/>x denotes the SNP being tested, B is the effect size estimate for a model specified by the trait <lb/>design matrix A. The random effects are parameterized by the genomic relatedness matrix <lb/>computed from genome-wide SNPs R, the trait-to-trait genetic covariance matrix C, the trait-<lb/>to-trait noise covariance matrix Σ, and scaling factors σ 2 <lb/>g and δ. Statistical testing for models <lb/>of form (6) is carried out by comparing the model likelihood under alternative designs A for <lb/>alternative (foreground) model and null (background) model in a likelihood-ratio test. Testing <lb/>a model without a SNP effect to a model with A = 1 1,P in the alternative model results in a <lb/>common effect test, i.e. a one degree of freedom test to detect associations with shared effect <lb/>sizes and directions across phenotypes, comparing a null model with A = 1 1,P to an alternative <lb/>model with an additional degree of freedom results in a specific effect test to detect phenotype-<lb/>specific regulation, and an any effect test with P degrees of freedom is achieved by comparing <lb/>a null model without a SNP effect to an alternative model with A = I P . Examples of more <lb/>complex designs are considered for the pathway-based genetic analysis across environments. <lb/></body>

			<page>13 <lb/></page>

			<body>Here, a joint environment-specific effect test for P genes across two environments is achieved <lb/>by comparing a model with A = I P ⊗ 1 1,2 to an alternative model with A = I P ⊗ I 2 , resulting <lb/>in a P degrees-of-freedom test. <lb/>For the transcript eQTL analysis in humans, the sample covariance matrix R was estimated <lb/>estimated using the LIMIX-implementation of PANAMA [9], thereby accounting for hidden <lb/>covariates and expression heterogeneity [29]. <lb/>In all experiments, the trait-to-trait covariance matrices C and Σ, as well as the sample <lb/>covariance matrix R, have been estimated on the null model only. In genome-wide tests, the <lb/>fitted matrices C and R were kept constant, however the scaling factors σ 2 <lb/>g and δ were refit for <lb/>each test, extending previous fast LMM algorithms [3, 4] to multi-trait analysis. More complex <lb/>fits where all parameters are updated are possible as well [12], however at the price of additional <lb/>computational cost. <lb/>Multi-locus models We used LIMIX to implement multi-trait multi-locus LMMs, which <lb/>combine concepts from the multi-locus LMM for single phenotypes [22] and single-locus LMMs <lb/>for multiple traits [11]. Similar to [22], we employ forward selection however using a multi-trait <lb/>LMM, iteratively including SNPs as fixed effect covariates into the model. In each iteration, <lb/>the most significant SNP using the any effect test is included into the model as a covariate for <lb/>the next iteration (we again consider the any effect design for each covariate). The single-<lb/>trait multi-locus model considered in the analysis is the special case P = 1 of the general <lb/>model. For experiments on the NFBC1966 data, we used the canonical GWAS significance <lb/>threshold of α = 5 × 10 −8 , both for single-locus and multi-locus models. Similarly, for the <lb/>genome-wide yeast eQTL mapping experiment, we employed a Bonferroni-adjusted significance <lb/>level of α = 0.05. For the human eQTL study, association tests were carried out in a local <lb/>cis-window around each gene (1mb up and downstream of genes) and significant eQTLs across <lb/>genes were called at a nominal significance level of 1% FDR (estimated using Q-values [30]). <lb/>For some analyses, we also considered a multi-trait multi-locus model using an alternative <lb/>genetic design for forward selection. Similarly, in the yeast eQTL analysis we employed an <lb/>interaction-test as forward-selection step (specific effect test for one of the two environmental <lb/>conditions) to classify included SNPs as genotype-environment interactions (Figure 4b lower <lb/>panel, Supplementary Figure 8). <lb/>Cross-validation We validated the models used in each experiment by cross-validation, pre-<lb/>dicting phenotype values on holdout samples by BLUP. In prediction experiments, we considered <lb/>a single-trait BLUP model (ST) and a multiple-trait BLUP (MT), performing joint predictions <lb/></body>

			<page>14 <lb/></page>

			<body>across phenotypes. Both models were extended by multi-locus approaches, where significant <lb/>SNPs identified by the model were included as additional fixed effect terms (ST multi-locus <lb/>&amp; MT multi-locus). For the human eQTL analysis, prediction experiments were carried out <lb/>using the genetic covariance, ignoring PANAMA [9] (see genome-wide association studies), as <lb/>PANAMA random effects cannot be evaluated out-of-sample. For models that required tun-<lb/>ing of regularization parameters we performed a separate round of cross-validation using the <lb/>training data only to avoid in-sample estimation. <lb/>Datasets and preprocessing <lb/>NFBC1966 We used results from the NFBC1966, consisting of phenotypic and genotypic data <lb/>for 5,402 individuals [21]. We followed the normalization procedure described in [12], focusing <lb/>on the four phenotypes CRP,LDL, HDL and TRIGL. <lb/>GEUVADIS eQTL dataset We used the official release of genotype and raw RNA-Seq dataset <lb/>from the GEUVAVIDS consortium [20]. First, raw RNA-Seq reads were mapped to the GRCh37.69 <lb/>reference transcriptome using Bowtie [48], followed by isoform abundance estimation using Bit-<lb/>Seq [27]. The MCMC samples of the BitSeq abundance estimates were processed in the natural <lb/>log-scale, resulting in mean isoform abundance estimates for 39,211 genes. Considering only <lb/>transcripts that were significantly expressed. We determined expression above background us-<lb/>ing a z-score cutoff, requiring that at least 5% of the samples were expressed 50% above the <lb/>noise background (standard deviation). This filter led to the identification of 16,278 genes that <lb/>express at least 1 transcript isoform. For the multi-trait analyses in Figure 2, only genes with <lb/>2-10 transcripts were used for analysis (9,246 genes). We ignored genes with more than 10 tran-<lb/>scripts from the analysis (952 total), as the transcript reconstruction in BitSeq was found to be <lb/>unstable for these genes [27]. For additional prediction experiments where gene-level abundance <lb/>estimates were considered (Supplementary Figure 12), the full set of of 15,220 genes with at <lb/>least one expressed transcript was used. <lb/>Yeast eQTL dataset We used preprocessed gene expression and genotype data as provided <lb/>by the authors [17]. The final dataset consisted of 109 individuals with 2,956 marker SNPs and <lb/>2 • 5, 493 expression levels, profiled in glucose and ethanol growth media respectively. For the <lb/>variance decomposition and multi-trait eQTL mapping, we considered Kegg pathways [47] with <lb/>at least 10 annotated genes. <lb/></body>

			<page>15 <lb/></page>

			<listBibl>References <lb/>[1] Kang, H. M. et al. Variance component model to account for sample structure in genome-<lb/>wide association studies. Nature genetics 42, 348-354 (2010). <lb/>[2] Zhang, Z. et al. Mixed linear model approach adapted for genome-wide association studies. <lb/>Nature genetics 42, 355-360 (2010). <lb/>[3] Lippert, C. et al. FaST linear mixed models for genome-wide association studies. Nature <lb/>Methods 8, 833-835 (2011). <lb/>[4] Zhou, X. &amp; Stephens, M. Genome-wide efficient mixed-model analysis for association <lb/>studies. Nature genetics 44, 821-824 (2012). <lb/>[5] Yang, J. et al. Common snps explain a large proportion of the heritability for human <lb/>height. Nature genetics 42, 565-569 (2010). <lb/>[6] Yang, J. et al. Genome partitioning of genetic variation for complex traits using common <lb/>snps. Nature genetics 43, 519-525 (2011). <lb/>[7] de los Campos, G., Vazquez, A. I., Fernando, R., Klimentidis, Y. C. &amp; Sorensen, D. <lb/>Prediction of complex human traits using the genomic best linear unbiased predictor. PLoS <lb/>genetics 9, e1003608 (2013). <lb/>[8] Listgarten, J., Kadie, C., Schadt, E. E. &amp; Heckerman, D. Correction for hidden confounders <lb/>in the genetic analysis of gene expression. Proceedings of the National Academy of Sciences <lb/>107, 16465-16470 (2010). <lb/>[9] Fusi, N., Stegle, O. &amp; Lawrence, N. D. Joint modelling of confounding factors and promi-<lb/>nent genetic regulators provides increased accuracy in genetical genomics studies. PLoS <lb/>computational biology 8, e1002330 (2012). <lb/>[10] Jiang, C. &amp; Zeng, Z.-B. Multiple trait analysis of genetic mapping for quantitative trait <lb/>loci. Genetics 140, 1111-1127 (1995). <lb/>[11] Korte, A. et al. A mixed-model approach for genome-wide association studies of correlated <lb/>traits in structured populations. Nature genetics 44, 1066-1071 (2012). <lb/>[12] Zhou, X. &amp; Stephens, M. Efficient multivariate linear mixed model algorithms for genome-<lb/>wide association studies. Nature Methods, in press (2014). <lb/></listBibl>

			<page>16 <lb/></page>

			<listBibl>[13] Gilmour, A. R., Gogel, B., Cullis, B. &amp; Thompson, R. Asreml user guide release 3.0. VSN <lb/>International Ltd, Hemel Hempstead, UK (2009). <lb/>[14] Francesconi, M. &amp; Lehner, B. The effects of genetic variation on gene expression dynamics <lb/>during development. Nature (2013). <lb/>[15] Price, A. L. et al. Single-tissue and cross-tissue heritability of gene expression via identity-<lb/>by-descent in related or unrelated individuals. PLoS genetics 7, e1001317 (2011). <lb/>[16] Sul, J. H., Han, B., Ye, C., Choi, T. &amp; Eskin, E. Effectively identifying eqtls from mul-<lb/>tiple tissues by combining mixed model and meta-analytic approaches. PLoS genetics 9, <lb/>e1003491 (2013). <lb/>[17] Smith, E. N. &amp; Kruglyak, L. Gene-environment interaction in yeast gene expression. PLoS <lb/>biology 6, e83 (2008). <lb/>[18] Kang, E. Y. et al. Meta-analysis identifies gene-by-environment interactions as demon-<lb/>strated in a study of 4,965 mice. PLoS genetics 10, e1004022 (2014). <lb/>[19] Pickrell, J. K. et al. Understanding mechanisms underlying human gene expression varia-<lb/>tion with rna sequencing. Nature 464, 768-772 (2010). <lb/>[20] Lappalainen, T. et al. Transcriptome and genome sequencing uncovers functional variation <lb/>in humans. Nature (2013). <lb/>[21] Sabatti, C. et al. Genome-wide association analysis of metabolic traits in a birth cohort <lb/>from a founder population. Nature genetics 41, 35-46 (2008). <lb/>[22] Segura, V. et al. An efficient multi-locus mixed-model approach for genome-wide associa-<lb/>tion studies in structured populations. Nature genetics 44, 825-830 (2012). <lb/>[23] Stegle, O., Lippert, C., Mooij, J. M., Lawrence, N. D. &amp; Borgwardt, K. M. Efficient <lb/>inference in matrix-variate gaussian models with\ iid observation noise. In Advances in <lb/>Neural Information Processing Systems, 630-638 (2011). <lb/>[24] Rakitsch, B., Lippert, C., Borgwardt, K. &amp; Stegle, O. It is all in the noise: Efficient <lb/>multi-task gaussian process inference with structured residuals 1466-1474 (2013). <lb/>[25] Chiba-Falek, O. et al. Pleiotropy and allelic heterogeneity in the tomm40-apoe genomic <lb/>region related to clinical and metabolic features of hepatitis c infection. Human Genetics <lb/>131, 1911-1920 (2012). <lb/></listBibl>

			<page>17 <lb/></page>

			<listBibl>[26] Waterworth, D. M. et al. Genetic variants influencing circulating lipid levels and risk of <lb/>coronary artery disease. Arteriosclerosis, thrombosis, and vascular biology 30, 2264-2276 <lb/>(2010). <lb/>[27] Glaus, P., Honkela, A. &amp; Rattray, M. Identifying differentially expressed transcripts from <lb/>rna-seq data with biological variation. Bioinformatics 28, 1721-1728 (2012). <lb/>[28] Stegle, O., Parts, L., Durbin, R. &amp; Winn, J. A Bayesian framework to account for complex <lb/>non-genetic factors in gene expression levels greatly increases power in eQTL studies. PLoS <lb/>Computational Biology 6, e1000770 (2010). <lb/>[29] Leek, J. T. &amp; Storey, J. D. Capturing heterogeneity in gene expression studies by surrogate <lb/>variable analysis. PLoS Genetics 3, e161 (2007). <lb/>[30] Storey, J. D. &amp; Tibshirani, R. Statistical significance for genomewide studies. Proceedings <lb/>of the National Academy of Sciences 100, 9440-9445 (2003). <lb/>[31] Parts, L., Stegle, O., Winn, J. &amp; Durbin, R. Joint genetic analysis of gene expression data <lb/>with inferred cellular phenotypes. PLoS genetics 7, e1001276 (2011). <lb/>[32] Arnold, I., Pfeiffer, K., Neupert, W., Stuart, R. A. &amp; Schägger, H. Yeast mitochondrial <lb/>f1f0-atp synthase exists as a dimer: identification of three dimer-specific subunits. EMBO <lb/>J 17, 7170-8 (1998). <lb/>[33] Manor, O. &amp; Segal, E. Robust prediction of expression differences among human individuals <lb/>using only genotype information. PLoS genetics 9, e1003396 (2013). <lb/>[34] Bickel, P. J. &amp; Levina, E. Regularized estimation of large covariance matrices. The Annals <lb/>of Statistics 199-227 (2008). <lb/>[35] Meyer, K. &amp; Kirkpatrick, M. Better estimates of genetic covariance matrices by &quot;bending&quot; <lb/>using penalized maximum likelihood. Genetics 185, 1097-1110 (2010). <lb/>[36] Listgarten, J. et al. A powerful and efficient set test for genetic markers that handles <lb/>confounding. Bioinformatics (2013). <lb/>[37] Wu, M. C. et al. Rare-variant association testing for sequencing data with the sequence <lb/>kernel association test. The American Journal of Human Genetics 89, 82-93 (2011). <lb/>[38] Tipping, M. E. &amp; Bishop, C. M. Probabilistic principal component analysis. Journal of <lb/>the Royal Statistical Society: Series B (Statistical Methodology) 61, 611-622 (1999). <lb/></listBibl>

			<page>18 <lb/></page>

			<listBibl>[39] Lawrence, N. D. Gaussian process latent variable models for visualisation of high dimen-<lb/>sional data. Advances in neural information processing systems 16, 3 (2004). <lb/>[40] Schölkopf, B. &amp; Smola, A. J. Learning with kernels: support vector machines, regulariza-<lb/>tion, optimization, and beyond (adaptive computation and machine learning) (2001). <lb/>[41] Rasmussen, C. E. Gaussian processes for machine learning (2006). <lb/>[42] Meyer, K. Estimating variances and covariances for multivariate animal models by re-<lb/>stricted maximum likelihood. Genet. Sel. Evol 23, 67-83 (1991). <lb/>[43] Patterson, H. D. &amp; Thompson, R. Recovery of inter-block information when block sizes <lb/>are unequal. Biometrika 58, 545-554 (1971). <lb/>[44] Henderson, C. R. Best linear unbiased estimation and prediction under a selection model. <lb/>Biometrics 423-447 (1975). <lb/>[45] Robinson, G. K. That blup is a good thing: The estimation of random effects. Statistical <lb/>Science 6, 15-32 (1991). <lb/>[46] Macgregor, S., Cornes, B. K., Martin, N. G. &amp; Visscher, P. M. Bias, precision and heri-<lb/>tability of self-reported and clinically measured height in australian twins. Human genetics <lb/>120, 571-580 (2006). <lb/>[47] Kanehisa, M. &amp; Goto, S. Kegg: kyoto encyclopedia of genes and genomes. Nucleic acids <lb/>research 28, 27-30 (2000). <lb/>[48] Langmead, B., Trapnell, C., Pop, M., Salzberg, S. L. et al. Ultrafast and memory-efficient <lb/>alignment of short dna sequences to the human genome. Genome Biol 10, R25 (2009). <lb/></listBibl>

			<div type="acknowledgement">Acknowledgements <lb/>The authors would like to thank Jennifer Listgarten, Leopold Parts, Andrew Brown and Amelie <lb/>Baud for comments on the manuscript. The NFBC1966 Study is conducted and supported by <lb/>the National Heart, Lung, and Blood Institute (NHLBI) in collaboration with the Broad Insti-<lb/>tute, UCLA, University of Oulu, and the National Institute for Health and Welfare in Finland. <lb/>This manuscript was not prepared in collaboration with investigators of the NFBC1966 Study <lb/>and does not necessarily reflect the opinions or views of the NFBC1966 Study Investigators, <lb/>Broad Institute, UCLA, University of Oulu, National Institute for Health and Welfare in Finland <lb/>and the NHLBI. O.S. was supported by a Marie Curie FP7 fellowship. <lb/></div>

			<page>19 <lb/></page>

			<div type="annex">Author contributions <lb/>C.L., F.P.C. &amp; O.S. designed the study, developed methods, analysed data and wrote the paper. <lb/>B.R. contributed to method development and wrote the paper. <lb/></div>

			<div type="annex">Competing financial interests <lb/>C.L. was employed at Microsoft while performing the research. <lb/></div>

			<div type="annex">Supplementary Information <lb/>Supplementary Tables <lb/> 1. Supplementary Table 1 Tabular summary of significant associations in the NFBC <lb/>datasets identified using alternative LMM methods. <lb/>2. Supplementary Table 2 Tabular summary of cis associations identified in the Geuvadis <lb/>dataset considering alternative multi-trait LMMs and tests. <lb/>3. Supplementary table 3 Tabular summary of the average variance contribution in yeast <lb/>pathways estimated using the variance decomposition model. <lb/>4. Supplementary table 4 Tabular summary of significant associations on the lysine bios. <lb/>yeast pathway. <lb/>Supplementary Figures <lb/>1. Supplementary Figure 1 Q−Q-plots for the multi-trait association tests on the NFBC <lb/>dataset. <lb/>2. Supplementary Figure 2 Sample covariance matrices used in mixed model analyses, <lb/>either estimated from genetic kinship or using the PANAMA model in the human eQTL <lb/>dataset. <lb/>3. Supplementary Figure 3 Power comparison among different trait design tests on the <lb/>human eQTL dataset. <lb/>4. Supplementary Figure 4 Distribution of genomic control for the cis eQTL association <lb/>analyses in the human eQTL dataset. <lb/>5. Supplementary Figure 5 Distribution of the relative position of eQTLs identified using <lb/>alternative multi-trait LMMs in the human eQTL dataset. <lb/></div>

			<page>20 <lb/></page>

			<div type="annex">6. Supplementary Figure 6 Power comparison of regularized and unregularized multi-<lb/>trait LMMs for the analysis of the lysine bios. pathway in the yeast eQTL dataset. <lb/>7. Supplementary Figure 7 Model selection approach to determine optimal regularization <lb/>of the multi-trait LMM applied to the lysine bios. pathway in the yeast eQTL dataset. <lb/>8. Supplementary Figure 8 Illustration of the step-wise inclusion of fixed effects used <lb/>for multi-trait multi-locus LMMs applied to the lysine bios. pathway in the yeast eQTL <lb/>dataset. <lb/>9. Supplementary Figure 9 Multi-trait LMM analyses of 24 genes in the glycine, s. and <lb/>t. metabolism pathway across two environments (48 traits) in the yeast eQTL dataset. <lb/>10. Supplementary Figurej 10 Assessment of alternative LMMs for out-of-sample predic-<lb/>tion on the NFBC dataset. <lb/>11. Supplementary Figure 11 Assessment of alternative LMMs for out-of-sample predic-<lb/>tion of genes in the lysine bios. pathway in the yeast eQTL dataset. <lb/>12. Supplementary Figure 12 Assessment of alternative LMMs for out-of-sample predic-<lb/>tion of isoform and gene expression levels in the human eQTL dataset. <lb/>Supplementary Notes <lb/>1. Supplementary Note 1: Supplementary Methods and additional theory. <lb/></div>

			<body>Figures <lb/></body>

			<page>21 <lb/></page>

			<body>b <lb/>a <lb/>CEACAM19 <lb/>CEACAM16 <lb/>TOMM40 <lb/>Friday, 7 February 14 <lb/>Figure 1 Multi-trait GWAS on four correlated phenotypes from the Northern Finish Birth <lb/>Cohort (NFBC1966) [21]. a, upper panel: Manhattan plot of P -values from an any effects test in <lb/>a multi-trait LMM. 34 SNPs have significant associations at 10 distinct loci (α = 5×10 −8 , λ G C = <lb/>0.99). lower panel: Manhattan plot showing the results of the novel multi-trait multi-locus LMM, <lb/>using an any effects test. 14 SNPs with distinct genetic signals are included, each marked with <lb/>a vertical bar. The numbered stars mark the P -values at the respective iteration of inclusion. <lb/>b, Example zoom-in for a region with two independent effects included in the multi-locus LMM. <lb/>Shown are several different association tests for the CEACAM-TOMM40 region before (upper <lb/>panel) and after (lower panel) inclusion of the lead SNP (step 5, rs2075650) into the multi-trait <lb/>multi-locus LMM. While SNPs that are associated purely due to LD to the primary associated <lb/>SNP become insignificant after inclusion, a secondary association locus around rs2919842 (step <lb/>13) becomes more significant, pushing it above the genome-wide significance threshold for the <lb/>any effect test (red) and the common effect test (black) (see also Supplementary Table 1). <lb/></body>

			<page>22 <lb/></page>

			<body>a <lb/>b <lb/>c <lb/>78 <lb/>2 <lb/>208 <lb/>42 <lb/>3 <lb/>1118 <lb/>8 <lb/>205 <lb/>179 <lb/>39 <lb/>1164 <lb/>875 <lb/>98 <lb/>138 <lb/>228 <lb/>Single−trait test <lb/>Any effect test <lb/>Specific effect test <lb/>Common effect test <lb/>d <lb/>PRR5L -Chromosome 11 <lb/>ENST00000378867 <lb/>ENST00000530639 <lb/>ENST00000527487 <lb/>Any effec test [PANMAA] <lb/>Any effec test [no PANMAA] <lb/>Saturday, March 8, 14 <lb/>Figure 2 Isoform-specific eQTL analysis in the human eQTL dataset [20], considering 9,246 <lb/>genes with at least two isoforms. a, Comparison of the number of genes with at least one <lb/>significant cis eQTL (1mb upstream or downstream of each gene) as a function of the permitted <lb/>false discovery rate (FDR) and for different association tests and models. Considered were an <lb/>independent association test on each isoform (single-trait test) and a multi-trait LMM using the <lb/>any effect test, both with and without accounting for hidden confounding factors (PANAMA). <lb/>b, Overlap of genes having at least one significant cis association at an FDR cutoff of 1% when <lb/>considering alternative tests in a multi-trait LMM: any effect tests, common effect tests and <lb/>(isoform-)specific effect tests. c, Number of independent cis eQTLs (at 1% FDR), identified using <lb/>the multi-locus multi-trait model, either with or without confounding correction (PANAMA). <lb/>Bar plots denote the cumulative number of genes with at least (1, 2, 3 or 4) distinct cis eQTLs. <lb/>d, Manhattan plot for a selected region around the gene PRR5L. The multi-trait multi-locus <lb/>LMM applied to the region identified two independent associations. upper panel: P -values from <lb/>an any effect test before inclusion of the lead SNP are shown in grey. P -values from an any effect <lb/>test after inclusion of the lead SNP (grey asterisk) are shown in pink. lower panel: P -values from <lb/>a common effect test and (isoform-)specific effect tests indicate that the lead association has a <lb/>gene-level effect whereas the secondary association is specific to one isoform (ENST00000527487). <lb/></body>

			<page>23 <lb/></page>

			<body>Total <lb/>frac)on <lb/>of+gene)c+ <lb/>variance <lb/>a <lb/>b <lb/>Figure 3 Variance component analysis of yeast gene expression levels in two environments [17]. <lb/>For each gene, an LMM with variance components for local cis effects, genome-wide trans effects, <lb/>environmental effects, and interaction effects between the environment and genetic variation <lb/>(GxE) in cis as well as trans was fitted. a, Average variance component estimates for all genes <lb/>grouped by the total proportion of variance explained by genetics (cis + trans). b, Average <lb/>variance estimates for components of genes in the top six KEGG pathways with the largest <lb/>average proportion of variance explained by GxE effects grouped by pathway membership; (cis <lb/>GxE + trans GxE). <lb/></body>

			<page>24 <lb/></page>

			<body>a <lb/>b <lb/>c <lb/>Figure 4 eQTL analysis of yeast gene expression in two environments [17], considering the <lb/>Lysine biosynthesis pathway. a, Power comparison of alternative multi-trait LMMs on 11 genes <lb/>in the pathway (22 measurements per sample). We considered an unregularized multi-trait <lb/>LMM (P -values on the x-axes) versus the corresponding results obtained from an optimally <lb/>regularized model (y-axes). Tests below the significance cutoff in both methods (Bonferroni <lb/>adjusted α = 0.05) are shaded out. b, Joint multi-trait GWAS on the 11 genes in the pathway <lb/>(22 measurements per sample). Upper panel: An any effect test finds 4 loci with significant <lb/>associations (Bonferroni adjusted α = 0.05). Lower panel: A multi-locus multi-trait LMM with <lb/>an any effect test identifies 10 SNPs with distinct genetic signals, each marked with a vertical <lb/>bar. The P -value at iteration of insertion is marked by an asterisk. Two of the ten SNPs <lb/>inserted also have a significant association in a joint test for gene-environment interaction effects <lb/>(iterations 2 and 8 in the multi-locus model, see Supplementary Figure 8). c, A single-gene <lb/>multi-locus LMMs, considering independent tests across genes but jointly across environments <lb/>(pairwise multi-trait) identified 5 out of the 10 loci found using the multi-trait multi-locus model, <lb/>and one additional association. <lb/></body>

			<page>25 <lb/></page>

			<body>ch 3, 14 <lb/>Figure 5 Prediction performance of alternative mixed models on the human eQTL dataset. <lb/>Comparison of single-trait (ST) and multi-trait (MT) LMMs by out-of-sample prediction of iso-<lb/>form expression levels (all 9,246 genes, 10 fold cross validation). Multi-locus LMMs consistently <lb/>achieved better prediction performance than the corresponding LMMs without fixed effects (ST <lb/>multi-locus vs ST &amp; MT multi-locus vs MT). On the whole, multi-trait LMMs predicted iso-<lb/>form levels more accurately than single-trait models. The combination of the multi-locus and <lb/>multi-trait LMM achieved best prediction performance overall. <lb/></body>

			<page>26 </page>


	</text>
</tei>
