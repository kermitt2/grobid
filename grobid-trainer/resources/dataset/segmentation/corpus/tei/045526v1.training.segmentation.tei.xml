<?xml version="1.0" ?>
<tei xml:space="preserve">
	<teiHeader>
		<fileDesc xml:id="0"/>
	</teiHeader>
	<text xml:lang="en">
			<front>fluff: exploratory analysis and visualization of <lb/>high-throughput sequencing data <lb/>Georgios Georgiou 1 and Simon J. van Heeringen 1,* <lb/>1 <lb/>Radboud University, Department of Molecular Developmental Biology, Faculty of Science, Radboud Institute for <lb/>Molecular Life Sciences, 6500HB Nijmegen, The Netherlands <lb/>*To whom correspondence should be addressed. <lb/>Abstract <lb/>Summary: Here we introduce fluff, a software package that allows for simple exploration, clustering and visualization of <lb/>highthroughput sequencing experiments. The package contains three commandline tools to generate publicationquality <lb/>figures in an uncomplicated manner using sensible defaults. Genomewide data can be aggregated, clustered and <lb/>visualized in a heatmap, according to different clustering methods. This includes a predefined setting to identify dynamic <lb/>clusters between different conditions or developmental stages. Alternatively, clustered data can be visualized in a <lb/>bandplot. Finally, fluff includes a tool to generate genomic profiles. As commandline tools, the fluff programs can easily <lb/>be integrated into standard analysis pipelines. The installation is straightforward and documentation is available at <lb/>http://fluff.readthedocs.org. <lb/>Availability: fluff is implemented in Python and runs on Linux. The source code is freely available for download at <lb/>https://github.com/simonvh/fluff. <lb/>Contact: s.vanheeringen@science.ru.nl <lb/></front>

			<body>Introduction <lb/>The advances in sequencing technology and the reduction of costs have led to a rapid increase of HighThroughput <lb/>Sequencing (HTS) data. Applications include chromatin immunoprecipitation followed by highthroughput deep <lb/>sequencing (ChIPseq) (Robertson et al. , 2007) to determine the genomic location of DNAassociated proteins, chromatin <lb/>accessibility assays (Buenrostro et al. , 2013 ; Hesselberth et al. , 2009) and bisulfite sequencing to assay DNA methylation <lb/>(Lister et al. , 2009) . The integration of these diverse data allow identification of the epigenomic state, for instance in <lb/>different tissues (Martens and Stunnenberg, 2013; Roadmap Epigenomics Consortium et al. , 2015) or during <lb/>development (Hontelez et al. , 2015) . However, the scale and complexity of these datasets call for the use of <lb/>computational methods that facilitate data exploration and visualization. <lb/>Various options exist to explore and visualize HTS data, for instance in aggregated form such as heatmaps and average <lb/>profiles. These include general purpose modules for specific programming languages (Huber et al. , 2015) , dedicated HTS <lb/>modules (Dale et al. , 2014) , commandline tools (Shen et al. , 2014) , web tools (Ramírez et al. , 2014) and standalone <lb/>applications (Ramírez et al. , 2014; Ye et al. , 2011) . Here, we present fluff, a Python package for visual HTS data <lb/>exploration. It includes commandline applications to both cluster and visualize aggregated signals in genomic regions, as <lb/>well as to create genome browserlike profiles. The scripts can be included in analysis pipelines and accept commonly <lb/>used file formats. The fluff applications are pitched at the beginner to intermediate user. They have sensible defaults, yet <lb/>allow for customizable creation of highquality, publicationready figures. <lb/>Program description and methods <lb/>General. The fluff module and commandline tools are implemented in Python. The package can be installed using pip or <lb/>the conda package manager. Detailed documentation, including tutorials, is available at http://fluff.readthedocs.org . All <lb/>fluff tools efficiently obtain reads from indexed BAM files and use read counts for visualization. Alternatively, the <lb/>RPKM measure can be specified (Reads Per Kb per Million reads). Duplicate reads (SAM flag 1024) and reads that map <lb/>to multiple locations (mapping quality 0) are removed by default. Where applicable, the scale of the Yaxis can be <lb/>adjusted individually, or per group of tracks to enable comparison. Colors can be specified by name, HEX code or using <lb/>ColorBrewer palettes. The format of the output figure is determined by the extension and all major formats (including <lb/>PNG, JPEG, SVG and PDF) are supported. <lb/>Heatmaps and bandplots. The input for fluff heatmap consists of a BED file with genomic coordinates, e.g. peaks from a <lb/>ChIPseq experiment, and one or more indexed BAM files. The features in the BED file are extended up and <lb/>downstream (default 5kb) from the center and divided into bins (default 100bp). The data can optionally be clustered <lb/>using either kmeans or hierarchical clustering. For clustering, the read counts in the bins are normalized to the 75 <lb/>percentile. The distance can be calculated using either the Euclidean distance or Pearson correlation similarity. If the <lb/>regions in the input BED file are not strandspecific, different clusters might represent the same strandspecific profile in <lb/>two different orientations. Clusters that are mirrored relative to the center can optionally be merged. Here, the similarity <lb/>is based on the chisquared pvalue of the mean profile per cluster. The data are plotted as heatmap where each row <lb/>represents a feature. Besides the figure, fluff returns as output the genomic regions (including the cluster number if they <lb/>were clustered) and the read counts, which can be used for further analysis. <lb/>One important use case for clustering is the ability to identify dynamic patterns, for instance during different time points <lb/>or conditions. For this purpose, clustering on the binned signal is not ideal. Therefore, fluff heatmap provides the option <lb/>to cluster genomic regions based on a single value derived from the number of reads in the feature centers (+/ 1kb). In <lb/>combination with the Pearson correlation metric, this allows for efficient retrieval of dynamic clusters. The difference is <lb/>illustrated in Supplementary Figures 1 and 2. <lb/>As an alternative to a heatmap, fluff bandplot plots the average profiles in small multiples. The median enrichment is <lb/>visualized as a black line with the 50th and 90th percentile as a dark and light colour respectively. The output from fluff <lb/>heatmap can directly be used in fluff bandplot . <lb/>Profiles. Genome browsers are unrivaled for data exploration and visualization in a genomic context. However, it can be <lb/>useful to create profiles of HTS data in genomic intervals using a consistent commandline tool, that can optionally be <lb/>automated. The fluff profile tool can plot summarized profiles from one or more BAM files, together with annotation <lb/>from a BED12formatted file. By default, all reads will be extended to 200 base pairs before creating the profiles. <lb/> Example results <lb/>To illustrate the functionality of fluff we visualized previously published ChIPseq data (Saeed et al. , 2014) . Here, the <lb/>epigenomes of human monocytes and in vitro-differentiated naïve, tolerized, and trained macrophages were analyzed, <lb/>with the aim to understand the epigenetic basis of innate immunity. Circulating monocytes (Mo) were differentiated into <lb/>three macrophages states: to macrophages (Mf), to longterm tolerant cells (LPSMf) by exposition to lipopolysaccharide <lb/>and to trained immune cells (BGMf) by priming with βglucan. We used fluff heatmap to cluster and visualize the signal <lb/>of histone 3 lysine 27 acetylation (H3K27ac), which is located at active enhancers and promoters (Fig. 1A). The input <lb/>consisted of a BED file with 7,611 differentially regulated enhancers and four BAM files, for each of the monocytes and <lb/>three types of macrophages (see Supplementary Data for details). Using kmeans clustering (k = 5) with the Pearson <lb/>correlation metric, the heatmap recapitulates the H3K27ac dynamics as described (Saeed et al. , 2014) . <lb/> Figure 1 . An example of the fluff output. All panels were generated by the fluff commandline tools and were not <lb/>postprocessed or edited. (A) Heatmap showing the results of kmeans clustering (k=5, metric=Pearson) of dynamic <lb/>H3K27ac regions in monocytes (Mo), naïve macrophages (Mf), tolerized (LPSMf) and trained cells (BGMf) (Saeed et <lb/>al. 2014). ChIPseq read counts are visualized in 100bp bins in 24kb regions. (B) Bandplot showing the average profile <lb/>(median: black, 50 percent: dark color, 90 percent: light color) of the clusters as identified in Fig. 1A. (C) The H3K27ac <lb/>ChIPseq profiles at the CNRIP1 gene locus, which shows a gain of H3K27ac in Mf, LPSMf and BGMf relative to Mo. <lb/>While heatmaps are often used for visualization of signals over genomic features, either clustered or ordered by signal <lb/>intensity, it can be difficult to distinguish relative levels of individual clusters. Figure 1B shows an alternative <lb/>visualization of average enrichment profiles in small multiples. The same clusters as in Fig. 1A are plotted using fluff <lb/>bandplot . Shown are the median (black line), along with the 50th (darker color) and 90th percentile (lighter color) of the <lb/>data. This allows for more detailed comparisons. <lb/>Finally, we illustrate fluff profile , which visualizes one more genomic regions (Fig. 1C). This figure highlights the <lb/>CNRIP1 gene from cluster 2, which shows a consistent increase of H3K27ac from Mo to Mf, LPSMf and BGMf. The <lb/>signal profiles are directly generated from the BAM files. <lb/>Conclusion <lb/>The analysis of multidimensional genomic data requires methods for data exploration and visualization. We provide <lb/>fluff, a Python package that contains several commandline tools to generate figures for use in high throughput <lb/>sequencing analysis workflows. We aim to fill the gap between powerful, flexible libraries that require programming <lb/>skills on the one hand, and intuitive, graphical programs with limited customization possibilities on the other hand. These <lb/>tools were developed based on a need for straightforward analysis and visualization of ChIPseq data and have been <lb/>successfully applied in a variety of projects (Menafra et al. , 2014; van den Boom et al. , 2016; Kouwenhoven et al. , <lb/>2015) . In conclusion, fluff helps to interpret genomewide experiments by efficient visualization of sequencing data. <lb/></body>

			<div type="funding">Funding <lb/>Funding: This work was supported by the Netherlands Organisation for Scientific Research (NWOALW) [863.12.002 to <lb/>S.J.v.H.]. G.G. was supported by the US National Institutes of Health (NICHD) [R01HD069344]. <lb/></div>

			<div type="annex">Conflict of Interest: none declared. <lb/></div>

			<div type="acknowledgement">Acknowledgments <lb/>This study makes use of data generated by the Blueprint Consortium. A full list of the investigators who contributed to <lb/>the generation of the data is available from www.blueprintepigenome.eu. Funding for the project was provided by the <lb/>European Union&apos;s Seventh Framework Programme (FP7/20072013) under grant agreement no 282510 BLUEPRINT. <lb/></div>

			<listBibl>References <lb/>van den Boom,V. et al. (2016) Noncanonical PRC1.1 Targets Active Genes Independent of H3K27me3 and Is Essential for Leukemogenesis. Cell <lb/>Rep. , 14 , 332-346. <lb/>Buenrostro,J.D. et al. (2013) Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNAbinding proteins <lb/>and nucleosome position. Nat. Methods , 10 , 1213-1218. <lb/>Dale,R.K. et al. (2014) metaseq: a Python package for integrative genomewide analysis reveals relationships between chromatin insulators and <lb/>associated nuclear mRNA. Nucleic Acids Res. , 42 , 9158-9170. <lb/>Hesselberth,J.R. et al. (2009) Global mapping of proteinDNA interactions in vivo by digital genomic footprinting. Nat. Methods , 6 , 283-289. <lb/>Hontelez,S. et al. (2015) Embryonic transcription is controlled by maternally defined chromatin state. Nat. Commun. , 6 , 10148. <lb/>Huber,W. et al. (2015) Orchestrating highthroughput genomic analysis with Bioconductor. Nat. Methods , 12 , 115-121. <lb/>Kouwenhoven,E.N. et al. (2015) Transcription factor p63 bookmarks and regulates dynamic enhancers during epidermal differentiation. EMBO Rep. , <lb/>16 , 863-878. <lb/>Lister,R. et al. (2009) Human DNA methylomes at base resolution show widespread epigenomic differences. Nature , 462 , 315-322. <lb/>Martens,J.H.A. and Stunnenberg,H.G. (2013) BLUEPRINT: mapping human blood cell epigenomes. <lb/>Haematologica , 98 , 1487-1489. <lb/>Menafra,R. et al. (2014) Genomewide binding of MBD2 reveals strong preference for highly methylated loci. PLoS One , 9 , e99603. <lb/>Ramírez,F. et al. (2014) deepTools: a flexible platform for exploring deepsequencing data. Nucleic Acids Res. , 42 , W187-91. <lb/>Roadmap Epigenomics Consortium et al. (2015) Integrative analysis of 111 reference human epigenomes. Nature , 518 , 317-330. <lb/>Robertson,G. et al. (2007) Genomewide profiles of STAT1 DNA association using chromatin immunoprecipitation and massively parallel sequencing. <lb/>Nat. Methods , 4 , 651-657. <lb/>Saeed,S. et al. (2014) Epigenetic programming of monocytetomacrophage differentiation and trained innate immunity. Science , 345 , 1251086. <lb/>Shen,L. et al. (2014) ngs.plot: Quick mining and visualization of nextgeneration sequencing data by integrating genomic databases. BMC Genomics , <lb/>15 , 284. <lb/>Ye,T. et al. (2011) seqMINER: an integrated ChIPseq data interpretation platform. Nucleic Acids Res. , 39 , e35. </listBibl>


	</text>
</tei>
