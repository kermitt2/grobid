<?xml version="1.0" ?>
<tei xml:space="preserve">
	<teiHeader>
		<fileDesc xml:id="0"/>
	</teiHeader>
	<text xml:lang="en">
			<front>Modeling Joint Abundance of Multiple Species Using Dirichlet <lb/>Process Random Effects <lb/>Devin S. Johnson 1 and Elizabeth H. Sinclair <lb/>Alaska Fisheries Science Center, National Marine Fisheries Service, NOAA, <lb/>Seattle, Washington, U.S.A. <lb/>May 30, 2016 <lb/>1 Email: devin.johnson@noaa.gov <lb/> 1 <lb/> Abstract <lb/>We present a method for modeling multiple species distributions simultaneously using Dirich-<lb/>let Process random effects to cluster species into guilds. Guilds are ecological groups of <lb/>species that behave or react similarly to some environmental conditions. By modeling latent <lb/>guild structure, we capture the cross-correlations in abundance or occurrence of species over <lb/>surveys. In addition, ecological information about the community structure is obtained as <lb/>a byproduct of the model. By clustering species into similar functional groups, prediction <lb/>uncertainty of community structure at additional sites is reduced over treating each species <lb/>separately. The method is illustrated with a small simulation demonstration, as well as an <lb/>analysis of a mesopelagic fish survey from the eastern Bering Sea near Alaska. The simula-<lb/>tion data analysis shows that guild membership can be extracted as the differences between <lb/>groups become larger and if guild differences are small the model naturally collapses all the <lb/>species into a small number of guilds which increases predictive efficiency by reducing the <lb/>number of parameters to that which is supported by the data. <lb/>Key words: Abundance, Dirichlet Process, Joint species distribution model, Multivariate, <lb/>occurence <lb/></front>

			<body>1 Introduction <lb/>In recent years there has been considerable development of methodology for modeling and <lb/>predicting abundance and occurrence of species of interest. Much of this development uses <lb/>a hierarchical framework for developing models to fit the complexities of the observed data <lb/>or natural abundance processes (Cressie et al., 2009; Royle and Dorazio, 2008; Hobbs and <lb/>Hooten, 2015). Some of these complexities may include: spatial and temporal dependence <lb/>(Carroll et al., 2010; Latimer et al., 2009; Johnson et al., 2013b; Thorson et al., 2015; Ward <lb/></body>

			<page>2 <lb/></page>

			<body>et al., 2010), nondetection of individuals at sampled sites (Dorazio and Connor, 2014; Royle, <lb/>2004), and zero-inflation (Johnson and Fritz, 2014). Many of these species distribution <lb/>models (SDMs) were used to make inference to a single species or one-at-a-time modeling if <lb/>community inference was desired. However, by not recognizing the fact that species interact, <lb/>use of single species models for making inference for community abundance and structure <lb/>can produce misleading results (Clark et al., 2014). Hence, new joint species distribution <lb/>models (JSDMs), which explicitly model species interactions (or, cross-correlation) have <lb/>recently been developed (e.g., Dorazio and Connor, 2014; Latimer et al., 2009; Thorson <lb/>et al., 2015). Herein, we propose a novel JSDM approach which models species interactions <lb/>through membership in a latent ecological guild (Simberloff and Dayan, 1991) or functional <lb/>group within the sampled range of habitats. <lb/>Typically, description of an abundance model begins with a GLM structure for the abun-<lb/>dance process using a discrete value distribution such as Poisson or negative-binomial. For <lb/>example one might model the abundance as a Poisson observation with log-mean being a <lb/>function of covariates that might include habitat variables or variables related to the sampling <lb/>procedure which are thought to be related to the observed abundance. Alternatively, one <lb/>might log transform the abundance and use Gaussian linear models (Johnson et al., 2013b; <lb/>Johnson and Fritz, 2014; Ward et al., 2010), but the general mean structure is usually the <lb/>same. Herein, we will focus on the GLM versions. The focus of the abundance modeling is <lb/>related to either establishing an ecological relationship between (joint) abundance and the <lb/>environmental covariates or predicting abundance at unsampled locations. <lb/>To extend the single species GLM oriented model to account for interactions of multiple <lb/>species and improve prediction and inference of community structure and joint abundance, <lb/>there have been several approaches which differ in the details of interaction modeling, but <lb/>all fit the GLM framework by adding random effects which are either directly correlated <lb/></body>

			<page>3 <lb/></page>

			<body>between species (Clark et al., 2014; Dorazio and Connor, 2014; Latimer et al., 2009) or when <lb/>marginalized from the (log-linear) model imply a cross-species correlation structure (Thorson <lb/>et al., 2015). The direct approach of using a free parameter for every pair of species when <lb/>modeling the species-level correlation has been successfully implemented (Clark et al., 2014; <lb/>Latimer et al., 2009), however, in those studies there were a high number of sights sampled <lb/>or a low number of species considered. In other studies, unstructured covariance did not <lb/>produce reliable results (Dorazio and Connor, 2014). Thus, recent efforts to contribute novel <lb/>methodology for JSDMs have focused on reducing the number of parameters used to model <lb/>species interactions. Dorazio and Connor (2014) used a known species trait proximity matrix <lb/>to model the species-level covariance matrix using a spatial correlation function. By using the <lb/>known information on species similarity there are only two parameters necessary to model <lb/>the cross-correlation. Another low complexity approach has been proposed by Thorson et al. <lb/>(2015) using linear combinations of latent random effects. Specifically, the latent effects are <lb/>spatial fields, but the same methodology could be applied using independent random effects. <lb/>If the number of random effects is small relative to the number of species modeled, the <lb/>number of parameters necessary for modeling species cross-correlation can be significantly <lb/>reduced from the unstructured scenario. <lb/>As a novel alternative, we propose an JSDM that uses latent ecological guilds to model <lb/>interactions among species and obtain joint abundance inference. Herein, we also consider <lb/>joint species occurrence as well, where occurrence is defined as the binary presence (i.e., <lb/>abundance &gt; 0) or absence (abundance = 0) of a species. Dorazio and Connor (2014) used <lb/>known guild membership of different species to model independence of some species in a <lb/>cross-correlated JSDM. Simberloff and Dayan (1991) defines an ecological guild to be &quot;a <lb/>group of species that exploit the same class of environmental resources in a similar way.&quot; <lb/>With this definition in mind, we seek to build a model where species are cross-correlated in <lb/></body>

			<page>4 <lb/></page>

			<body>abundance because there are unknown group effects for some set of covariates, i.e., if the <lb/>group (guild) structure was known they could be represented by (group × covariate) inter-<lb/>action terms in the abundance GLM models. To accomplish this task we format the model <lb/>as a latent class or mixture model (see McLachlan and Peel, 2004). Mixture models or latent <lb/>class models are often used to model dependance between variables in a nonparametric fash-<lb/>ion because for a sufficiently large number of groups, marginalizing over the random latent <lb/>classes can approximate any dependence structure to whatever degree desired (McLachlan <lb/>and Peel, 2004; Vermunt et al., 2008). It has been shown that this holds even when the <lb/>conditional models are independent given group membership (Dunson and Xing, 2009). In <lb/>an ecological abundance context, finite mixture models have been used in the past to model <lb/>spatial heterogeneity and correlation in a nonparametric fashion (Dorazio et al., 2008; John-<lb/>son et al., 2013b). In this paper we take inspiration from nonparametric dependence methods <lb/>used for spatial association and apply it to species interaction in abundance modeling. <lb/>In the following section we describe the general infinite mixture framework using latent <lb/>classes and describe the Dirichlet Process (DP) for modeling class membership and the <lb/>number of classes. There are several choices of models for number and assignment of latent <lb/>classes, but we utilize the DP due to its long history and good clustering properties (Casella <lb/>et al., 2014). Parameter estimation in the DP-JSDM is challenging due to the latent class <lb/>process. We provide a reversible-jump MCMC (RJMCMC; Green 2003) algorithm for making <lb/>Bayesian inference. Finally, we apply the method to few simulated data sets, as well as, a <lb/>real data set on mesopelagic fish communities in the eastern Bering Sea, Alaska. <lb/></body>

			<page>5 <lb/></page>

			<body>2 Methods <lb/>2.1 General model framework <lb/>We begin the description of the proposed methods with some notation. First we assume there <lb/>are J surveys, for which abundance (or count index; hereafter we use the term &quot;counts&quot;) of <lb/>I different species is measured. Let n ij be the observed count for ith species in survey j. We <lb/>also use the vector notation n i = (n i1 , . . . , n iJ ) and n = (n 1 , . . . , n I ) for the n ij , as well as, <lb/>other quantities described later. For occurrence modeling we denote occurrence as y ij = 1 if <lb/>n ij &gt; 0 otherwise y ij = 0. In practice, n ij need not necessarily be observed for occurrence <lb/>modeling. The notation y i and y are similar to the abundance counterparts. <lb/>For abundance modeling, there are several possible distributions that could be used to <lb/>model the observed discrete counts, Poisson, negative binomial, zero-inflated Poisson, etc., so <lb/>we will generically denote this observation model as [n ij |z ij , γ] where z ij is a latent Gaussian <lb/>variable controlling the level of expected abundance and γ is a set of, possibly nuisance, <lb/>parameters. The notation &quot;[A|B]&quot; refers to the conditional distribution of A given B. For <lb/>example, if a Poisson distribution is used <lb/>[n ij |z ij , γ] = Poisson(n ij |e z ij ), <lb/>(1) <lb/>and γ is not necessary. In the example analysis of mesopelagic fish surveys we utilize a <lb/>zero-inflated Poisson (ZIP) model, so, <lb/>[n ij |z ij , γ] = γ ij 1 [n ij =0] + (1 − γ ij )Poisson(n ij |e z ij ), <lb/>(2) <lb/>the additional γ ij parameter is the mixing probability for the extra zeros. For occurrence <lb/>modeling we use <lb/>[y ij |z ij ] = Bernoulli(Φ −1 {z ij }), <lb/>(3) <lb/></body>

			<page>6 <lb/></page>

			<body>where Φ(•) is the standard normal CDF, that is, a probit link function. <lb/>To account for unknown interspecies correlations we take a clustering approach inspired <lb/>by the analysis of Johnson et al. (2013b) for incorporating spatial structure when there <lb/>are no reasonable distance metrics or neighborhood groupings are unknown. The model is <lb/>constructed by envisioning an unknown partition, p, of the species into κ p groups such that <lb/>species within groups (clusters) behave similarly with respect to the abundance process. For <lb/>a given p, we model (in vector form) the latent z process with the linear model <lb/>[z|p, δ p , β, σ] = N (Xβ + K p δ p , Σ), <lb/>(4) <lb/>where <lb/>• X is a design matrix of covariates for which there are no group-level effects, <lb/>• β is a vector of regression coefficients, <lb/>• K p = C p ⊗ H, where C p is an I × κ p binary matrix indicating which species belong <lb/>to each group in p and H is a J × q matrix of q habitat covariates recorded at the jth <lb/>survey, <lb/>• δ p = (δ 1 , . . . , δ κp ) is a vector of normally distributed random effects, where, [δ k |Ω] = <lb/>N (0, Ω), for k = 1, . . . , κ p . <lb/>• Σ is a diagonal matrix with entries σ 2 <lb/>ij (for occurance modeling σ ij = 1). <lb/>To reduce the parameter complexity of the proposed model we suggest the following for <lb/>general practice: <lb/>(i) for abundance models, set σ = diag(Σ 1/2 ) = exp{Lθ}, where L is a matrix of design <lb/>covariates and <lb/>(ii) set Ω = ω 2 (H H) −1 , where ω = exp(ξ). <lb/></body>

			<page>7 <lb/></page>

			<body>With respect to (i), there are some useful special cases, namely, L = 1 gives σ ij = σ and <lb/>L = I I ⊗ 1 J gives σ ij = σ i . However, the overdispersion parameters could also be modeled <lb/>based on covariates associated with sampling methods, etc. Suggestion (ii) was formulated <lb/>from the covariances of the g-prior (Tiao and Zellner, 1964). The g-prior, N (0, ω 2 (H H) −1 ), <lb/>is an often used prior for regression coefficient parameters. It has the nice benefit that, with <lb/>a single parameter, it automatically controls the scale of variance and covariance for each <lb/>coefficient based on the scale of the covariates and their cross-correlation. The exponential <lb/>reparameterization is used for ease of inference, that is ξ can be unconstrained. <lb/>The previous description assumed that the correct partitioning of the species is known, <lb/>however, for most real data sets, the correct partition is unknown. Thus, we must also pro-<lb/>vide a probability model over partitions, [p|α], such that marginalization over the unknown <lb/>partitions creates random coefficient vectors that are nonparametric in their distribution. <lb/>A commonly used distribution over partitions is the Chinese Restaurant Process (CRP) a <lb/>finite number of individuals to an unknown number of groups is described as follows, for a <lb/>given parameter α &gt; 0, <lb/>1. A customer enters the restaurant and sits at one of an infinite number of tables. <lb/>2. The next customer enters and chooses to sit at the occupied table with probability <lb/>1/(1 + α) or a new table with probability α/(1 + α). <lb/>3. In general,the i + 1 customer sits at an occupied table with probability proportional to <lb/>the number of customers already seated or chooses an unoccupied table with probability <lb/>proportional to α. <lb/>Under the CRP model individuals are exchangeable, i.e., individuals join clusters based only <lb/>on how many other individuals are in the cluster, not who else is in the cluster. This fact <lb/>forms the basis for Bayesian inference for the CRP model via MCMC (Neal, 2000). The <lb/></body>

			<page>8 <lb/></page>

			<body>density function for the CRP cluster model is given by, <lb/>[p|α] = CRP(α) ∝ <lb/>Γ(α) <lb/>Γ(α + I) <lb/>α κp <lb/>κp <lb/>k=1 <lb/>(g pk − 1)!, <lb/>(5) <lb/>where g pk is the size of the kth cluster (group) in p. Note, that the distribution of p is only <lb/>a function of the number and sizes of the groups. Realizations of p with the same number <lb/>of groups and groups sizes have the same probability regardless of which individuals fall in <lb/>which cluster. <lb/>The Dirichlet process is connected to the CRP process because a DP process is con-<lb/>structed using the same procedure to seat the guests in the CRP model. Specifically, in <lb/>terms of (4), let δi be the coefficient associated with the ith species, that is δi = <lb/>κp <lb/>k=1 C ik δ k , <lb/>where C ik is the (i, k) entry of the C p matrix. Now, if δi follows a DP then, conditionally, <lb/>[ δi | δ1 , . . . , δi−1 , α, Ω] = <lb/>α <lb/>α + i − 1 <lb/>N (0, Ω) + <lb/>u i <lb/>k=1 <lb/>n k <lb/>α + i − 1 <lb/>δ k , <lb/>(6) <lb/>where u i is the number of unique values, δ k , of δi i = 1, . . . , i − 1, and n k is the number <lb/>of species 1 through i − 1 belonging to group k. In other words, a new table is represented <lb/>by a new value of δ k . Thus, the CRP partitioning combined with the δ realizations for each <lb/>group implies that [ δi |α, Ω] = DP(α, Ω). <lb/>Like the spatial covariance model use by Dorazio and Connor (2014), the DP-JSDM <lb/>also marginally possesses generally positive cross-covariance structure. This makes intuitive <lb/>sense as one is clustering similar species together or, if species are dissimilar, allowing them <lb/>to be independent. The covariance structure of the DP-JSDM can be derived by forming an <lb/>intercept random effect, η = K p δ p , such that z = Xβ + η + , where [ ] = N (0, Σ). Then, <lb/>conditioning on the cluster assignment, the covariance matrix of the random effect η is, <lb/>Var(η|p) = C p C p ⊗ HΩH , <lb/>(7) <lb/></body>

			<page>9 <lb/></page>

			<body>and the marginal variance is given by the mixture, <lb/>Var(η) = <lb/>p <lb/>C p C p [p|α] ⊗ HΩH = Ψ ⊗ HΩH , <lb/>(8) <lb/>where Ψ is a matrix with (i, i ) entries equal to the probabilities that species i shares a guild <lb/>with species i . We term the Ψ matrix to be the species proximity matrix due to the fact <lb/>that is forms a distance, of sorts, in the guild space of the species. Although, the covariance <lb/>is never negative between any two species, it can be zero, thus those species that occupy <lb/>different guilds will have uncorrelated η random effects, i.e., if ψ ii ≈ 0, then Cov(η ij , η i j ) <lb/>≈ 0. <lb/>It should be noted, however, that although the covariance of the η random effect is <lb/>generally, positive, that does not mean that there are only &apos;positive&apos; (or zero) relationships <lb/>between species. The clustering is based on the relationship each species has with the chosen <lb/>covariates. For example, one species may react positively along a covariate gradient (δ i &gt; 0) <lb/>and another reacts negatively along that same gradient (δ i &lt; 0), therefore if a new site has <lb/>a high level of this covariate, the first species will be predicted to be relatively abundant, <lb/>while the other species prediction will be lower. <lb/>2.2 Bayesian inference <lb/>Because of the hierarchical and variable dimensional nature of the parameter space of the <lb/>DP-JSDM model we employ a Bayesian approach via MCMC (Markov Chain Monte Carlo) <lb/>for model fitting and inference. The posterior distribution of interest is given by <lb/>[z, p, δ p , β, ω, σ|n] ∝ [n|z] [z|β, δ p , σ] <lb/>× [δ p |ω, p] [p|α] [ω] [σ] [β] [α], <lb/>(9) <lb/>where [ω], [σ], [β], and [α] are the prior distributions for the parameters. <lb/></body>

			<page>10 <lb/></page>

			<body>There are several derived parameters which may be of interest for making desired eco-<lb/>logical inference. First, are predictions of community abundance rates at new locations or <lb/>times. Second, one may be interested in the overall effect of the environmental covariates for <lb/>a particular species represented by δi . Finally, the matrix C p C p is an I × I indicator that a <lb/>species is in the same guild (associated with) another species. The posterior mean of C p C p <lb/>provides estimated guild proximity matrix, Ψ. Finally, the number of guilds, κ p (number of <lb/>columns in C p ) may be of interest. <lb/>The most direct way to make inferences on the proposed hierarchical clustering model is <lb/>through a reversible-jump Markov chain Monte Carlo (RJMCMC) algorithm (Green, 2003) <lb/>to sample the posterior distribution of the parameters and clustering assignment. Here, we <lb/>provide an overview of the RJMCMC, additional details of the sampler are given in Appendix <lb/>A. <lb/>In our description, we will assume the following prior distributions for the parameters: <lb/>[β] = N (µ β , Σ β ), [δ p |ω, p] = N (0, I κp ⊗ ω 2 Q), <lb/>[ω] = HT (φ ω , d ω ), [σ] = HT (φ σ , d σ ) <lb/>[p|α] = CRP(α), and [α] = G(a, b), <lb/>where I κp is an identity matrix of size κ p , Q is a known positive-definite matrix, HT (φ, d) <lb/>represents a scaled half-t distribution with scale parameter φ and d degrees of freedom, and <lb/>G represents a gamma distribution with parameters a and b. For most of these parameters, <lb/>the priors can be adjusted to whatever distribution the user would like, the trade-off being a <lb/>Metropolis-Hastings (MH) update instead of a Gibbs step (e.g., for β) or no difference at all <lb/>if the parameter has to be updated with an MH step to begin with (ω, σ, and α). However, <lb/>the normal [δ p |ω, p] prior is necessary to the proposed RJMCMC algorithm. Although, the <lb/>known Q is not necessary. This is not as critical as it sounds as the marginal distribution is <lb/></body>

			<page>11 <lb/></page>

			<body>still a nonparametric DP process we just require that the base distribution be a multivariate <lb/>normal. <lb/>The majority of the proposed RJMCMC algorithm is a standard Metropolis-within-Gibbs <lb/>(hybrid) sampler for a GLM-like model (e.g., zero-inflated models might also be considered <lb/>for the abundance distributions). Conditioned on a realization of p, all the other parameters <lb/>can be updated with a traditional MH step or a Gibbs step. Hence, we do not focus on their <lb/>updates here (see Appendix A). However, to update p, the dimension of the δ p vector will <lb/>potentially change, necessitating the trans-dimensional aspect of the RJMCMC. Naively, the <lb/>trans-dimensional moves require a joint (p, δ p ) proposal which can be rejected often if one of <lb/>those quantities is a bad fit for the current state of the remaining parameters even though the <lb/>other is acceptable. Second, proposing new p such that the MCMC chain will mix well over <lb/>the space of partitions is itself challenging. Because we are assuming that [z|β, δ p , σ] and <lb/>[δ p |ω, p] are multivariate normal, the first problem can be handled with the partial-analytic <lb/>RJMCMC method proposed by Godsill (2001) and utilized by Johnson and Hoeting (2011) <lb/>and Johnson et al. (2013b) in similar trans-dimensional MCMC applications. The partial-<lb/>analytic method allows proposing new model (p in this case) without jointly proposing the <lb/>associated model specific parameters (δ p ) because they can be analytically marginalized. <lb/>This is a special case of a collapsed Gibbs sampler (Van Dyk and Park, 2008). <lb/>To produce efficient moves through cluster (guild) space we use the the &quot;individual links&quot; <lb/>definition of the the CRP process proposed by Blei and Frazier (2011) and subsequently used <lb/>by Johnson et al. (2013b) for clustering spatial abundance trends. The links version of the <lb/>CRP process is constructed as follows: <lb/>1. A customer enters the restaurant and sits at one of an infinite number of tables. <lb/>2. The next customer enters and chooses to sit with the first customer with probability <lb/>1/(1 + α) or a new table with probability α/(1 + α). <lb/></body>

			<page>12 <lb/></page>

			<body>3. In general, upon entering the restaurant, the i + 1 customer sits with a previous cus-<lb/>tomer (not a table) with probability proportional to 1 or the new customer sit by <lb/>himself (self-links) with probability proportional to α. <lb/>4. Groups are constructed by collecting all cliques of the mathematical graph formed by <lb/>the links between customers. <lb/>Blei and Frazier (2011) show that this definition of the CRP process is equivalent to the <lb/>traditional definition presented previously. However, MCMC sampling is now based on <lb/>sampling independent links between individuals. In terms of the multiple species model, let <lb/>i ∈ {1, . . . , i} be the link for the ith species. The full conditional distribution of i is, <lb/>[ i |•] ∝ [z|β, δ p , σ] [δ p |ω, p] [ i |α], <lb/>(10) <lb/>where p is the partition constructed from all i and , <lb/>[ i |α] = <lb/>α1 { i =i} + 1 { i &lt;i} <lb/>1 + α <lb/>, <lb/>(11) <lb/>and 1 {•} is an indicator function for the condition in the brackets. It would be tempting to <lb/>sample from this discrete distribution in Gibbs fashion, however, note that it depends on δ p <lb/>which may be of different dimension under a different value of i . We can collapse over δ p <lb/>and use the marginal distribution <lb/>[ i |z, β, σ, ω, α] = [z|β, δ p , σ] [δ p |ω, p] [ i |α] dδ p <lb/>= [z|β, σ, ω, p] [ i |α] <lb/>∝ N (z|Xβ, K p (I κp ⊗ ω 2 Q)K p + Σ) [ i |α], <lb/>(12) <lb/>which does not depend on δ p . This approach was used by Johnson and Hoeting (2011) and <lb/>Johnson et al. (2013b), however, we found that for a large number of species and samples, <lb/>the covariance matrix K p (I κp ⊗ ω 2 Q)K p + Σ may be quite large and the inversion necessary <lb/></body>

			<page>13 <lb/></page>

			<body>to evaluate the [ i |z, β, σ, ω, α] for each species and potential link would make the chain <lb/>prohibitively slow in practice. So, we sought an alternative formulation of the marginal <lb/>distribution that did not require inversion of such a large covariance matrix. Using Laplace&apos;s <lb/>method (see Kass and Raftery 1995, Section 4.1) we can write <lb/>[z|β, σ, ω, p] = [z|β, δ p , σ] [δ p |ω, p] dδ p <lb/>= (2π) κp/2 | V p | −1/2 • N ( δp |0, I κp ⊗ ω 2 Q) • N (z|Xβ + K p δp , Σ), <lb/>(13) <lb/>where V p = K p ΣK p + (I κp ⊗ ω −2 Q −1 ) and δp = V −1 <lb/>p (K p Σ −1 (z − Xβ)), which are re-<lb/>spectively the inverse covariance and mean for the Gaussian full conditional distribution <lb/>[δ p |z, β, σ, ω, p]. This is the same distribution used to update δ p with a Gibbs step following <lb/>an update of p. Normally, Laplace&apos;s method produces an approximation to the integral, but <lb/>in this case the approximation is exact because the log integrand is quadratic in δ p (Goutis <lb/>and Casella, 1999). By writing the integral in this way we need only invert Σ, which is diag-<lb/>onal, and Q because (I κp ⊗ ω 2 Q) −1 = I κp ⊗ ω −2 Q −1 . If we use Q = (H H) −1 as previously <lb/>suggested, then the inverse is trivial. Because, [ i |z, β, σ, ω, α] is relatively cheap to evalu-<lb/>ate for each i = 1, . . . , i we can use a Gibbs step and draw from the discrete distribution <lb/>[ i |z, β, σ, ω, α] for each i = 1, . . . , I, with [z|β, σ, ω, p] evaluated using (13) instead of (12). <lb/>3 A Simulation Proof-of-Concept <lb/>To examine the ability of the CRP cluster model to make inference to species interaction, as <lb/>well as, to make joint community abundance predictions, we tested the model and RJMCMC <lb/>sampler with a small group of simulated data sets. In analyzing the simulated data our <lb/>objective was to assess whether the DP-JDSM model would, in practice, produce generally <lb/>correct estimates of the guild structure. Second, would the DP-JSDM exhibit the expected <lb/>behavior that as ω becomes small, the number of guilds (groups) estimated will go to one as <lb/></body>

			<page>14 <lb/></page>

			<body>the functional differences between the guilds (with respect to the variables in H) becomes <lb/>insignificant. <lb/>3.1 Simulation and Analysis <lb/>Data were simulated for I = 20 species, J = 35 samples, and κ p = 5 groups. Six data sets <lb/>were simulated corresponding to ω equal to 0.25, 0.5, 0.75, 1, 1.5, and 2. While the true <lb/>number of groups is always technically equal to five, the practical differences between the <lb/>groups tends to zero as ω becomes smaller. The group sizes were g pk = 7, 5, 4, 3, and 1. <lb/>Three environmental variables composing the guild design matrix H were generated from a <lb/>standard normal distribution. In addition, a single survey effort variable, x was generated to <lb/>adjust overall abundance measurement. The global design matrix was set to X = [1, x, H x ], <lb/>where H x = [H | . . . |H ] , that is, H matrix is concatenated I times over species. Thus, <lb/>δ p denotes guild differences from the overall global effect of the environmental variables, <lb/>H. In order to maintain identifiability, we imposed the constraint that <lb/>κp <lb/>k=1 δ k = 0. The <lb/>global coefficient was set to β = (2, 1, 0, −1, 0.5) and each δ k ; k = 1, . . . , 5, was drawn <lb/>from N (0, ω 2 H H). In these simulations all σ ij = 0, therefore, z ≡ Xβ + K p δ p . However, <lb/>a common σ was estimated in each analysis using a Poisson observation model, that is, <lb/>[n ij |z ij ] = Poisson(e z ij ). <lb/>The prior distributions used were the same as specified in Section 2.2, specifically, <lb/>• [β]: µ β = (μ 0 , 0, 0, 0) and μ0 is the log of the mean observed count and Σ β = <lb/>100(X X) −1 . <lb/>• [ω]: φ ω = 1 and d ω = 1 which implies a half-Cauchy prior distribution. <lb/>• [σ]: φ σ = 1 and d σ → ∞ which implies a half-normal prior distribution. <lb/>• [α]: a = 0.258 and b = 0.038. <lb/></body>

			<page>15 <lb/></page>

			<body>The prior distribution parameters for the gamma distribution [α] were chosen based upon the <lb/>method of Dorazio (2009) with one alteration. Dorazio (2009) used the method to choose a <lb/>and b such that the prior distribution over the number of groups was approximately uniform, <lb/>that is, [κ p ] ≈ 1/I, κ p = 1, . . . , I. However, we agree with the philosophy of Casella et al. <lb/>(2014) that a priori we should prefer fewer groups, therefore, using the same optimization <lb/>approach as Dorazio (2009), we chose a and b such that, approximately, [κ p ] ∝ 1/κ p . So, all <lb/>else being equal, a smaller number of groups is a priori preferred. <lb/>For each of the six simulated datasets, we sampled the posterior distribution (9) using <lb/>the RJMCMC algorithm detailed in Appendix A. Each sample consisted of 50,000 iterations <lb/>following a burnin of 10,000 iterations. We created the multAbund 2 package for the R sta-<lb/>tistical environment (R Development Core Team, 2015) which contains the code to run the <lb/>RJMCMC algorithm described in Appendix A. <lb/>3.2 Simulation results <lb/>As expected, when ω became small the DP-JSDM model was not able to distinguish guild <lb/>differences between the species and essentially estimated one single group (Figure 1 ω = <lb/>0.25). As ω increased and guild differences became apparent the model was able to separate <lb/>the species into their respective guilds reasonably well (Figure 1). In addition, as ω became <lb/>large the precision with which the number of guilds was estimated increased as well (Figure <lb/>2). There may be some bias as a few of the simulation runs produced κp = 6 (Figure 2; <lb/>ω = 1 and 2), however, a full simulation experiment would be necessary to assess that fact. <lb/></body>

			<note place="footnote">2 Available from github at: https://github.com/dsjohnson/multAbund. The package can be installed <lb/>from within an R session using the devtools package, but users need to be able to compile source code on <lb/>their platform as the multAbund package uses C++ code in its routines. <lb/></note>

			<page>16 <lb/></page>

			<body>4 Example: Mesopelagic fish abundance <lb/>4.1 Data <lb/>In our next demonstration of the DP-JSDM we analyze community structure and abundance <lb/>of fishes that migrate diurnally between three mesopelagic depths in the eastern Bering Sea <lb/>near Alaska. The tendency for most mesopelagic species to vertically migrate makes them an <lb/>important trophic link between the deep scattering layer and upper surface waters (Sinclair <lb/>et al., 2015) yet, fundamental aspects of multi-species distributions and relative abundances <lb/>have not been previously described. <lb/>The field effort identified three primary sample stations over highly productive areas of <lb/>the eastern Bering Sea pelagic (Figure 3). In the summers of 1999 and 2000 a total of 29 <lb/>daytime and 16 nighttime trawls were conducted at three depths (250, 500, and 1000 m) <lb/>during a narrow sampling period. Four of these trawls were not analyzed due to technical <lb/>difficulties in the field and we discarded them, resulting in J = 41 samples. Trawls were run <lb/>at-depth for 15-90 minutes resulting in collections of over 50,000 individuals representing 55 <lb/>species of fish and squid. Essentially, each individual trawl sample represents a community <lb/>as influenced by depth and time of day. Here we will demonstrate the DP-JSDM using <lb/>I = 20 of the relatively most common fish species (as opposed to squids, etc.). <lb/>The variables we put in the H design matrix reflect the belief that the species segre-<lb/>gate into guilds based on diurnal vertical migration characteristics. So, the guild covariates <lb/>recorded for each trawl are daylight cycle (day or night) and depth category (250m, 500m, <lb/>or 1000m). Here we used the full interaction model to define the H design matrix (i.e., &apos;∼ <lb/>cycle*depth&apos; in R language model syntax). Because the duration of the trawl varied from <lb/>survey to survey, the duration was included in the X matrix to model the overall abundance <lb/>of fish caught in the trawl. <lb/></body>

			<page>17 <lb/></page>

			<body>4.2 Model and analysis <lb/>Initial attempts at fitting a DP-JSDM proceeded in the same manner as the analysis of the <lb/>simulation data in the previous section. Namely, we used the same Poisson model for the <lb/>observed abundance counts. However, after initial fittings it became evident that the trawl <lb/>data set possessed a significant level of zero-inflation relative to the Poisson distribution. <lb/>This is likely due to the spatial patchiness of pelagic fish occurrence distributions (Benoit-<lb/>Bird and Au, 2003). In addition, there may also be detection issues in the survey such that <lb/>a zero count in the trawl does not necessarily mean absence of the species. However, unlike <lb/>Dorazio and Connor (2014) we do not have replicated surveys in which to separate detection <lb/>and absence. Therefore, we utilized a zero-inflated Poisson (ZIP) model in place of a Poisson <lb/>GLM. The ZIP model used for this analysis is <lb/>[n ij |z ij , γ i ] = γ i 1 [n ij =0] + (1 − γ i )Poisson(n ij |e z ij ), <lb/>(14) <lb/>where 1 [n ij =0] is an indicator of a zero count and γ i is a species-specific zero-inflation mixture <lb/>[logit γ i ] = T (φ γ , d γ ), <lb/>(15) <lb/>with scale parameter φ γ = 1.5 and degrees of freedom d γ = 6. This prior results in the <lb/>translated prior for γ i that is approximately uniform in (0,1). For the remaining parameters <lb/>we used the same prior specification as the simulated data analysis of Section 3.1. <lb/>To assess if there is any improvement gained by using the DP-JSDM we also fitted the <lb/>&apos;independent species&apos; JSDM, that is κ p = I, to the data. The JSDM we fitted was did not <lb/>truly treat each species independently because there are shared terms in the X design matrix <lb/>(trawl duration) but it allows us to assess improvement in classifying animals into functional <lb/>guilds relative to cycle and depth over treating them separately. To ascertain the magnitude <lb/>of improvement we would have liked to be able to use the &apos;leave one out&apos; Bayesian predictive <lb/></body>

			<page>18 <lb/></page>

			<body>information criterion (BPIC) given by <lb/>−2 BPIC = −2 <lb/>i,j <lb/>E{log[n ij |n −(i,j) , z −(ij) , γ, β, δ p , p, σ, ω, α]} <lb/>= −2 <lb/>i,j <lb/>E{log[n ij |n −(i,j) , z −(ij) , γ]} <lb/>(16) <lb/>where n −(i,j) is a vector of all observed data except n ij and log[n ij |n −(i,j) , γ, β, δ p , p, σ, ω, α] <lb/>is the log posterior predictive density for the (i, j)th observation. However, it would be com-<lb/>putationally infeasible to rerun the RJMCMC for every left out (i, j) entry. So, we used the <lb/>&apos;Widely Applicable Information Criterion&apos; (WAIC; Watanabe (2013)) as an approximation <lb/>(Watanabe, 2010; Link and Sauer, 2016) to −2 BPIC, where <lb/>WAIC = −2 <lb/>i,j <lb/>E{log[n ij |n, z, γ]} <lb/>+ 2 <lb/>i,j <lb/>V ar{log[n ij |n, z, γ]} <lb/>(17) <lb/>The WAIC requires only one run of the RJMCMC with the full data set. There are also <lb/>other selection methods applicable, see Hooten and Hobbs (2015) for others. <lb/>The model was fitted using the R package multAbund. The RJMCMC algorithm was run <lb/>for 100,000 iterations following a burnin of 10,000 iterations. The package contains code <lb/>to fit the Poisson abundance data model as well as the ZIP and Bernoulli probit model for <lb/>occurrence. In addition to the joint analysis of abundance, we also analyzed the trawl survey <lb/>data as an occurrence data set where y ij = 1 if n ij &gt; 0, else y ij = 0. <lb/>4.3 Results <lb/>After fitting the ZIP version of the DP-JSDM and the independent species JSDM there was <lb/>a substantial improvement in WAIC under the DP-JSDM. WAIC for the DP-JSM model <lb/>was 3052.071 and WAIC = 3078.992 for the independence model. The posterior mode of the <lb/>number of guilds was κp = 8 with 95% of the posterior probability mass falling on κ p = 8 <lb/></body>

			<page>19 <lb/></page>

			<body>or 9 guilds. Figure 4 illustrates the estimated posterior matrix, Ψ = E[C p C p ] which defines <lb/>the probability that any two species share the same vertical migration guild. Using 1 − Ψ <lb/>as a measure of distance between species, we plotted the species according to the associated <lb/>dendogram (Figure 5), which gives a better visualization of the groupings. The predicted <lb/>abundance for each species was calculated as n * = E[n * |n] where n * = (n * <lb/>1 , . . . , n * <lb/>I ) is <lb/>an observation under the observed environmental conditions (Figure 6). Results for the γ <lb/>parameters are presented in Table B.1 of Appendix B along with estimates of the δi values <lb/>(Figure B.1). Appendix C provides similar figures and results for the DP-JSDM model using <lb/>binary occurrence data instead of the observed abundance. <lb/>The model profiled a wide range in behavior among species from the two dominant <lb/>fish families in the Bering Sea, Myctophidae and Bathylagidae. All but one of the 8 guilds <lb/>described by the model (Figures 5 and C.2) include a single species from one or both of these <lb/>families, implying that they partition the water column based on a characteristic response <lb/>to physical factors and foraging requirements. <lb/>The accuracy and predictive capability of the model was confirmed by the correct clus-<lb/>ter assignment of individual species with known relative abundance and depth distribution <lb/>profiles in the Bering Sea (i.e., bathylagids, Leuroglossus schmidti and Lipolagus ochotensis). <lb/>Then by virtue of guild membership, the model described distribution patterns in species for <lb/>which there is little reported data (i.e., myctophids, Stenobrachias leucopsarus and Diaphus <lb/>theta). <lb/>For instance, L. schmidti and S. leucopsarus formed the tightest cluster in both abundance <lb/>and occurrence dendograms (Figures 5 and C.2). Each is the most abundant species within <lb/>their respective families in the Bering Sea (Brodeur et al., 1999; Sinclair et al., 1999) and <lb/>both were highly represented throughout the water column day and night in this study. <lb/>Guild identity with L. schmidti suggests that S. leucopsarus shares a similar life history and <lb/></body>

			<page>20 <lb/></page>

			<body>foraging strategy wherein juveniles and adults have indistinct vertical migration and are <lb/>stratified in the water column according to age (size) with adults remaining below 240 m <lb/>(Beamish et al., 1999; Mecklenburg et al., 2002). <lb/>The bathylagid L. ochotensis and myctophid D. theta also form a guild in abundance <lb/>(Figure 5) along with Stenobrachias nannochir in occurrence guilds (Figure C.2). Lipolagus <lb/>ochotensis and S. nannochir are among the most abundant mesopelagic species in the Bering <lb/>Sea Sinclair et al. (1999); Mecklenburg et al. (2002). Both are size-stratified by depth with <lb/>adults residing in the deepest layers and especially present between 500-1000 m (Mecklenburg <lb/>et al., 2002). As a strong vertical migrator, L. ochotensis is also abundant between 200-500 <lb/>m Sinclair et al. (1999); Mecklenburg et al. (2002). Little is known about D. theta from <lb/>directed catch in the Bering Sea, however guild identity with S. nannochir and especially <lb/>with L. ochotensis suggests they share similar patterns of behavior. The model implication <lb/>that D. theta is an age-stratified strong vertical migrator available at upper mesopelagic <lb/>depths (Figure 6, B.1, and C.3) is supported by observations that it is a primary prey item <lb/>of Dall&apos;s porpoise (Phocoenoides dalli) in the top 250 m of water column (Crawford, 1981). <lb/>The best example of the degree of fine detail captured by the model was demonstrated by <lb/>Bathylagus pacificus, a common and abundant species of Bathylagidae that formed its own <lb/>cluster (Figure 5). Like other members of its family B. pacificus demonstrates a bimodal <lb/>pattern in body size at depth (Peden et al., 1985; Mecklenburg et al., 2002). In our study, <lb/>juvenile fish were concentrated at mid-layer levels during the day (500 meters) rising to 250 <lb/>meters at night, while adults concentrate at deeper daytime layers (1000 m) rising to 500 <lb/>m at night (Sinclair and Stabeno, 2002). This vertical migratory movement is apparent in <lb/>the log abundance plots (Figure 6; and δi values in Figure B.1) that together with known <lb/>age distribution suggest B. pacificus may form its own guild based on abundances at depth <lb/>driven by varying foraging requirements of juvenile and adults. <lb/></body>

			<page>21 <lb/>5 Discussion <lb/></page>

			<body>We presented a new methodology for modeling joint species distributions based on Dirichlet <lb/>process random effects to model species associations through a latent guild structure. Instead <lb/>of trying to directly parameterize cross-correlation in a species-specific random effect, we used <lb/>latent membership in an ecological guild. Species belonging to the same guild followed the <lb/>same response to environmental conditions through random coefficients effects in a GLM-like <lb/>setting. Unlike simple cross-correlated species random intercepts, the DP-JSDM provides <lb/>some valuable information on which species belong to guilds together and for the species <lb/>within a guild, how they respond to the selected environmental conditions together. <lb/>A fundamental aspect of mesopelagic ecology is diel vertical migration. The DP-JSDM <lb/>successfully identified community structure among 20 species of fish from the eastern Bering <lb/>Sea within this framework. The selected model parameters of depth and light describe real-<lb/>time clusters of species that move together similarly through the water column on a 24 hour <lb/>cycle, presumably in relation to foraging. Based on studies conducted in the North Pacific <lb/>Ocean, the diets of many of these same species collected from different depths match vertical <lb/>distribution patterns of the variety of copepods and euphausiids that they consume (Beamish <lb/>et al., 1999). <lb/>Although the DP-JSDM model was initially desired to model species association, it has <lb/>the added benefit that it automatically adjusts to the necessary complexity because the <lb/>number of guilds is also simultaneously being estimated as well. In the simulation experiment <lb/>it was demonstrated that if there is apparently little difference between the species in their <lb/>response to the recorded environmental conditions the DP-JSDM will collapse to one guild, <lb/>that is, no statistical difference between the species. This reduction in model complexity <lb/>was noted by Johnson et al. (2013b) in reference to spatially clustering abundance trends. <lb/>In our description of the model and our examples, we have provided a relatively straight-<lb/></body>

			<page>22 <lb/></page>

			<body>forward demonstration of the model and associated RJMCMC algorithm. However, there <lb/>are several extensions that would be useful in other ecological settings. Here we did not <lb/>have repeated observations at each site, so, we could not add an identifiable detection model <lb/>to the observation process, although, we illustrated that covariates (i.e., trawl duration) <lb/>could be added as a quasi-detection model as Ver Hoef and Frost (2003) used. However, if <lb/>multiple observations are available for each site, then a detection process could be added to <lb/>the observation model. Dorazio and Connor (2014) made use of an N -mixture model and <lb/>the DP-JSDM could use that as well. Instead of the ZIP model, one could add a another <lb/>observation model, <lb/>[ñ ijk , n ij |...] = Binomial(ñ ijk |n ij , γ ijk )Poisson(n ij |z ij ), <lb/>(18) <lb/>as the observation portion of the model, where ñij is the observed abundance of species i at <lb/>site j during survey k and γ ijk is the probability of each of the n ij individuals being observed. <lb/>If one marginalizes over the true abundances, the Poisson observation model results, <lb/>[ñ ijk |γ ijk , z ij ] = Poisson(ñ ijk | log γ ijk + z ij ), <lb/>(19) <lb/>where E[n ijk ] = exp{log γ ijk + z ij }. The same approach could also be used for occurrence <lb/>modeling, in which case, it becomes occupancy modeling, that is, for the observed presence <lb/>ỹijk , we use the hierarchical observation model, <lb/>[ỹ ijk , y ij |...] = Bernoulli(ỹ ijk |y ij γ ijk )Bernoulli(y ij |z ij ), <lb/>(20) <lb/>where the probability that ỹijk = 1 is y ij γ ijk . The main point being that the process model <lb/>does not change in either of these two settings, so, the DP-JSDM can easily be adapted to <lb/>these situations. <lb/>There is also an alteration that can be made when many sites are visited and spatial <lb/>correlation between sights might also be a consideration. We are not calling this an extension, <lb/></body>

			<page>23 <lb/></page>

			<body>because spatial correlation can be added without making additions to the basic structure <lb/>presented. All that needs to be changed to add random spatial effects is to use the basis <lb/>function approach of Ver Hoef and Jansen (2014), Johnson et al. (2013a), or Hefley et al. <lb/>(2016). In under a spatial basis function model, the random spatial field is modeled as η = <lb/>Hδ where the columns of the matrix H contain the spatial basis functions evaluated at each of <lb/>the modeled sites (rows). Each basis column represents a different frequency. In the notation <lb/>just presented it should be fairly obvious how the DP-JSDM can be changed to contain spatial <lb/>correlation, one simply needs to use a basis function matrix for the environmental design <lb/>matrix. In that case, it might be appropriate to use [δ|ω] = N (0, ω 2 I) for the DP baseline <lb/>distribution to match prior specifications that are usually used in spatial analysis. And, of <lb/>course, one could combine the spatial model with the previously mentioned detection model <lb/>extensions to form mutivariate spatial models for occupancy and abundance modeling. <lb/></body>

			<div type="acknowledgement">Acknowledgments <lb/>The findings and conclusions in the paper are those of the authors and do not necessarily <lb/>represent the views of the National Marine Fisheries Service, NOAA. Reference to trade <lb/>names does not imply endorsement by the National Marine Fisheries Service, NOAA. <lb/></div>

			<listBibl>References <lb/>Albert, J. and Chib, S. (1993). Bayesian-analysis of binary and polychotomous reponse data. <lb/>Journal of the American Statistical Association, 88(422):669-679. <lb/>Beamish, R., Leask, K., Ivanov, O., Balanov, A., Orlov, A., and Sinclair, B. (1999). The <lb/></listBibl>

			<page>24 <lb/></page>

			<listBibl>ecology, distribution, and abundance of midwater fishes of the subarctic pacific gyres. <lb/>Progress in Oceanography, 43(2):399-442. <lb/>Benoit-Bird, K. J. and Au, W. W. (2003). Spatial dynamics of a nearshore, micronekton <lb/>sound-scattering layer. ICES Journal of Marine Science: Journal du Conseil, 60(4):899-<lb/>913. <lb/>Blei, D. M. and Frazier, P. I. (2011). Distance dependent chinese restaurant processes. <lb/>Journal of Machine Learning Research, 12:2461-2488. <lb/>Brodeur, R. D., Wilson, M. T., Walters, G. E., and Melnikov, I. V. (1999). Forage fishes <lb/>in the bering sea: distribution, species associations, and biomass trends. Dynamics of the <lb/>Bering Sea, pages 509-536. <lb/>Carroll, C., Johnson, D. S., Dunk, J. R., and Zielinski, W. J. (2010). Hierarchical bayesian <lb/>spatial models for multispecies conservation planning and monitoring. Conservation Bi-<lb/>ology, 24(6):1538-1548. <lb/>Casella, G., Moreno, E., and Girón, F. J. (2014). Cluster analysis, model selection, and prior <lb/>distributions on models. Bayesian Analysis, 9:613-658. <lb/>Clark, J. S., Gelfand, A. E., Woodall, C. W., and Zhu, K. (2014). More than the sum <lb/>of the parts: forest climate response from joint species distribution models. Ecological <lb/>Applications, 24(5):990-999. <lb/>Crawford, T. W. (1981). Vertebrate prey of phocoenoides dalli,(dall&apos;s porpoise): associated <lb/>with the japanese high seas salmon fishery in the north pacific ocean. Master&apos;s thesis, <lb/>University of Washington. <lb/></listBibl>

			<page>25 <lb/></page>

			<listBibl>Cressie, N., Calder, C. A., Clark, J. S., Hoef, J. M. V., and Wikle, C. K. (2009). Account-<lb/>ing for uncertainty in ecological analysis: the strengths and limitations of hierarchical <lb/>statistical modeling. Ecological Applications, 19(3):553-570. <lb/>Dorazio, R. M. (2009). On selecting a prior for the precision parameter of dirichlet process <lb/>mixture models. Journal of Statistical Planning and Inference, 139(9):3384-3390. <lb/>Dorazio, R. M. and Connor, E. F. (2014). Estimating abundances of interacting species <lb/>using morphological traits, foraging guilds, and habitat. PloS one, 9(4):e94323. <lb/>Dorazio, R. M., Mukherjee, B., Zhang, L., Ghosh, M., Jelks, H. L., and Jordan, F. (2008). <lb/>Modeling unobserved sources of heterogeneity in animal abundance using a dirichlet pro-<lb/>cess prior. Biometrics, 64(2):635-644. <lb/>Dunson, D. B. and Xing, C. (2009). Nonparametric bayes modeling of multivariate categor-<lb/>ical data. Journal of the American Statistical Association, 104(487):1042-1051. <lb/>Godsill, S. (2001). On the relationship between Markov Chain Monte Carlo methods for <lb/>model uncertainty. Journal of Computational and Graphical Statistics, 10:230-248. <lb/>Goutis, C. and Casella, G. (1999). Explaining the saddlepoint approximation. The American <lb/>Statistician, 53(3):216-224. <lb/>Green, P. J. (2003). Trans-dimensional markov chain monte carlo. In Green, P. J., Hjort, <lb/>N. L., and Richardson, S., editors, Highly Structured Stochastic Systems. Oxford University <lb/>Press, Inc., New York. <lb/>Hefley, T. J., Broms, K. M., Brost, B. M., Buderman, F. E., Kay, S. L., Scharf, H. R., <lb/>Tipton, J. R., Williams, P. J., and Hooten, M. B. (2016). The basis function approach for <lb/>modeling autocorrelation in ecological data. Ecography, In press. <lb/></listBibl>

			<page>26 <lb/></page>

			<listBibl>Hobbs, N. T. and Hooten, M. B. (2015). Bayesian models: a statistical primer for ecologists. <lb/>Princeton University Press. <lb/>Hooten, M. B. and Hobbs, N. T. (2015). A guide to Bayesian model selection for ecologists. <lb/>Ecological Monographs, 85(1):3-28. <lb/>Johnson, D. S., Conn, P. B., Hooten, M. B., Ray, J. C., and Pond, B. A. (2013a). Spatial <lb/>occupancy models for large data sets. Ecology, 94(4):801-808. <lb/>Johnson, D. S. and Fritz, L. (2014). agtrend: A bayesian approach for estimating trends of <lb/>aggregated abundance. Methods in Ecology and Evolution, 5:1110-1115. <lb/>Johnson, D. S. and Hoeting, J. A. (2011). Bayesian multimodel inference for geostatistical <lb/>regression models. Plos One, 6(11):e25677. <lb/>Johnson, D. S., Ream, R. R., Towell, R. G., Williams, M. T., and Guerrero, J. D. L. (2013b). <lb/>Bayesian clustering of animal abundance trends for inference and dimension reduction. <lb/>Journal of Agricultural Biological and Environmental Statistics, 18(3):299-313. <lb/>Kass, R. E. and Raftery, A. E. (1995). Bayes factors. Journal of the American Statistical <lb/>Association, 90:773-795. <lb/>Latimer, A., Banerjee, S., Sang Jr, H., Mosher, E., and Silander Jr, J. (2009). Hierarchical <lb/>models facilitate spatial analysis of large data sets: a case study on invasive plant species <lb/>in the northeastern united states. Ecology Letters, 12(2):144-154. <lb/>Link, W. A. and Sauer, J. R. (2016). Bayesian cross-validation for model evaluation and <lb/>selection, with application to the north american breeding survey. Ecology, In press. <lb/>McLachlan, G. and Peel, D. (2004). Finite mixture models. John Wiley &amp; Sons. <lb/>Mecklenburg, C. W., Mecklenburg, T. A., and Thorsteinson, L. K. (2002). Fishes of Alaska. <lb/></listBibl>

			<page>27 <lb/></page>

			<listBibl>Neal, R. (2000). Markov chain sampling methods for Dirichlet process mixture models. <lb/>Journal of Computational and Graphical Statistics, 9(2):249-265. <lb/>Peden, A. E., Ostermann, W., and Pozar, L. J. (1985). Fishes observed at Canadian Weath-<lb/>ership Station Papa (500N, 1450W): with notes on the transpacific cruise of the CSS <lb/>Endeavor. Number 18. British Columbia Provincial Museum. <lb/>R Development Core Team (2015). R: A Language and Environment for Statistical Com-<lb/>puting. R Foundation for Statistical Computing, Vienna, Austria. <lb/>Royle, J. A. (2004). N-mixture models for estimating population size from spatially replicated <lb/>counts. Biometrics, 60(1):108-115. <lb/>Royle, J. A. and Dorazio, R. M. (2008). Hierarchical Modeling and Inference in Ecology. <lb/>Academic Press-Elsevier Ltd. <lb/>Shaby, B. and Wells, M. T. (2011). Exploring an adaptive metropolis algorithm. Technical <lb/>Report 2011-14, Department of Statistical Science, Duke University. <lb/>Simberloff, D. and Dayan, T. (1991). The guild concept and the structure of ecological <lb/>communities. Annual review of ecology and systematics, pages 115-143. <lb/>Sinclair, E., Balanov, A., Kubodera, T., Radchenko, V., and Fedorets, Y. A. (1999). Dis-<lb/>tribution and ecology of mesopelagic fishes and cephalopods. Dynamics of the Bering <lb/>Sea (TR Loughlin and K Ohtani, eds.), Alaska Sea Grant College Program AK-SG-99-03, <lb/>University of Alaska Fairbanks, pages 485-508. <lb/>Sinclair, E. and Stabeno, P. (2002). Mesopelagic nekton and associated physics of the <lb/>southeastern bering sea. Deep Sea Research Part II: Topical Studies in Oceanography, <lb/>49(26):6127-6145. <lb/></listBibl>

			<page>28 <lb/></page>

			<listBibl>Sinclair, E., Walker, W., and Thomason, J. (2015). Body size regression formulae, proximate <lb/>composition and energy density of eastern Bering Sea mesopelagic fish and squid. PloS <lb/>ONE, In press. <lb/>Thorson, J. T., Scheuerell, M. D., Shelton, A. O., See, K. E., Skaug, H. J., and Kristensen, <lb/>K. (2015). Spatial factor analysis: a new tool for estimating joint species distributions <lb/>and correlations in species range. Methods in Ecology and Evolution. <lb/>Tiao, G. C. and Zellner, A. (1964). Bayes&apos;s theorem and the use of prior knowledge in <lb/>regression analysis. Biometrika, pages 219-230. <lb/>Van Dyk, D. A. and Park, T. (2008). Partially collapsed gibbs samplers: Theory and <lb/>methods. Journal of the American Statistical Association, 103(482):790-796. <lb/>Ver Hoef, J. M. and Frost, K. J. (2003). A Bayesian hierarchical model for monitoring harbor <lb/>seal changes in Prince William Sound, Alaska. Environmental and Ecological Statistics, <lb/>10:201-219. <lb/>Ver Hoef, J. M. and Jansen, J. K. (2014). Estimating abundance from counts in <lb/>large data sets of irregularly-spaced plots using spatial basis functions. arXiv preprint <lb/>arXiv:1410.3163. <lb/>Vermunt, J. K., Van Ginkel, J. R., Der Ark, V., Andries, L., and Sijtsma, K. (2008). Mul-<lb/>tiple imputation of incomplete categorical data using latent class analysis. Sociological <lb/>Methodology, 38(1):369-397. <lb/>Ward, E. J., Chirakkal, H., Gonzalez-Suarez, M., Aurioles-Gamboa, D., Holmes, E. E., and <lb/>Gerber, L. (2010). Inferring spatial structure from time-series data: using multivariate <lb/>state-space models to detect metapopulation structure of california sea lions in the gulf of <lb/>california, mexico. Journal of Applied Ecology, 47(1):47-56. <lb/></listBibl>

			<page>29 <lb/></page>

			<listBibl>Watanabe, S. (2010). Asymptotic equivalence of bayes cross validation and widely applica-<lb/>ble information criterion in singular learning theory. The Journal of Machine Learning <lb/>Research, 11:3571-3594. <lb/>Watanabe, S. (2013). A widely applicable bayesian information criterion. The Journal of <lb/>Machine Learning Research, 14(1):867-897. <lb/></listBibl>

			<page>30 <lb/></page>

			<body>0.25 <lb/>0.5 <lb/>0.75 <lb/>1 <lb/>1.5 <lb/>2 <lb/>0 <lb/>5 <lb/>10 15 20 0 <lb/>5 <lb/>10 15 20 0 <lb/>5 <lb/>10 15 20 <lb/>0.00 <lb/>0.25 <lb/>0.50 <lb/>0.75 <lb/>1.00 <lb/>Figure 1: Estimated probabilities of joint guild membership between each species. <lb/></body>

			<page>31 <lb/></page>

			<body>0.25 <lb/>0.5 <lb/>0.75 <lb/>1 <lb/>1.5 <lb/>2 <lb/>0 <lb/>5 <lb/>10 <lb/>15 <lb/>20 0 <lb/>5 <lb/>10 <lb/>15 <lb/>20 0 <lb/>5 <lb/>10 <lb/>15 <lb/>20 <lb/>κ π <lb/>Figure 2: Estimated number of guilds, κ p , for simulated Poisson data sets with ω ranging <lb/>from 0.25 to 2. <lb/></body>

			<page>32 <lb/></page>

			<body>Figure 3: Locations of the mesopelagic trawl surveys. There were J = 41 separate trawl <lb/>surveys used the analysis of Section 4, however, some surveys were attempted geographically <lb/>near other surveys, so, they are somewhat obscured in the figure. <lb/></body>

			<page>33 <lb/></page>

			<body>Stenobrachius nannochir <lb/>Leuroglossus schmidti <lb/>Stenobrachius leucopsarus <lb/>Bathylagus pacificus <lb/>Diaphus theta <lb/>Lipolagus ochotensis <lb/>Macropinna microstoma <lb/>Tactostoma macropus <lb/>Pseudobathylagus milleri <lb/>Sigmops gracilis <lb/>Chauliodus macouni <lb/>Lampanyctus jordani <lb/>Avocettina infans <lb/>Lycodapus poecilus <lb/>Nannobrachium regale <lb/>Albatrossia pectoralis <lb/>Melamphaes lugubris <lb/>Coryphaenoides cinereus <lb/>Lycodapus fierasfer <lb/>Poromitra crassiceps <lb/>Stenobrachius nannochir <lb/>Leuroglossus schmidti <lb/>Stenobrachius leucopsarus <lb/>Bathylagus pacificus <lb/>Diaphus theta <lb/>Lipolagus ochotensis <lb/>Macropinna microstoma <lb/>Tactostoma macropus <lb/>Pseudobathylagus milleri <lb/>Sigmops gracilis <lb/>Chauliodus macouni <lb/>Lampanyctus jordani <lb/>Avocettina infans <lb/>Lycodapus poecilus <lb/>Nannobrachium regale <lb/>Albatrossia pectoralis <lb/>Melamphaes lugubris <lb/>Coryphaenoides cinereus <lb/>Lycodapus fierasfer <lb/>Poromitra crassiceps <lb/>0.00 <lb/>0.25 <lb/>0.50 <lb/>0.75 <lb/>1.00 <lb/>Figure 4: Estimated probability of joint guild membership for each of the fish species in the <lb/>trawl survey with respect to abundance <lb/></body>

			<page>34 <lb/></page>

			<body>Albatrossia pectoralis <lb/>Avocettina infans <lb/>Bathylagus pacificus <lb/>Chauliodus macouni <lb/>Coryphaenoides cinereus <lb/>Diaphus theta <lb/>Lampanyctus jordani <lb/>Leuroglossus schmidti <lb/>Lipolagus ochotensis <lb/>Lycodapus fierasfer <lb/>Lycodapus poecilus <lb/>Macropinna microstoma <lb/>Melamphaes lugubris <lb/>Nannobrachium regale <lb/>Poromitra crassiceps <lb/>Pseudobathylagus milleri <lb/>Sigmops gracilis <lb/>Stenobrachius leucopsarus <lb/>Stenobrachius nannochir <lb/>Tactostoma macropus <lb/>0.0 <lb/>0.5 <lb/>1.0 <lb/>1 − Proximity <lb/>Figure 5: Clustering of trawl survey fish species based on the estimated probability of joint <lb/>guild membership. The matrix 1 − Ψ was used as a distance matrix for forming the den-<lb/>dogram. The colored labels reflect guild groupings based on the posterior mode number of <lb/>guilds, κp = 8 <lb/></body>

			<page>35 <lb/></page>

			<body>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>Cycle: day, Depth: 250m <lb/>Cycle: night, Depth: 250m <lb/>Cycle: day, Depth: 500m <lb/>Cycle: night, Depth: 500m <lb/>Cycle: day, Depth: 1000 <lb/>Cycle: night, Depth:1000m <lb/>Poromitra crassiceps <lb/>Lycodapus fierasfer <lb/>Coryphaenoides cinereus <lb/>Melamphaes lugubris <lb/>Albatrossia pectoralis <lb/>Nannobrachium regale <lb/>Lycodapus poecilus <lb/>Avocettina infans <lb/>Lampanyctus jordani <lb/>Chauliodus macouni <lb/>Sigmops gracilis <lb/>Pseudobathylagus milleri <lb/>Tactostoma macropus <lb/>Macropinna microstoma <lb/>Lipolagus ochotensis <lb/>Diaphus theta <lb/>Bathylagus pacificus <lb/>Stenobrachius leucopsarus <lb/>Leuroglossus schmidti <lb/>Stenobrachius nannochir <lb/>Poromitra crassiceps <lb/>Lycodapus fierasfer <lb/>Coryphaenoides cinereus <lb/>Melamphaes lugubris <lb/>Albatrossia pectoralis <lb/>Nannobrachium regale <lb/>Lycodapus poecilus <lb/>Avocettina infans <lb/>Lampanyctus jordani <lb/>Chauliodus macouni <lb/>Sigmops gracilis <lb/>Pseudobathylagus milleri <lb/>Tactostoma macropus <lb/>Macropinna microstoma <lb/>Lipolagus ochotensis <lb/>Diaphus theta <lb/>Bathylagus pacificus <lb/>Stenobrachius leucopsarus <lb/>Leuroglossus schmidti <lb/>Stenobrachius nannochir <lb/>Poromitra crassiceps <lb/>Lycodapus fierasfer <lb/>Coryphaenoides cinereus <lb/>Melamphaes lugubris <lb/>Albatrossia pectoralis <lb/>Nannobrachium regale <lb/>Lycodapus poecilus <lb/>Avocettina infans <lb/>Lampanyctus jordani <lb/>Chauliodus macouni <lb/>Sigmops gracilis <lb/>Pseudobathylagus milleri <lb/>Tactostoma macropus <lb/>Macropinna microstoma <lb/>Lipolagus ochotensis <lb/>Diaphus theta <lb/>Bathylagus pacificus <lb/>Stenobrachius leucopsarus <lb/>Leuroglossus schmidti <lb/>Stenobrachius nannochir <lb/>−10 <lb/>−5 <lb/>0 <lb/>5 <lb/>−10 <lb/>−5 <lb/>0 <lb/>5 <lb/>Figure 6: Species-specific predictions of log-abundance for each level of cycle (day or night), <lb/>and depth (250, 500, or 1000 m). <lb/></body>

			<page>36 <lb/></page>

			<div type="annex">Appendix A: RJMCMC details <lb/>A.1 Prior distributions <lb/>Here we describe the details for performing the necessary parameter updates in the RJMCMC <lb/>algorithm. To facilitate the description the reader should recall we use the following prior <lb/>distributions in full vector form (where appropriate): <lb/>• [logit γ i ] = T (φ γ , d γ ) for i = 1, . . . , I <lb/>• [β] = N (µ β , Σ β ), <lb/>• [δ p |ω] = N (0, I κp ⊗ ω 2 (H H) −1 ), <lb/>• [ω] = HT (φ ω , d ω ) <lb/>• [σ] = HT (φ σ , d σ ) <lb/>• [p|α] = CRP(α) <lb/>• [α] = G(a, b), <lb/>where T denotes a t distribution, N is a (multivariate) normal distribution, HT is a half-t <lb/>distribution, CRP is the Chinese restaurant process, and G is a gamma distribution. Now, we <lb/>can describe the Markov Chain Monte Carlo (MCMC) sampler. The sampler is constructed <lb/>from repeated draws from the full conditional posterior distributions. We use the notation <lb/>[x|•] to represent the conditional distribution of the variable &apos;x&apos; given all of the other model <lb/>components. <lb/>A.2 Updating z <lb/>We will first describe the updating of z for the abundance models. Unfortunately, for the <lb/>abundance models used in this paper (e.g., [n ij |z ij , γ] = ZIP or Poisson), the full conditional <lb/></div>

			<page>37 <lb/></page>

			<div type="annex">distribution does not exist in a nice closed form and we suspect this is the case for every <lb/>abundance model one may want to use. The full conditional distribution required for the <lb/>update is, <lb/>[z|•] ∝ [n|z, γ] • N (z|Xβ + K p δ p , Σ), <lb/>(A.1) <lb/>for which a Metropolis-Hastings (MH) step is used with a random walk proposal distribution <lb/>[z * |z] = N (z, R z ), where R z is a diagonal matrix that is tuned for optimal sampling. In <lb/>the R package multAbund we use the adaptive random walk proposal described by Shaby <lb/>and Wells (2011) that continually adjusts proposal distribution throughout the MCMC run. <lb/>Once the new z * is drawn, each z * <lb/>ij is accepted with probability <lb/>max 1, <lb/>[z * <lb/>ij |•] <lb/>[z ij |•] <lb/>. <lb/>(A.2) <lb/>Note, that even though z * is proposed as a vector, the independence of each element implies <lb/>that each z * <lb/>ij can be accepted or rejected independently. <lb/>If one is analyzing occurrence data with a probit link as described in the main text of <lb/>the paper, then the full conditional distribution, <lb/>[z|•] ∝ [y|z] • N (z|Xβ + K p δ p , Σ), <lb/>(A.3) <lb/>is available in closed form. For each (i, j), the necessary full conditional distribution is <lb/>[z ij |•] = N b ij <lb/>a ij (Xβ + K p δ p , Σ), <lb/>(A.4) <lb/>where N <lb/>b ij <lb/>a ij is a truncated normal distribution with lower bound <lb/>a ij = <lb/> <lb/> <lb/> <lb/> <lb/> <lb/>−∞ for y ij = 0 <lb/>0 <lb/>for y ij = 1 <lb/>(A.5) <lb/>and upper bound <lb/>b ij = <lb/> <lb/> <lb/> <lb/> <lb/> <lb/>0 for y ij = 0 <lb/>∞ for y ij = 1 <lb/>(A.6) <lb/></div>

			<page>38 <lb/></page>

			<div type="annex">(Albert and Chib, 1993). If another link function is used, then the same procedure as the <lb/>abundance model updates is used with a MH acceptance step. <lb/>A.3 Udating γ <lb/>Here, the only model used where γ was present is the ZIP model used in the analysis of the <lb/>fish survey data. Therefore, we only describe updating of this parameter with respect to the <lb/>ZIP model with species-specific ZIP parameters, γ i . The full conditional distribution of logit <lb/>γ i is <lb/>[logit γ i |•] = [n i |z i , γ i ] • T (logit γ i |, φ γ , d γ ). <lb/>(A.7) <lb/>As with the z updates, the adaptive random walk MH update N ({logit γ i , R γ ) was used <lb/>were R γ is continually adapted through the RJMCMC. <lb/>A.4 Updating β and δ p <lb/>All of the coefficient vectors in the model have a normal prior distribution, thus the full <lb/>conditional distributions [β|•] and [δ p |•] are normal distributions where each is given in <lb/>Table A.1. <lb/>Table A.1: Means and variances for sampling of β and δ p . Each parameter <lb/>has a full conditional distribution of the form N (V −1 m, V −1 ). <lb/>Distribution <lb/>V <lb/>m <lb/>[β|•] <lb/>X Σ −1 X + Σ −1 <lb/>β <lb/>X Σ −1 (z − Kδ p ) + Σ −1 <lb/>β µ β <lb/>[δ p |•] <lb/>K p Σ −1 K p + (I κp ⊗ Ω) −1 <lb/>K p Σ −1 (z − Xβ) <lb/></div>

			<page>39 <lb/></page>

			<div type="annex">A.5 Updating ω and σ <lb/>Using an HT family of priors is not directly conjugate, therefore, a MH step is used here as <lb/>well. Recall that here we are using Ω = ω 2 (H H) −1 and Σ = σ 2 I, where ω = exp(ξ) and <lb/>σ = exp(θ). These choices could be easily modified if desired. For ω, the full conditional <lb/>distribution is given by <lb/>[ω|•] ∝ N (δ p |0, I κp ⊗ Ω) • HT (ω|φ ω , d ω ). <lb/>(A.8) <lb/>when converting to the log parameterization, we obtain the full conditional for ξ, <lb/>[ξ|•] ∝ N (δ p |0, I κp ⊗ e 2ξ (H H) −1 ) • HT (e ξ |φ ω , d ω ) • ξ <lb/>(A.9) <lb/>As in the z updates, we use a normal random-walk proposal [ξ * |•] = N (ξ, R ξ ), where R ξ <lb/>is adaptively tuned throughout the MCMC run in the way as the z updates. With regards <lb/>to σ, the θ parameter is updated in an identical fashion with the full conditional distribution <lb/>given by <lb/>[θ|•] ∝ N (z|Xβ + K p δ p , e θ I) • HT (e θ |φ σ , d σ ) • θ <lb/>(A.10) <lb/>and adaptive random walk proposal distribution N (θ * |θ, R θ ). <lb/>A.6 Updating p and α <lb/>The update of p was described in the main portion of the paper, therefore we omit it here <lb/>and refer the reader to Section 2.2 for details. <lb/>The CRP parameter α is updated through an MH step with the previously described <lb/>adaptive random walk proposal on log α. The full conditional distribution is given by <lb/>[α|•] ∝ CRP(p|α) • G(α|a, b). <lb/>(A.11) <lb/></div>

			<page>40 <lb/></page>

			<div type="annex">However, as with all of the positive valued parameters, we choose to reparameterize to the log <lb/> scale to make use of the adaptive random walk proposal distribution. So, the full conditional <lb/>distribution for log α is <lb/>[log α|•] ∝ CRP(p|α) • G(α|a, b) • log α. <lb/>(A.12) <lb/>The same adaptive procedure was used with an MH acceptance step to sample the full <lb/>conditional distribution. <lb/></div>

			<page>41 <lb/></page>

			<div type="annex">Appendix B: Additional results for fish survey abun-<lb/> 722 <lb/> dance model <lb/> 723 <lb/> Table A.2: Results for species-specific Zero-inflated Poisson (ZIP) mixture parameters, γ i . <lb/>The &apos;Estimate&apos; column is the posterior mode estimate and the &apos;CI&apos; columns are the upper and <lb/>lower 0.95 highest probability density interval values. The mixture probabilities represent <lb/>the probability that a given species is unavailable for surveying in a particular survey. <lb/>Estimate Lower CI Upper CI <lb/>Albatrossia pectoralis <lb/>0.20 <lb/>0.03 <lb/>0.44 <lb/>Avocettina infans <lb/>0.52 <lb/>0.27 <lb/>0.74 <lb/>Bathylagus pacificus <lb/>0.04 <lb/>0.00 <lb/>0.20 <lb/>Chauliodus macouni <lb/>0.03 <lb/>0.00 <lb/>0.17 <lb/>Coryphaenoides cinereus <lb/>0.14 <lb/>0.00 <lb/>0.46 <lb/>Diaphus theta <lb/>0.18 <lb/>0.04 <lb/>0.33 <lb/>Lampanyctus jordani <lb/>0.08 <lb/>0.00 <lb/>0.24 <lb/>Leuroglossus schmidti <lb/>0.01 <lb/>0.00 <lb/>0.07 <lb/>Lipolagus ochotensis <lb/>0.13 <lb/>0.02 <lb/>0.28 <lb/>Lycodapus fierasfer <lb/>0.43 <lb/>0.20 <lb/>0.69 <lb/>Lycodapus poecilus <lb/>0.58 <lb/>0.35 <lb/>0.79 <lb/>Macropinna microstoma <lb/>0.07 <lb/>0.00 <lb/>0.36 <lb/>Melamphaes lugubris <lb/>0.18 <lb/>0.00 <lb/>0.40 <lb/>Nannobrachium regale <lb/>0.54 <lb/>0.28 <lb/>0.75 <lb/>Poromitra crassiceps <lb/>0.03 <lb/>0.00 <lb/>0.28 <lb/>Pseudobathylagus milleri <lb/>0.28 <lb/>0.00 <lb/>0.56 <lb/>Sigmops gracilis <lb/>0.37 <lb/>0.03 <lb/>0.66 <lb/>Stenobrachius leucopsarus <lb/>0.01 <lb/>0.00 <lb/>0.07 <lb/>Stenobrachius nannochir <lb/>0.04 <lb/>0.00 <lb/>0.15 <lb/>Tactostoma macropus <lb/>0.32 <lb/>0.00 <lb/>0.57 <lb/></div>

			<page>42 <lb/></page>

			<div type="annex">+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>+ <lb/>Cycle: day, Depth: 250m <lb/>Cycle: night, Depth: 250m <lb/>Cycle: day, Depth: 500m <lb/>Cycle: night, Depth: 500m <lb/>Cycle: day, Depth: 1000 <lb/>Cycle: night, Depth:1000m <lb/>Poromitra crassiceps <lb/>Lycodapus fierasfer <lb/>Coryphaenoides cinereus <lb/>Melamphaes lugubris <lb/>Albatrossia pectoralis <lb/>Nannobrachium regale <lb/>Lycodapus poecilus <lb/>Avocettina infans <lb/>Lampanyctus jordani <lb/>Chauliodus macouni <lb/>Sigmops gracilis <lb/>Pseudobathylagus milleri <lb/>Tactostoma macropus <lb/>Macropinna microstoma <lb/>Lipolagus ochotensis <lb/>Diaphus theta <lb/>Bathylagus pacificus <lb/>Stenobrachius leucopsarus <lb/>Leuroglossus schmidti <lb/>Stenobrachius nannochir <lb/>Poromitra crassiceps <lb/>Lycodapus fierasfer <lb/>Coryphaenoides cinereus <lb/>Melamphaes lugubris <lb/>Albatrossia pectoralis <lb/>Nannobrachium regale <lb/>Lycodapus poecilus <lb/>Avocettina infans <lb/>Lampanyctus jordani <lb/>Chauliodus macouni <lb/>Sigmops gracilis <lb/>Pseudobathylagus milleri <lb/>Tactostoma macropus <lb/>Macropinna microstoma <lb/>Lipolagus ochotensis <lb/>Diaphus theta <lb/>Bathylagus pacificus <lb/>Stenobrachius leucopsarus <lb/>Leuroglossus schmidti <lb/>Stenobrachius nannochir <lb/>Poromitra crassiceps <lb/>Lycodapus fierasfer <lb/>Coryphaenoides cinereus <lb/>Melamphaes lugubris <lb/>Albatrossia pectoralis <lb/>Nannobrachium regale <lb/>Lycodapus poecilus <lb/>Avocettina infans <lb/>Lampanyctus jordani <lb/>Chauliodus macouni <lb/>Sigmops gracilis <lb/>Pseudobathylagus milleri <lb/>Tactostoma macropus <lb/>Macropinna microstoma <lb/>Lipolagus ochotensis <lb/>Diaphus theta <lb/>Bathylagus pacificus <lb/>Stenobrachius leucopsarus <lb/>Leuroglossus schmidti <lb/>Stenobrachius nannochir <lb/>−10 <lb/>−5 <lb/>0 <lb/>5 <lb/>−10 <lb/>−5 <lb/>0 <lb/>5 <lb/>Figure B.1: Species-specific δ estimates, δi , for each level of cycle (day or night), and depth <lb/>(250, 500, or 1000 m). <lb/></div>

			<page>43 <lb/></page>

			<div type="annex">Appendix C: Mesopeleagic fish survey occurrence mod-<lb/> 724 <lb/> eling <lb/> 725 <lb/> Coryphaenoides cinereus <lb/>Poromitra crassiceps <lb/>Pseudobathylagus milleri <lb/>Sigmops gracilis <lb/>Macropinna microstoma <lb/>Lycodapus fierasfer <lb/>Albatrossia pectoralis <lb/>Melamphaes lugubris <lb/>Tactostoma macropus <lb/>Avocettina infans <lb/>Lycodapus poecilus <lb/>Nannobrachium regale <lb/>Lampanyctus jordani <lb/>Bathylagus pacificus <lb/>Chauliodus macouni <lb/>Leuroglossus schmidti <lb/>Stenobrachius leucopsarus <lb/>Diaphus theta <lb/>Lipolagus ochotensis <lb/>Stenobrachius nannochir <lb/>Coryphaenoides cinereus <lb/>Poromitra crassiceps <lb/>Pseudobathylagus milleri <lb/>Sigmops gracilis <lb/>Macropinna microstoma <lb/>Lycodapus fierasfer <lb/>Albatrossia pectoralis <lb/>Melamphaes lugubris <lb/>Tactostoma macropus <lb/>Avocettina infans <lb/>Lycodapus poecilus <lb/>Nannobrachium regale <lb/>Lampanyctus jordani <lb/>Bathylagus pacificus <lb/>Chauliodus macouni <lb/>Leuroglossus schmidti <lb/>Stenobrachius leucopsarus <lb/>Diaphus theta <lb/>Lipolagus ochotensis <lb/>Stenobrachius nannochir <lb/>0.00 <lb/>0.25 <lb/>0.50 <lb/>0.75 <lb/>1.00 <lb/>Figure C.1: Estimated probability of joint guild membership for each of the fish species in <lb/>the trawl survey. <lb/></div>

			<page>44 <lb/></page>

			<div type="annex">Albatrossia pectoralis <lb/>Avocettina infans <lb/>Bathylagus pacificus <lb/>Chauliodus macouni <lb/>Coryphaenoides cinereus <lb/>Diaphus theta <lb/>Lampanyctus jordani <lb/>Leuroglossus schmidti <lb/>Lipolagus ochotensis <lb/>Lycodapus fierasfer <lb/>Lycodapus poecilus <lb/>Macropinna microstoma <lb/>Melamphaes lugubris <lb/>Nannobrachium regale <lb/>Poromitra crassiceps <lb/>Pseudobathylagus milleri <lb/>Sigmops gracilis <lb/>Stenobrachius leucopsarus <lb/>Stenobrachius nannochir <lb/>Tactostoma macropus <lb/>0.0 <lb/>0.5 <lb/>1.0 <lb/>1 − Proximity <lb/>Figure C.2: Clustering of trawl survey fish species based on the estimated probability of <lb/>joint guild membership. <lb/></div>

			<page>45 <lb/></page>

			<div type="annex">| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| | <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/>| <lb/> Cycle: day, Depth: 250m <lb/>Cycle: night, Depth: 250m <lb/>Cycle: day, Depth: 500m <lb/>Cycle: night, Depth:500m <lb/>Cycle: day, Depth: 1000 <lb/>Cycle: night, Depth: 1000m <lb/>Stenobrachius nannochir <lb/>Lipolagus ochotensis <lb/>Diaphus theta <lb/>Stenobrachius leucopsarus <lb/>Leuroglossus schmidti <lb/>Chauliodus macouni <lb/>Bathylagus pacificus <lb/>Lampanyctus jordani <lb/>Nannobrachium regale <lb/>Lycodapus poecilus <lb/>Avocettina infans <lb/>Tactostoma macropus <lb/>Melamphaes lugubris <lb/>Albatrossia pectoralis <lb/>Lycodapus fierasfer <lb/>Macropinna microstoma <lb/>Sigmops gracilis <lb/>Pseudobathylagus milleri <lb/>Poromitra crassiceps <lb/>Coryphaenoides cinereus <lb/>Stenobrachius nannochir <lb/>Lipolagus ochotensis <lb/>Diaphus theta <lb/>Stenobrachius leucopsarus <lb/>Leuroglossus schmidti <lb/>Chauliodus macouni <lb/>Bathylagus pacificus <lb/>Lampanyctus jordani <lb/>Nannobrachium regale <lb/>Lycodapus poecilus <lb/>Avocettina infans <lb/>Tactostoma macropus <lb/>Melamphaes lugubris <lb/>Albatrossia pectoralis <lb/>Lycodapus fierasfer <lb/>Macropinna microstoma <lb/>Sigmops gracilis <lb/>Pseudobathylagus milleri <lb/>Poromitra crassiceps <lb/>Coryphaenoides cinereus <lb/>Stenobrachius nannochir <lb/>Lipolagus ochotensis <lb/>Diaphus theta <lb/>Stenobrachius leucopsarus <lb/>Leuroglossus schmidti <lb/>Chauliodus macouni <lb/>Bathylagus pacificus <lb/>Lampanyctus jordani <lb/>Nannobrachium regale <lb/>Lycodapus poecilus <lb/>Avocettina infans <lb/>Tactostoma macropus <lb/>Melamphaes lugubris <lb/>Albatrossia pectoralis <lb/>Lycodapus fierasfer <lb/>Macropinna microstoma <lb/>Sigmops gracilis <lb/>Pseudobathylagus milleri <lb/>Poromitra crassiceps <lb/>Coryphaenoides cinereus <lb/>0.00 <lb/>0.25 <lb/>0.50 <lb/>0.75 <lb/>1.00 0.00 <lb/>0.25 <lb/>0.50 <lb/>0.75 <lb/>1.00 <lb/>Figure C.3: Species-specific predictions of occurrence for each level of cycle (day or night), <lb/>and depth (250m, 500m, or 1000m). <lb/></div>

			<page>46 </page>


	</text>
</tei>
