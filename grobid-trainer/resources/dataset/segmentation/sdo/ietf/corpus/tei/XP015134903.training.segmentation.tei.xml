<?xml version="1.0" ?>
<tei xml:space="preserve">
	<teiHeader>
		<fileDesc xml:id="0"/>
	</teiHeader>
	<text xml:lang="en">
			<front>server date 20190829; downloaded by EPO on 20190830 <lb/>Open Authentication Protocol <lb/>T. Lodderstedt, Ed. <lb/>Internet-Draft <lb/>yes.com AG <lb/>Intended status: Standards Track <lb/>V. Dzhuvinov <lb/>Expires: March 1, 2020 <lb/>Connect2id Ltd. <lb/>Aug 29, 2019 <lb/>JWT Response for OAuth Token Introspection <lb/>draft-ietf-oauth-jwt-introspection-response-07 <lb/>Abstract <lb/>This draft proposes an additional JSON Web Token (JWT) based response <lb/>for OAuth 2.0 Token Introspection. <lb/>Status of This Memo <lb/>This Internet-Draft is submitted in full conformance with the <lb/>provisions of BCP 78 and BCP 79. <lb/>Internet-Drafts are working documents of the Internet Engineering <lb/>Task Force (IETF). Note that other groups may also distribute <lb/>working documents as Internet-Drafts. The list of current Internet-<lb/>Drafts is at https://datatracker.ietf.org/drafts/current/. <lb/>Internet-Drafts are draft documents valid for a maximum of six months <lb/>and may be updated, replaced, or obsoleted by other documents at any <lb/>time. It is inappropriate to use Internet-Drafts as reference <lb/>material or to cite them other than as &quot;work in progress.&quot; <lb/>This Internet-Draft will expire on March 1, 2020. <lb/>Copyright Notice <lb/>Copyright (c) 2019 IETF Trust and the persons identified as the <lb/>document authors. All rights reserved. <lb/>This document is subject to BCP 78 and the IETF Trust&apos;s Legal <lb/>Provisions Relating to IETF Documents <lb/>(https://trustee.ietf.org/license-info) in effect on the date of <lb/>publication of this document. Please review these documents <lb/>carefully, as they describe your rights and restrictions with respect <lb/>to this document. Code Components extracted from this document must <lb/>include Simplified BSD License text as described in Section 4.e of <lb/>the Trust Legal Provisions and are provided without warranty as <lb/>described in the Simplified BSD License. <lb/></front>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 1] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<div type="toc">Table of Contents <lb/>1. Introduction . . . . . . . . . . . . . . . . . . . . . . . . <lb/>2 <lb/>1.1. Requirements Notation and Conventions . . . . . . . . . . <lb/>3 <lb/>2. Requesting a JWT Response . . . . . . . . . . . . . . . . . . <lb/>3 <lb/>3. JWT Response . . . . . . . . . . . . . . . . . . . . . . . . <lb/>3 <lb/>4. Client Metadata . . . . . . . . . . . . . . . . . . . . . . . <lb/>5 <lb/>5. Authorization Server Metadata . . . . . . . . . . . . . . . . <lb/>5 <lb/>6. Security Considerations . . . . . . . . . . . . . . . . . . . <lb/>6 <lb/>6.1. Cross-JWT Confusion . . . . . . . . . . . . . . . . . . . <lb/>6 <lb/>6.2. Token Data Leakage . . . . . . . . . . . . . . . . . . . <lb/>7 <lb/>6.3. Keeping Token Data Confidential from OAuth Clients . . . <lb/>7 <lb/>6.4. Logging and Audit of Introspection Activity . . . . . . . <lb/>7 <lb/>6.5. Data Minimization . . . . . . . . . . . . . . . . . . . . <lb/>7 <lb/>7. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . <lb/>7 <lb/>8. IANA Considerations . . . . . . . . . . . . . . . . . . . . . <lb/>8 <lb/>8.1. OAuth Dynamic Client Registration Metadata Registration . <lb/>8 <lb/>8.1.1. Registry Contents . . . . . . . . . . . . . . . . . . <lb/>8 <lb/>8.2. OAuth Authorization Server Metadata Registration . . . . <lb/>8 <lb/>8.2.1. Registry Contents . . . . . . . . . . . . . . . . . . <lb/>8 <lb/>8.3. OAuth Token Introspection Response . . . . . . . . . . . <lb/>9 <lb/>8.3.1. Registry Contents . . . . . . . . . . . . . . . . . . <lb/>9 <lb/>9. References . . . . . . . . . . . . . . . . . . . . . . . . . 14 <lb/>9.1. Normative References . . . . . . . . . . . . . . . . . . 14 <lb/>9.2. Informative References . . . . . . . . . . . . . . . . . 16 <lb/>Appendix A. Document History . . . . . . . . . . . . . . . . . . 16 <lb/>Authors&apos; Addresses . . . . . . . . . . . . . . . . . . . . . . . 18 <lb/></div>

			<body>1. Introduction <lb/>OAuth 2.0 Token Introspection [RFC7662] specifies a method for a <lb/>protected resource to query an OAuth 2.0 authorization server to <lb/>determine the state of an access token and obtain data associated <lb/>with the access token. This allows deployments to implement <lb/>identifier-based access tokens in an interoperable way. <lb/>The introspection response, as specified in OAuth 2.0 Token <lb/>Introspection [RFC7662], is a plain JSON object. However, there are <lb/>use cases where the resource server requires stronger assurance that <lb/>the authorization server issued the access token, including cases <lb/>where the authorization server assumes liability for the token&apos;s <lb/>content. An example is a resource server using verified person data <lb/>to create certificates, which in turn are used to create qualified <lb/>electronic signatures. <lb/>In such use cases it may be useful or even required to return a <lb/>signed JWT as the introspection response. This specification extends <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 2] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>the token introspection endpoint with the capability to return <lb/>responses as JWTs. <lb/>1.1. Requirements Notation and Conventions <lb/>The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, <lb/>&quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and <lb/>&quot;OPTIONAL&quot; in this document are to be interpreted as described in BCP <lb/>14 [RFC2119] [RFC8174] when, and only when, they appear in all <lb/>capitals, as shown here. <lb/>2. Requesting a JWT Response <lb/>A resource server requests to receive a JWT introspection response by <lb/>including an Accept header with content type &quot;application/jwt&quot; in the <lb/>introspection request. <lb/>The following is a non-normative example request: <lb/>POST /introspect HTTP/1.1 <lb/>Host: server.example.com <lb/>Accept: application/jwt <lb/>Content-Type: application/x-www-form-urlencoded <lb/>token=2YotnFZFEjr1zCsicMWpAA <lb/>3. JWT Response <lb/>The introspection endpoint responds with a JWT, setting the Content-<lb/>Type header to &quot;application/jwt&quot;. <lb/>This JWT MUST contain the claims &quot;iss&quot; and &quot;aud&quot; in order to prevent <lb/>misuse of the JWT as ID or access token (see Section 6.1). <lb/>This JWT MAY furthermore contain all claims defined in the &quot;OAuth <lb/>Token Introspection Response&quot; registry established by [RFC7662]. <lb/>The following is a non-normative example response (with line breaks <lb/>for display purposes only): <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 3] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>HTTP/1.1 200 OK <lb/>Content-Type: application/jwt <lb/>eyJraWQiOiIxIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJaNU8zdXBQQzg4UXJBa <lb/>ngwMGRpcyIsImF1ZCI6Imh0dHBzOlwvXC9wcm90ZWN0ZWQuZXhhbXBsZS5uZXRcL <lb/>3Jlc291cmNlIiwiZXh0ZW5zaW9uX2ZpZWxkIjoidHdlbnR5LXNldmVuIiwic2Nvc <lb/>GUiOiJyZWFkIHdyaXRlIGRvbHBoaW4iLCJpc3MiOiJodHRwczpcL1wvc2VydmVyL <lb/>mV4YW1wbGUuY29tXC8iLCJhY3RpdmUiOnRydWUsImV4cCI6MTQxOTM1NjIzOCwia <lb/>WF0IjoxNDE5MzUwMjM4LCJjbGllbnRfaWQiOiJsMjM4ajMyM2RzLTIzaWo0Iiwid <lb/>XNlcm5hbWUiOiJqZG9lIn0.HEQHf05vqVvWVnWuEjbzUnPz6JDQVR69QkxgzBNq5 <lb/>kk-sK54ieg1STazXGsdFAT8nUhiiV1f_Z4HOKNnBs8TLKaFXokhA0MqNBOYI--2u <lb/>nVHDqI_RPmC3p0NmP02Xmv4hzxFmTmpgjSy3vpKQDihOjhwNBh7G81JNaJqjJQTR <lb/>v_1dHUPJotQjMK3k8_5FyiO2p64Y2VyxyQn1VWVlgOHlJwhj6BaGHk4Qf5F8DHQZ <lb/>1WCPg2p_-hwfINfXh1_buSjxyDRF4oe9pKy6ZB3ejh9qIMm-WrwltuU1uWMXxN6e <lb/>S6tUtpKo8UCHBwLWCHmJN7KU6ZojmaISspdS23lELAlyw <lb/>The example response contains the following JSON document: <lb/>{ <lb/>&quot;sub&quot;: &quot;Z5O3upPC88QrAjx00dis&quot;, <lb/>&quot;aud&quot;: &quot;https://protected.example.net/resource&quot;, <lb/>&quot;scope&quot;: &quot;read write dolphin&quot;, <lb/>&quot;iss&quot;: &quot;https://server.example.com/&quot;, <lb/>&quot;active&quot;: true, <lb/>&quot;exp&quot;: 1419356238, <lb/>&quot;iat&quot;: 1419350238, <lb/>&quot;client_id&quot;: &quot;l238j323ds-23ij4&quot;, <lb/>&quot;given_name&quot;: &quot;John&quot;, <lb/>&quot;family_name&quot;:&quot;Doe&quot;, <lb/>&quot;birthdate&quot;:&quot;1982-02-01&quot; <lb/>} <lb/>Depending on the specific resource server policy the JWT is either <lb/>signed, or signed and encrypted. If the JWT is signed and encrypted <lb/>it MUST be a Nested JWT, as defined in JWT [RFC7519]. <lb/>Note: If the resource server policy requires a signed and encrypted <lb/>response and the authorization server receives an unauthenticated <lb/>request containing an Accept header with content type other than <lb/>&quot;application/jwt&quot;, it MUST refuse to serve the request and return an <lb/>HTTP status code 400. This is done to prevent downgrading attacks to <lb/>obtain token data intended for release to legitimate recipients only <lb/>(see Section 6.2). <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 4] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>4. Client Metadata <lb/>The authorization server determines what algorithm to employ to <lb/>secure the JWT for a particular introspection response. This <lb/>decision can be based on registered metadata parameters for the <lb/>resource server, supplied via dynamic client registration with the <lb/>resource server posing as the client, as defined by this draft. <lb/>The parameter names follow the pattern established by OpenID Connect <lb/>Dynamic Client Registration [OpenID.Registration] for configuring <lb/>signing and encryption algorithms for JWT responses at the UserInfo <lb/>endpoint. <lb/>The following client metadata parameters are introduced by this <lb/>specification: <lb/>introspection_signed_response_alg OPTIONAL. JWS [RFC7515] algorithm <lb/>(&quot;alg&quot; value) as defined in JWA [RFC7518] for signing <lb/>introspection responses. If this is specified, the response <lb/>will be signed using JWS and the configured algorithm. The <lb/>default, if omitted, is &quot;RS256&quot;. <lb/>introspection_encrypted_response_alg OPTIONAL. JWE [RFC7516] <lb/>algorithm (&quot;alg&quot; value) as defined in JWA [RFC7518] for <lb/>encrypting introspection responses. If this is specified, <lb/>the response will be encrypted using JWE and the configured <lb/>algorithm. The default, if omitted, is that no encryption is <lb/>performed. If both signing and encryption are requested, the <lb/>response will be signed then encrypted, with the result being <lb/>a Nested JWT, as defined in JWT [RFC7519]. <lb/>introspection_encrypted_response_enc OPTIONAL. JWE [RFC7516] <lb/>algorithm (&quot;enc&quot; value) as defined in JWA [RFC7518] for <lb/>authenticated encryption of introspection responses. The <lb/>default, if omitted, is &quot;A128CBC-HS256&quot;. Note: This <lb/>parameter MUST NOT be specified without setting <lb/>&quot;introspection_encrypted_response_alg&quot;. <lb/>Resource servers may register their public encryption keys using the <lb/>&quot;jwks_uri&quot; or &quot;jwks&quot; metadata parameters. <lb/>5. Authorization Server Metadata <lb/>Authorization servers SHOULD publish the supported algorithms for <lb/>signing and encrypting the JWT of an introspection response by <lb/>utilizing OAuth 2.0 Authorization Server Metadata [RFC8414] <lb/>parameters. <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 5] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>The following parameters are introduced by this specification: <lb/>introspection_signing_alg_values_supported OPTIONAL. JSON array <lb/>containing a list of the JWS [RFC7515] signing algorithms <lb/>(&quot;alg&quot; values) as defined in JWA [RFC7518] supported by the <lb/>introspection endpoint to sign the response. <lb/>introspection_encryption_alg_values_supported OPTIONAL. JSON array <lb/>containing a list of the JWE [RFC7516] encryption algorithms <lb/>(&quot;alg&quot; values) as defined in JWA [RFC7518] supported by the <lb/>introspection endpoint to encrypt the response. <lb/>introspection_encryption_enc_values_supported OPTIONAL. JSON array <lb/>containing a list of the JWE [RFC7516] encryption algorithms <lb/>(&quot;enc&quot; values) as defined in JWA [RFC7518] supported by the <lb/>introspection endpoint to encrypt the response. <lb/>6. Security Considerations <lb/>6.1. Cross-JWT Confusion <lb/>JWT introspection responses and OpenID Connect ID Tokens are <lb/>syntactically similar. An attacker could therefore attempt to <lb/>impersonate an end-user at a OpenID Connect relying party by passing <lb/>the JWT as an ID token. <lb/>Such an attack can be prevented like any other token substitution <lb/>attack. The authorization server MUST include the claims &quot;iss&quot; and <lb/>&quot;aud&quot; in each JWT introspection response, with the &quot;iss&quot; value set to <lb/>the authorization server&apos;s issuer URL and the &quot;aud&quot; value set to the <lb/>resource server&apos;s identifier. This allows a correctly implemented <lb/>OpenID Connect relying party to detect substitution by checking the <lb/>&quot;iss&quot; and &quot;aud&quot; claims as described in Section 3.1.3.7. of <lb/>[OpenID.Core]. Relying parties SHOULD also use and check the &quot;nonce&quot; <lb/>parameter and claim to prevent token and code replay. <lb/>Resource servers utilizing JWTs to represent self-contained access <lb/>tokens could be susceptible to replay attacks. Resource servers <lb/>should therefore apply proper counter measures against replay as <lb/>described in [I-D.ietf-oauth-security-topics], section 2.2. <lb/>JWT Confusion and other attacks involving JWTs are discussed in <lb/>[I-D.ietf-oauth-jwt-bcp]. <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 6] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>6.2. Token Data Leakage <lb/>The authorization server MUST use Transport Layer Security (TLS) 1.2 <lb/>(or higher) per [RFC7525] in order to prevent token data leakage. <lb/>To prevent introspection of leaked tokens and to present an <lb/>additional security layer against token guessing attacks the <lb/>authorization server may require all requests to the token <lb/>introspection endpoint to be authenticated. As an alternative or as <lb/>an addition to the authentication, the intended recipients may be set <lb/>up for encrypted responses. <lb/>In the latter case, confidentiality is ensured by the fact that only <lb/>the legitimate recipient is able to decrypt the response. An <lb/>attacker could try to circumvent this measure by requesting a plain <lb/>JSON response, using an Accept header with the content type set to, <lb/>for example, &quot;application/json&quot; instead of &quot;application/jwt&quot;. To <lb/>prevent this attack the authorization server MUST NOT serve requests <lb/>with content type other than &quot;application/jwt&quot; if the resource server <lb/>is set up to receive encrypted responses (see also Section 3). <lb/>6.3. Keeping Token Data Confidential from OAuth Clients <lb/>Authorization servers with a policy that requires token data to be <lb/>kept confidential from OAuth clients must require all requests to the <lb/>token introspection endpoint to be authenticated. As an alternative <lb/>or as an addition to the authentication, the intended recipients may <lb/>be set up for encrypted responses. <lb/>6.4. Logging and Audit of Introspection Activity <lb/>Authorization servers with a policy that requires token introspection <lb/>activity to be logged and audited must require all requests to the <lb/>token introspection endpoint to be authenticated. <lb/>6.5. Data Minimization <lb/>The authorisation server determines the token data a resource server <lb/>is allowed to see based on the resource server&apos;s client_id and <lb/>suitable token data, e.g. the scope value. <lb/></body>

			<div type="acknowledgement">7. Acknowledgements <lb/>We would like to thank Petteri Stenius, Neil Madden, Filip Skokan, <lb/>and Tony Nadalin for their valuable feedback. <lb/></div>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 7] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>8. IANA Considerations <lb/>8.1. OAuth Dynamic Client Registration Metadata Registration <lb/>This specification requests registration of the following client <lb/>metadata definitions in the IANA &quot;OAuth Dynamic Client Registration <lb/>Metadata&quot; registry [IANA.OAuth.Parameters] established by [RFC7591]: <lb/>8.1.1. Registry Contents <lb/>o Client Metadata Name: &quot;introspection_signed_response_alg&quot; <lb/>o Client Metadata Description: String value indicating the client&apos;s <lb/>desired introspection response signing algorithm. <lb/>o Change Controller: IESG <lb/>o Specification Document(s): Section 4 of [[ this specification ]] <lb/>o Client Metadata Name: &quot;introspection_encrypted_response_alg&quot; <lb/>o Client Metadata Description: String value specifying the desired <lb/>introspection response encryption algorithm (alg value). <lb/>o Change Controller: IESG <lb/>o Specification Document(s): Section 4 of [[ this specification ]] <lb/>o Client Metadata Name: &quot;introspection_encrypted_response_enc&quot; <lb/>o Client Metadata Description: String value specifying the desired <lb/>introspection response encryption algorithm (enc value). <lb/>o Change Controller: IESG <lb/>o Specification Document(s): Section 4 of [[ this specification ]] <lb/>8.2. OAuth Authorization Server Metadata Registration <lb/>This specification requests registration of the following values in <lb/>the IANA &quot;OAuth Authorization Server Metadata&quot; registry <lb/>[IANA.OAuth.Parameters] established by [RFC8414]. <lb/>8.2.1. Registry Contents <lb/>o Metadata Name: &quot;introspection_signing_alg_values_supported&quot; <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 8] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>o Metadata Description: JSON array containing a list of algorithms <lb/>supported by the authorization server for introspection response <lb/>signing. <lb/>o Change Controller: IESG <lb/>o Specification Document(s): Section 5 of [[ this specification ]] <lb/>o Metadata Name: &quot;introspection_encryption_alg_values_supported&quot; <lb/>o Metadata Description: JSON array containing a list of algorithms <lb/>supported by the authorization server for introspection response <lb/>encryption (alg value). <lb/>o Change Controller: IESG <lb/>o Specification Document(s): Section 5 of [[ this specification ]] <lb/>o Metadata Name: &quot;introspection_encryption_enc_values_supported&quot; <lb/>o Metadata Description: JSON array containing a list of algorithms <lb/>supported by the authorization server for introspection response <lb/>encryption (enc value). <lb/>o Change Controller: IESG <lb/>o Specification Document(s): Section 5 of [[ this specification ]] <lb/>8.3. OAuth Token Introspection Response <lb/>This specification requests registration of the following claim <lb/>values as defined in [OpenID.Core], Section 5.1, in the IANA &quot;OAuth <lb/>Token Introspection Response&quot; registry. [IANA.OAuth.Parameters] <lb/>established by [RFC7662]. <lb/>8.3.1. Registry Contents <lb/>o Name: &quot;name&quot; <lb/>o Description: End-User&apos;s full name in displayable form including <lb/>all name parts, possibly including titles and suffixes, ordered <lb/>according to the End-User&apos;s locale and preferences. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;given_name&quot; <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 9] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>o Description: Given name(s) or first name(s) of the End-User. Note <lb/>that in some cultures, people can have multiple given names; all <lb/>can be present, with the names being separated by space <lb/>characters. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;family_name&quot; <lb/>o Description: Surname(s) or last name(s) of the End-User. Note <lb/>that in some cultures, people can have multiple family names or no <lb/>family name; all can be present, with the names being separated by <lb/>space characters. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;middle_name&quot; <lb/>o Description: Middle name(s) of the End-User. Note that in some <lb/>cultures, people can have multiple middle names; all can be <lb/>present, with the names being separated by space characters. Also <lb/>note that in some cultures, middle names are not used. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;nickname&quot; <lb/>o Description: Casual name of the End-User that may or may not be <lb/>the same as the given_name. For instance, a nickname value of <lb/>Mike might be returned alongside a given_name value of Michael. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;preferred_username&quot; <lb/>o Description: Shorthand name by which the End-User wishes to be <lb/>referred to at the RP, such as janedoe or j.doe. This value MAY <lb/>be any valid JSON string including special characters such as @, <lb/>/, or whitespace. <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 10] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;profile&quot; <lb/>o Description:URL of the End-User&apos;s profile page. The contents of <lb/>this Web page SHOULD be about the End-User. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;picture&quot; <lb/>o Description: URL of the End-User&apos;s profile picture. This URL MUST <lb/>refer to an image file (for example, a PNG, JPEG, or GIF image <lb/>file), rather than to a Web page containing an image. Note that <lb/>this URL SHOULD specifically reference a profile photo of the End-<lb/>User suitable for displaying when describing the End-User, rather <lb/>than an arbitrary photo taken by the End-User. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;website&quot; <lb/>o Description: URL of the End-User&apos;s Web page or blog. This Web <lb/>page SHOULD contain information published by the End-User or an <lb/>organization that the End-User is affiliated with. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;email&quot; <lb/>o Description: End-User&apos;s preferred e-mail address. Its value MUST <lb/>conform to the [RFC5322] &quot;addr-spec&quot; syntax. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;email_verified&quot; <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 11] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>o Description: True if the End-User&apos;s e-mail address has been <lb/>verified; otherwise false. When this Claim Value is true, this <lb/>means that the OP took affirmative steps to ensure that this <lb/>e-mail address was controlled by the End-User at the time the <lb/>verification was performed. The means by which an e-mail address <lb/>is verified is context-specific, and dependent upon the trust <lb/>framework or contractual agreements within which the parties are <lb/>operating. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/> o Name: &quot;gender&quot; <lb/>o Description:End-User&apos;s gender. Values defined by this <lb/>specification are female and male. Other values MAY be used when <lb/>neither of the defined values are applicable. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;birthdate&quot; <lb/>o Description:Time the End-User&apos;s information was last updated. Its <lb/>value is a JSON number representing the number of seconds from <lb/>1970-01-01T0:0:0Z as measured in UTC until the date/time. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;zoneinfo&quot; <lb/>o Description: String from zoneinfo [zoneinfo] time zone database <lb/>representing the End-User&apos;s time zone. For example, Europe/Paris <lb/>or America/Los_Angeles. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;locale&quot; <lb/>o Description: End-User&apos;s locale, represented as a BCP47 [RFC5646] <lb/>language tag. This is typically an ISO 639-1 Alpha-2 [ISO639-1] <lb/>language code in lowercase and an ISO 3166-1 Alpha-2 [ISO3166-1] <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 12] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>country code in uppercase, separated by a dash. For example, en-<lb/>US or fr-CA. As a compatibility note, some implementations have <lb/>used an underscore as the separator rather than a dash, for <lb/>example, en_US; Relying Parties MAY choose to accept this locale <lb/>syntax as well. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;phone_number&quot; <lb/>o Description: End-User&apos;s preferred telephone number. [E.164] is <lb/>RECOMMENDED as the format of this Claim, for example, +1 (425) <lb/>555-1212 or +56 (2) 687 2400. If the phone number contains an <lb/>extension, it is RECOMMENDED that the extension be represented <lb/>using the [RFC3966] extension syntax, for example, +1 (604) <lb/>555-1234;ext=5678. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;phone_number_verified&quot; <lb/>o Description: True if the End-User&apos;s phone number has been <lb/>verified; otherwise false. When this Claim Value is true, this <lb/>means that the OP took affirmative steps to ensure that this phone <lb/>number was controlled by the End-User at the time the verification <lb/>was performed. The means by which a phone number is verified is <lb/>context-specific, and dependent upon the trust framework or <lb/>contractual agreements within which the parties are operating. <lb/>When true, the phone_number Claim MUST be in [E.164] format and <lb/>any extensions MUST be represented in [RFC3966] format. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/>o Name: &quot;address&quot; <lb/>o Description: End-User&apos;s preferred postal address. The value of <lb/>the address member is a JSON [RFC8259] structure containing some <lb/>or all of the members defined in [OpenID.Core], Section 5.1.1. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/></body>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 13] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<body>o Name: &quot;updated_at&quot; <lb/>o Description: Time the End-User&apos;s information was last updated. <lb/>Its value is a JSON number representing the number of seconds from <lb/>1970-01-01T0:0:0Z as measured in UTC until the date/time. <lb/>o Change Controller: IESG <lb/>o Specification Document(s):[OpenID.Core], Section 5.1 <lb/></body>

			<listBibl>9. References <lb/>9.1. Normative References <lb/>[E.164] <lb/>Standardization, I. O. F., &quot;E.164: The international <lb/>public telecommunication numbering plan&quot;, 2010, <lb/>&lt;https://www.itu.int/rec/T-REC-E.164-201011-I/en&gt;. <lb/>[I-D.ietf-oauth-jwt-bcp] <lb/>Sheffer, Y., Hardt, D., and M. Jones, &quot;JSON Web Token Best <lb/>Current Practices&quot;, draft-ietf-oauth-jwt-bcp-06 (work in <lb/>progress), June 2019. <lb/>[I-D.ietf-oauth-security-topics] <lb/>Lodderstedt, T., Bradley, J., Labunets, A., and D. Fett, <lb/>&quot;OAuth 2.0 Security Best Current Practice&quot;, draft-ietf-<lb/>oauth-security-topics-13 (work in progress), July 2019. <lb/>[ISO3166-1] <lb/>Standardization, I. O. F., &quot;ISO 3166-1:1997. Codes for the <lb/>representation of names of countries and their <lb/>subdivisions --Part 1: Country codes&quot;, 2013, <lb/>&lt;https://www.iso.org/standard/63545.html&gt;. <lb/>[ISO639-1] <lb/>Standardization, I. O. F., &quot;ISO 639-1:2002 Codes for the <lb/>representation of names of languages --part 1: Alpha-2 <lb/>Code&quot;, 2002, &lt;https://www.iso.org/standard/22109.html&gt;. <lb/>[OpenID.Core] <lb/>Sakimura, N., Bradley, J., Jones, M., Medeiros, B. D., and <lb/>C. Mortimore, &quot;OpenID Connect Core 1.0 incorporating <lb/>errata set 1&quot;, Nov 2014, <lb/>&lt;http://openid.net/specs/openid-connect-core-1_0.html&gt;. <lb/></listBibl>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 14] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<listBibl>[OpenID.Registration] <lb/>Sakimura, N., Bradley, J., and M. Jones, &quot;OpenID Connect <lb/>Dynamic Client Registration 1.0 incorporating errata set <lb/>1&quot;, Nov 2014, &lt;https://openid.net/specs/ <lb/>openid-connect-registration-1_0.html&gt;. <lb/>[RFC2119] Bradner, S., &quot;Key words for use in RFCs to Indicate <lb/>Requirement Levels&quot;, BCP 14, RFC 2119, <lb/>DOI 10.17487/RFC2119, March 1997, <lb/>&lt;https://www.rfc-editor.org/info/rfc2119&gt;. <lb/>[RFC3966] Schulzrinne, H., &quot;The tel URI for Telephone Numbers&quot;, <lb/>RFC 3966, DOI 10.17487/RFC3966, December 2004, <lb/>&lt;https://www.rfc-editor.org/info/rfc3966&gt;. <lb/>[RFC5322] Resnick, P., Ed., &quot;Internet Message Format&quot;, RFC 5322, <lb/>DOI 10.17487/RFC5322, October 2008, <lb/>&lt;https://www.rfc-editor.org/info/rfc5322&gt;. <lb/>[RFC7515] Jones, M., Bradley, J., and N. Sakimura, &quot;JSON Web <lb/>Signature (JWS)&quot;, RFC 7515, DOI 10.17487/RFC7515, May <lb/>2015, &lt;https://www.rfc-editor.org/info/rfc7515&gt;. <lb/>[RFC7516] Jones, M. and J. Hildebrand, &quot;JSON Web Encryption (JWE)&quot;, <lb/>RFC 7516, DOI 10.17487/RFC7516, May 2015, <lb/>&lt;https://www.rfc-editor.org/info/rfc7516&gt;. <lb/>[RFC7518] Jones, M., &quot;JSON Web Algorithms (JWA)&quot;, RFC 7518, <lb/>DOI 10.17487/RFC7518, May 2015, <lb/>&lt;https://www.rfc-editor.org/info/rfc7518&gt;. <lb/>[RFC7519] Jones, M., Bradley, J., and N. Sakimura, &quot;JSON Web Token <lb/>(JWT)&quot;, RFC 7519, DOI 10.17487/RFC7519, May 2015, <lb/>&lt;https://www.rfc-editor.org/info/rfc7519&gt;. <lb/>[RFC7525] Sheffer, Y., Holz, R., and P. Saint-Andre, <lb/>&quot;Recommendations for Secure Use of Transport Layer <lb/>Security (TLS) and Datagram Transport Layer Security <lb/>(DTLS)&quot;, BCP 195, RFC 7525, DOI 10.17487/RFC7525, May <lb/>2015, &lt;https://www.rfc-editor.org/info/rfc7525&gt;. <lb/>[RFC7591] Richer, J., Ed., Jones, M., Bradley, J., Machulak, M., and <lb/>P. Hunt, &quot;OAuth 2.0 Dynamic Client Registration Protocol&quot;, <lb/>RFC 7591, DOI 10.17487/RFC7591, July 2015, <lb/>&lt;https://www.rfc-editor.org/info/rfc7591&gt;. <lb/></listBibl>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 15] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<listBibl>[RFC7662] Richer, J., Ed., &quot;OAuth 2.0 Token Introspection&quot;, <lb/>RFC 7662, DOI 10.17487/RFC7662, October 2015, <lb/>&lt;https://www.rfc-editor.org/info/rfc7662&gt;. <lb/>[RFC8174] Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in RFC <lb/>2119 Key Words&quot;, BCP 14, RFC 8174, DOI 10.17487/RFC8174, <lb/>May 2017, &lt;https://www.rfc-editor.org/info/rfc8174&gt;. <lb/>[RFC8259] Bray, T., Ed., &quot;The JavaScript Object Notation (JSON) Data <lb/>Interchange Format&quot;, STD 90, RFC 8259, <lb/>DOI 10.17487/RFC8259, December 2017, <lb/>&lt;https://www.rfc-editor.org/info/rfc8259&gt;. <lb/>[RFC8414] Jones, M., Sakimura, N., and J. Bradley, &quot;OAuth 2.0 <lb/>Authorization Server Metadata&quot;, RFC 8414, <lb/>DOI 10.17487/RFC8414, June 2018, <lb/>&lt;https://www.rfc-editor.org/info/rfc8414&gt;. <lb/>9.2. Informative References <lb/>[IANA.OAuth.Parameters] <lb/>IANA, &quot;OAuth Parameters&quot;, <lb/>&lt;http://www.iana.org/assignments/oauth-parameters&gt;. <lb/></listBibl>

			<div type="annex">Appendix A. Document History <lb/>[[ To be removed from the final specification ]] <lb/>-07 <lb/>o fixed wrong description of &quot;locale&quot; <lb/>o added references for ISO and ITU specifications <lb/>-06 <lb/>o replaced reference to RFC 7159 with reference to RFC 8259 <lb/>-05 <lb/>o improved wording for TLS requirement <lb/>o added RFC 2119 boilerplate <lb/>o fixed and updated some references <lb/>-04 <lb/></div>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 16] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<div type="annex">o reworked definition of parameters in section 4 <lb/>o added text on data minimization to security considerations section <lb/>o added statement regarding TLS to security considerations section <lb/>-03 <lb/>o added registration for OpenID Connect Standard Claims to OAuth <lb/>Token Introspection Response registry <lb/>-02 <lb/>o updated references <lb/>-01 <lb/>o adapted wording to preclude any accept header except &quot;application/ <lb/>jwt&quot; if encrypted responses are required <lb/>o use registered alg value RS256 for default signing algorithm <lb/>o added text on claims in the token introspection response <lb/>-00 <lb/>o initial version of the WG draft <lb/>o defined default signing algorithm <lb/>o changed behavior in case resource server is set up for encryption <lb/>o Added text on token data leakage prevention to the security <lb/>considerations <lb/>o moved Security Considerations section forward <lb/>WG draft <lb/>-01 <lb/>o fixed typos in client meta data field names <lb/>o added OAuth Server Metadata parameters to publish algorithms <lb/>supported for signing and encrypting the introspection response <lb/>o added registration of new parameters for OAuth Server Metadata and <lb/>Client Registration <lb/></div>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 17] <lb/></page>

			<note place="headnote">Internet-Draft <lb/>JWT Response <lb/>Aug 2019 <lb/></note>

			<div type="annex">o added explicit request for JWT introspection response <lb/>o made iss and aud claims mandatory in introspection response <lb/>o Stylistic and clarifying edits, updates references <lb/>-00 <lb/>o initial version <lb/></div>

			Authors&apos; Addresses <lb/>

			<front>Torsten Lodderstedt (editor) <lb/>yes.com AG <lb/>Email: torsten@lodderstedt.net <lb/>Vladimir Dzhuvinov <lb/>Connect2id Ltd. <lb/>Email: vladimir@connect2id.com <lb/></front>

			<note place="footnote">Lodderstedt &amp; Dzhuvinov <lb/>Expires March 1, 2020 <lb/></note>

			<page>[Page 18] </page>


	</text>
</tei>
