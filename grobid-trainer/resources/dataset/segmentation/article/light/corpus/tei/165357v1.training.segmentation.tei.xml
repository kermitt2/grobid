<?xml version="1.0" ?>
<tei xml:space="preserve">
	<teiHeader>
		<fileDesc xml:id="_0"/>
	</teiHeader>
	<text xml:lang="en">
			<front>A model-based clustering method to detect infectious disease <lb/>transmission outbreaks from sequence variation <lb/>Rosemary M McCloskey 1 and Art FY Poon 2,3 * <lb/>1 BC Centre for Excellence in HIV/AIDS, Vancouver, Canada; <lb/>2 Department of Pathology and Laboratory Medicine, Western University, London, Canada; <lb/>3 Department of Microbiology and Immunology, Western University, London, Canada <lb/>* Corresponding author <lb/>Abstract <lb/>Clustering infections by genetic similarity is a popular technique for identifying potential out-<lb/>breaks of infectious disease, in part because sequences are now routinely collected for clinical <lb/>management of many infections. A diverse number of nonparametric clustering methods have <lb/>been developed for this purpose. These methods are generally intuitive, rapid to compute, and <lb/>readily scale with large data sets. However, we have found that nonparametric clustering methods <lb/>can be biased towards identifying clusters of diagnosis -where individuals are sampled sooner <lb/>post-infection -rather than the clusters of rapid transmission that are meant to be potential foci <lb/>for public health efforts. We develop a fundamentally new approach to genetic clustering based <lb/>on fitting a Markov-modulated Poisson process (MMPP), which represents the evolution of trans-<lb/>mission rates along the tree relating different infections. We evaluated this model-based method <lb/>alongside five nonparametric clustering methods using both simulated and actual HIV sequence <lb/>data sets. For simulated clusters of rapid transmission, the MMPP clustering method obtained <lb/>higher mean sensitivity (85%) and specificity (91%) than the nonparametric methods. When we <lb/>applied these clustering methods to published HIV-1 sequences from a study cohort of men who <lb/>have sex with men in Seattle, USA, we found that the MMPP method categorized about half (46%) <lb/>as many individuals to clusters compared to the other methods, and that the MMPP clusters were <lb/> 1 <lb/> more consistent with transmission outbreaks. This new approach to genetic clustering has sig-<lb/>nificant implications for the application of pathogen sequence analysis to public health, where it <lb/>is critical to robustly and accurately identify clusters for the most cost-effective deployment of <lb/>resources. <lb/></front>

			<body>Introduction <lb/>Genetic clustering is a class of methods for reducing large sequence data sets down to groups of <lb/>closely-related sequences. In the context of infectious diseases, clusters may identify infections <lb/>related by a common source [1]. Additionally, genetic clusters may represent locally elevated <lb/>rates of transmission, particularly when we expect a measurable number of genetic differences to <lb/>accumulate within a host between transmission events. Because genetic sequencing is increas-<lb/>ingly a fixture of the clinical management of infections, there is growing interest in using genetic <lb/>clustering as a resource for guiding public health responses in near real time [2-4]. The general <lb/>motivation is that if genetic clusters define groups with higher rates of transmission, then they may <lb/>facilitate a more cost-effective deployment of prevention services. <lb/>A diverse number of genetic clustering methods have been developed and applied for a broad <lb/>range of bacteria and viruses including Staphylococcus aureus [5], Mycobacterium tuberculosis <lb/>[6], HIV [7, 8], hepatitis C virus [9, 10] and Ebola virus [11, 12]. These clustering methods <lb/>are nonparametric because the clustering criteria are based on empirical distributions, making no <lb/>specific assumptions about the underlying biological processes. For instance, pairwise methods <lb/>build up clusters from pairs of sequences with a genetic distance below a predefined threshold <lb/>[5, 13]. Subtree methods define clusters relative to the common ancestors of sequences in the <lb/>phylogenetic tree, based on quantities such as the mean branch length among the descendants of <lb/>the ancestral node [14, 15]. Nonparametric methods tend to be intuitive and relatively easy to <lb/>compute. We have previously observed, however, that current nonparametric clustering methods <lb/>seem relatively insensitive to variation in rates of transmission [16]. Instead, these methods tend <lb/>to detect variation in rates of sampling, i.e., the delay between infection and diagnosis. <lb/>Here we introduce a fundamentally new approach to genetic clustering for infectious diseases <lb/></body>

			<page>2 <lb/></page>

			<body>that is based on modelling the evolution of transmission rates along the tree. We demonstrate that <lb/>our model-based (parametric) clustering method substantially outperforms a variety of nonpara-<lb/>metric methods in recovering clusters of rapid transmission in simulated data, and we show that <lb/>these differences are recapitulated in an analysis of real HIV-1 data. <lb/>Methods <lb/>Model <lb/>As in previous work [17, 18], we assume that the phylogenetic tree reconstructed from the genetic <lb/>variation among sampled infections is similar in shape to the underlying transmission tree [19]. <lb/>Hence, we assume that a branching point in the tree roughly approximates a transmission event, <lb/>which is also an implicit assumption of nonparametric clustering methods where clusters are in-<lb/>terpreted as &apos;hotspots&apos; of rapid transmission. We model branching rates as a discrete character <lb/>state that evolves along a phylogeny according to a continuous-time Markov chain. Further, we <lb/>assume the branching times of the phylogeny are generated according to a Poisson process whose <lb/>rate is controlled by the evolving character. Under this model, the branch lengths of the phylogeny <lb/>are not independent of the character state, as typically assumed when modeling the evolution of <lb/>nucleotides or amino acids. <lb/>A Cox process, or doubly-stochastic Poisson process, is an inhomogeneous Poisson process <lb/>whose arrival rate λ (t) is itself a stochastic process. The Markov-modulated Poisson process <lb/>(MMPP) is a special case of the Cox process where λ (t) varies according to a continuous-time <lb/>Markov chain with a finite number of states. When the Markov chain is in state 1, the Poisson <lb/>process has rate λ 1 , and so on. Following [20], we will let the Markov chain have m states, denote <lb/>its infinitesimal generator matrix by: <lb/></body>

			<page>3 <lb/></page>

			<body>Q = <lb/> <lb/> <lb/> <lb/> <lb/> <lb/> <lb/> <lb/> <lb/>−σ 1 σ 12 • • • σ 1m <lb/>σ 21 −σ 2 • • • σ 2m <lb/>. . . <lb/>. . . <lb/>. . . <lb/>. . . <lb/>σ m1 σ m2 • • • −σ m <lb/> <lb/> <lb/> <lb/> <lb/> <lb/> <lb/> <lb/> <lb/>where σ i = ∑ j =i σ i j , and denote the vector of rates of the Poisson process by λ = [λ 1 , . . . , λ m ] T . <lb/>The probability density of the process producing its first arrival at time y in state j, given that <lb/>it started in state i at time 0, is the i jth element of the matrix f (y) = exp((Q − Λ)y)Λ where <lb/>Λ = diag(λ ) [21]. Following [22] and [23], it is straightforward to calculate the likelihood of an <lb/>observed tree under this process. Let v be an internal node of the τ other than the root, u be its <lb/>parent, w and z be its children, and t v be the length of the branch joining v to its parent u. As in <lb/>[23], define L i (v) to be the likelihood of the subtree rooted at v conditioned on the parent u being <lb/>in state i. L i (v) is recursively defined by <lb/>L i (v) = ∑ <lb/>j <lb/>f i j (t v )L j (w)L j (z). <lb/>At the root of the tree, with children w and z, <lb/>L i (τ) = π i L i (w)L i (z) <lb/>L(τ) = ∑ <lb/>i <lb/>L i (τ). <lb/>At a tip node v with branch length t v , it is intuitive to define the likelihood using the matrix <lb/>exp((Q − Λ)t v ), which gives the probability density of each state transition and no events oc-<lb/>curring up to time t v . However, we found that the parameters which optimized the likelihood with <lb/>this definition nearly always included one arbitrarily small rate assigned to all tips. For this reason, <lb/>we simply assign L i (v) = 1 for all tips v. This approach is likely to overestimate cluster sizes due <lb/>to inclusion of non-cluster individuals sampled following transmission from a cluster member, as <lb/>well as individuals who are not currently part of a cluster but were in the past. In the context <lb/>of viral phylogenetics, this is somewhat justified by the evidence that viruses such as HIV [24] <lb/></body>

			<page>4 <lb/></page>

			<body>and HCV [25] may evolve at different rates within and among hosts, implying that the branching <lb/>process acting on the tips of the phylogeny may be different from the process acting on internal <lb/>nodes. <lb/>To optimize the likelihood of this model, we used the covariance matrix adaptation evolution <lb/>strategy [26], a black-box, derivative-free optimization algorithm. Source code implementing this <lb/>model is available at https://github.com/rmcclosk/netabc. <lb/>Data simulation <lb/>Trees were simulated using MASTER (version 5.0.2 [27]) under a susceptible-infected-removed <lb/>(SIR) model of an epidemic, as described in previous work [16]. In brief, transmissions occur <lb/>between infected (I) and susceptible individuals (S) at a rate β SI. Individuals are removed from <lb/>I due to mortality at a rate µ or by becoming sampled at a rate ψ. The population is structured <lb/>into two subpopulations with constant migration between like compartments (S 0 ↔ S 1 , I 0 ↔ I 1 ) at <lb/>a rate m. The two subpopulations comprised S 0 + I 0 = 9000 and S 1 + I 1 = 1000 individuals, re-<lb/>spectively. Each epidemic was seeded by a single infected individual in the majority subpopulation <lb/>(I 0 = 1 at time 0). We simulated 100 replicate trees under three different scenarios where rates of <lb/>transmission (β 1 ) and sampling (ψ 1 ) were varied in the minority subpopulation as follows: (1) a <lb/>faster sampling rate (ψ 1 &gt; ψ 0 ); (2) a faster transmission rate (β 1 &gt; β 0 ); or (3) both faster sampling <lb/>and transmission rates relative to the majority subpopulation. The underlying assumption is that <lb/>samples from the minority subpopulation should be assigned to clusters. Infected individuals were <lb/>removed due to mortality at a constant rate µ. The end condition for each simulation was for the <lb/>tree to reach 1000 terminal branches (tips), which were subsequently filtered for tips correspond-<lb/>ing to sampled individuals. As a result, the final number of tips was stochastic and slightly less <lb/>than 1000. The simulation outputs were serialized to files in the Newick tree specification format <lb/>and parsed using regular expressions in a Python script to transfer node attributes from comment <lb/>strings to node labels. <lb/>In our preliminary study [16], the parameters of the model were manually adjusted until it <lb/>yielded tree simulations that visually resembled the typical &apos;star-like&apos; shape of HIV-1 molecular <lb/>phylogenies (long terminal branches). In addition to expanding the number of replicate simula-<lb/></body>

			<page>5 <lb/></page>

			<body>tions, we ran a second set of simulations under different parameters to evaluate the sensitivity of <lb/>our results to these settings. Specifically, we reduced the baseline (majority) transmission rate <lb/>from β 0 = 5 × 10 −3 to 7.5 × 10 −4 and reduced the sampling fraction ψ/(ψ + µ) -the probability <lb/>that an infected individual was sampled before death -from 0.98 to 0.5 to reflect the parame-<lb/>ter settings used in [28]. We note that this sampling fraction is very different from the sampled <lb/>proportion of the infected population, since the former does not include unsampled and surviving <lb/>infected individuals. Unlike [28], we increased the baseline sampling rate from ψ 0 = 0.15 to 1.0 <lb/>so that the latter sampled proportion increased from less than 10% to about 40%. When ψ 0 = 0.15, <lb/>the prevalence tended to exceed 90% at the simulation end-point where the target number of tips <lb/>(n = 2000) was obtained. The parameter settings used in the two sets of simulations are summa-<lb/>rized in Supporting Information (SI) Table S1. For each scenario, we discarded a small number of <lb/>replicates where the epidemic failed to spread and ran additional simulations until 100 replicates <lb/>were obtained. <lb/>Sequence evolution was simulated on each tree using INDELible (version 1.03) [29] with mod-<lb/>ifications to allow the user to specify the ancestral nucleotide sequence at the root. We initialized <lb/>our simulations with the HXB2 pol reference sequence (Genbank accession K03455.1) at the root <lb/>of each simulated tree. As previously described [16], the simulation parameters were calibrated <lb/>to an actual alignment of HIV-1 pol sequences. Specifically, we used the M3 codon model with a <lb/>transition rate bias κ = 8.0 and rate variation according to a gamma distribution (shape α = 1.5, <lb/>rate β = 3) that we partitioned into 50 rate categories; a Lavalette distribution (LAV) indel model <lb/>with a = 1.5, M = 4 and rate 0.001; and a scaling factor of 15. <lb/>Phylogenetic trees were reconstructed from the multiple sequence alignments using approx-<lb/>imate maximum likelihood (FastTree2, version 2.1.10) [30] or neighbor-joining (RapidNJ, ver-<lb/>sion 2.3.2) [31]. The alignments and reconstructed trees were used as inputs for five published <lb/>non-parametric clustering methods -HIV-TRACE (TN93) [32], PhyloPart [33], Cluster Picker <lb/>[8], subtree clustering [15], patristic distance on bootstrapped alignments [34] -and our MMPP <lb/>method. Because our method requires a rooted bifurcating tree, we randomly resolved polytomies <lb/>using the multi2di function in the R package ape [35] and used midpoint rooting with R package <lb/></body>

			<page>6 <lb/></page>

			<body>phangorn [36]. <lb/>To measure the performance of each method, we calculated the false and true positive rates for <lb/>a range of threshold parameter settings for each method, where a &apos;positive&apos; prediction is the assign-<lb/>ment of a sampled sequence to the minority subpopulation. For TN93 [37], we varied the genetic <lb/>distance cutoff at all observed values. For Cluster Picker [8], we fixed the bootstrap threshold to <lb/>0.9 and varied the distance cutoff from 0.005 to 0.1. Similarly, we varied the maximum distance <lb/>from 0.005 to 0.0125 in PhyloPart [33]. We implemented a subtree clustering method with Biopy-<lb/>thon [38], where we screened internal nodes for a bootstrap threshold of 0.9 and varied the mean <lb/>branch length cutoff from 0.002 to 0.2. Lastly for the patristic method, we varied the cutoff from <lb/>0.004 to 0.5 for a minimum of 80% of bootstrap replicates [34]. <lb/>Empirical data <lb/>To compare these clustering methods on an actual data set, we obtained 3102 published partial <lb/>HIV-1 pol sequences that were previously collected in a cohort study of men who have sex with <lb/>men in Seattle, USA, and analyzed for clusters of transmission [39]. We reduced the data down <lb/>to a single sequence per patient (n = 1953) by excluding sequence records that were annotated as <lb/>an additional isolate (suffixed with an underscore and integer). Next, we removed codons asso-<lb/>ciated with drug resistance mutations according to the surveillance list published by Shafer and <lb/>colleagues [40], using pairwise alignment of each sequence against the HXB2 pol reference to <lb/>locate the respective codons. This step also trimmed sequence intervals that did not align to the <lb/>reference. Aligned sequences that were shorter than 100 nucleotides (n = 22) were filtered out at <lb/>this stage. We used SCUEAL [41] to predict HIV subtypes from the sequence data (maximum <lb/>three recombination breakpoints) and screened for sequences categorized as subtype B excluding <lb/>intra-and inter-subtype recombinants (n = 1653). A multiple sequence alignment was generated <lb/>from these data using MAFFT (version 7.305b) [42]. We reconstructed a neighbor-joining tree <lb/>from this alignment with RapidNJ [31] and a maximum likelihood tree with FastTree2 [30]. Fi-<lb/>nally, we applied the different clustering methods using these trees and, if necessary, the sequence <lb/>alignment, as inputs. <lb/></body>

			<page>7 <lb/></page>

			<body>Results <lb/>Sensitivity and specificity <lb/>Epidemic dynamics were simulated from a structured birth-death model using parameter settings <lb/>from [16]. We assumed that one subpopulation was larger than the other with 9000 and 1000 in-<lb/>dividuals, respectively, and that the epidemic started with a single infected individual in the larger <lb/>subpopulation. This model was designed to produce genetic clusters when the epidemic moved <lb/>from the larger subpopulation into the smaller (minority) subpopulation in which rates of trans-<lb/>mission and/or sampling were elevated. Our main results are summarized in Figure 1 with respect <lb/>to their true and false positive rates on 100 replicate simulations per scenario. In the first scenario, <lb/>the minority subpopulation had a faster transmission rate but the same sampling rate as the majority <lb/>subpopulation (&apos;faster transmission&apos;). The MMPP method obtained high true positive rates (TPRs) <lb/>and low false positive rates (FPRs) with means of 84.6% and 9.2%, respectively. We noticed that <lb/>a small number of replicates resulted in substantially higher FPRs than the others. In these cases, <lb/>we determined that the MMPP method had incorrectly assigned the &apos;faster transmission&apos; state to <lb/>the root of the tree. We subsequently determined that increasing the number of rate classes in the <lb/>model enabled MMPP to correctly identify clusters with the highest rate class (data not shown). <lb/>None of the nonparametric clustering methods obtained comparable TPRs or FPRs under this sim-<lb/>ulation scenario. For instance, the TN93, patristic and subtree clustering methods obtained a mean <lb/>TPR of about 60% for an FPR of 30%. In contrast, Cluster Picker and PhyloPart performed poorly <lb/>under this scenario, yielding cluster assignments with TPR and FPR rates that were comparable to <lb/>random guessing (Figure 1). <lb/>To illustrate the discordant results among these methods, we summarized the cluster assign-<lb/>ments for Cluster Picker, subtree clustering and MMPP in Figure 2. In this specific example, <lb/>sequences sampled from the minority subpopulation are concentrated in two groups. Clusters <lb/>identified by Cluster Picker were uniformly distributed throughout the tree. In contrast, cluster <lb/>assignments by the subtree clustering method were distributed less evenly with a subtree cluster <lb/>coinciding accurately with one of the actual clusters. However, we found that this method was <lb/>highly sensitive to the choice of mean branch length cutoff. For instance, increasing this cutoff <lb/></body>

			<page>8 <lb/></page>

			<body>0.0 <lb/>0.2 <lb/>0.4 <lb/>0.6 <lb/>0.8 <lb/>1.0 <lb/>0.0 0.2 0.4 0.6 0.8 1.0 <lb/>False positive rate <lb/>True positive rate <lb/>Faster transmission <lb/>MMPP <lb/>TN93 <lb/>Cluster Picker <lb/>PhyloPart <lb/>subtree <lb/>patristic <lb/>0.0 <lb/>0.2 <lb/>0.4 <lb/>0.6 <lb/>0.8 <lb/>1.0 <lb/>0.0 0.2 0.4 0.6 0.8 1.0 <lb/>False positive rate <lb/>True positive rate <lb/>Faster sampling <lb/>0.0 <lb/>0.2 <lb/>0.4 <lb/>0.6 <lb/>0.8 <lb/>1.0 <lb/>0.0 0.2 0.4 0.6 0.8 1.0 <lb/>False positive rate <lb/>True positive rate <lb/>Both faster <lb/>Figure 1: Performance of MMPP and five nonparametric clustering methods on simulated <lb/>data. Sequence data were simulated under three scenarios where the minority subpopulation <lb/>had (1) a faster transmission rate (left); (2) a faster sampling rate (centre), or; (3) both faster <lb/>rates of transmission and sampling (right). The x-and y-axes correspond to the false and true <lb/>positive rates of classifying individuals into the minority subpopulation, respectively. Each <lb/>point represents the outcome when the MMPP model was applied to one of 100 replicate <lb/>simulations. Each line represents the receiver-operator characteristic curve for one of the five <lb/>nonparametric clustering methods (see figure legend), where different false and true positive <lb/>rates were obtained by varying a threshold parameter of the method. <lb/></body>

			<page>9 <lb/></page>

			<body>from 0.0065 to 0.008 caused every terminal branch to be assigned to a cluster. <lb/>In the second simulation scenario, the rate of sampling was elevated in the minority subpopu-<lb/>lation but the transmission rates were held constant (&apos;faster sampling&apos;). In other words, members <lb/>of the minority subpopulation were more likely to be diagnosed sooner after infection. Under this <lb/>scenario the MMPP predictions were no better than a random guess with a mean TPR and FPR <lb/>of 55.6% and 51.5%, respectively. This outcome was not surprising given that terminal branch <lb/>lengths were excluded from maximum likelihood parameter estimation of the MMPP model. The <lb/>nonparametric methods were far superior, with the best results obtained by the subtree clustering <lb/>method. At a bootstrap cutoff of 90% and mean branch length cutoff of 0.006, for example, the <lb/>average TPR and FPR was 78.8% and 11.9%, respectively. <lb/>Finally, the third simulation scenario combined both faster rates of sampling and transmission <lb/>in the minority subpopulation (&apos;both faster&apos;). The MMPP predictions attained a mean TPR and <lb/>FPR of 88.7% and 18.5%, respectively. This level of performance was comparable to the sub-<lb/>tree clustering and pairwise distance methods (patristic distance and TN93; Figure 1) at specific <lb/>cutoff values. On the other hand, the Cluster Picker and PhyloPart methods both suffered worse <lb/>performance under this scenario. <lb/>We obtained qualitatively similar results (SI Figure S1) when the trees were simulated under a <lb/>different parameterization of the model based on [28]. Relative to the first parameter settings, the <lb/>transmission rates in both subpopulations were reduced by a factor of 0.15, and the mortality rate <lb/>of infected individuals was increased to equal the sampling rate in the majority subpopulation. In <lb/>general, we observed higher FPR associated with the MMPP method for this set of simulations. <lb/>The mean TPR and FPR of MMPP under the faster transmission scenario were 90.4% and 31.1%, <lb/>respectively. To our surprise, MMPP was able to correctly identify clusters under the faster sam-<lb/>pling scenario (82.3% TPR and 28.8% FPR), unlike the previous set of simulations. This level <lb/>of performance was comparable to the subtree clustering method. We attribute this difference to <lb/>the effect of lineage removal due to the elevated mortality of infected individuals. The elevated <lb/>sampling rate in the minority subpopulation resulted in more complete sampling of the correspond-<lb/>ing subtree, leading to shorter lengths of internal branches. In contrast, infected individuals were <lb/></body>

			<page>10 <lb/></page>

			<body>Cluster Picker <lb/>Markov-modulated <lb/>Poisson process <lb/>Subtree clustering <lb/>Figure 2: Comparison of predicted clusters and actual clusters of faster transmission. We <lb/>mapped the clustering predictions from three different methods (Cluster Picker, subtree clus-<lb/>tering and MMPP) onto one of the neighbor-joining trees reconstructed from sequence data <lb/>simulated under the faster-transmission scenario. Branches are coloured light red if the <lb/>method assigns that branch to a cluster, and dark blue otherwise. To colour internal branches <lb/>from the nonparametric cluster assignments of tips, we used ancestral character estimation <lb/>by maximum likelihood as implemented in the ace function in the R package ape [35]. The <lb/>correct assignments are indicated by labeling tips with filled circles if they belong in a cluster. <lb/>Cluster Picker (version 1.2.4) was run with default initial and main support thresholds (0.9) <lb/>and a genetic distance threshold of 0.025. Subtree clusters were extracted from the tree with <lb/>a bootstrap threshold of 90% and mean branch length threshold of 0.0065. <lb/></body>

			<page>11 <lb/></page>

			<body>seldom removed by mortality before sampling under the previous parameterization of the model. <lb/>Computing time <lb/>Based on our simulation analyses, the MMPP method seems to confer greater sensitivity and speci-<lb/>ficity to detect variation in transmission rates than the five nonparametric methods that we eval-<lb/>uated. These methods are often applied to large sequence databases with thousands or tens of <lb/>thousands of records [34, 43, 44]. Furthermore, there is a growing demand for genetic clusters to <lb/>be identified rapidly so that this information can be used to inform public health decisions in near <lb/>real-time [4, 32]. Hence, we evaluated the average computing time require to extract clusters from <lb/>simulated data sets containing approximately 1000 sequences each; the actual mean number of <lb/>tips per tree was 983.3 (range 969 − 994). Our results, based on the times required to process five <lb/>replicate data sets, are summarized in Table 1. The most time-consuming method was the patristic <lb/>distance method because our default approach was to generate distances for 100 nonparametric <lb/>bootstrap samples of the data [34]. Accordingly, eliminating the bootstrap sampling reduced the <lb/>computing time by roughly 100-fold at the cost of sensitivity and specificity. The fastest method <lb/>was TN93, which does not require reconstruction of a phylogenetic tree from sequence variation. <lb/>Our MMPP method required substantially more time to compute. However, the half-minute used <lb/>to process a 1000-tip tree is still an acceptable amount for near real-time monitoring. <lb/>To assess how MMPP computing time scales with the size of the tree, we generated random <lb/>subsamples of 100, 200, 500 and 8000 sequences from the simulated data sets, reconstructed <lb/>neighbor-joining trees for each sample, and re-ran MMPP on the resulting trees. Our results in-<lb/>dicated that the computing time scaled non-linearly with the size of the tree: the average times <lb/>were 0.82, 1.06, 2.44 and 20.68 seconds, respectively. Note that the average time to process trees <lb/>averaging 983 tips each was 30.45 seconds (Table 1). These results are summarized in SI Figure <lb/>S2. <lb/>Application to real data <lb/>We obtained a published data set of n = 3102 HIV-1 pol sequences that were collected from a <lb/>cohort study of men who have sex with men in Seattle, U.S. [39]. These data were reduced to <lb/></body>

			<page>12 <lb/></page>

			<body>Method <lb/>Tree Multi-<lb/>Time per replicate (seconds) <lb/>Average <lb/>required <lb/>core <lb/>2 <lb/>3 <lb/>5 (seconds) <lb/>MMPP <lb/>yes <lb/>no 27.32 31.63 32.54 33.35 27.42 <lb/>30.45 <lb/>TN93 <lb/>no <lb/>yes 1.46 1.24 1.21 1.21 1.17 <lb/>1.26 <lb/>Cluster Picker <lb/>yes <lb/>yes 1.45 3.97 2.87 6.20 4.42 <lb/>3.78 <lb/>PhyloPart <lb/>yes <lb/>yes 2.78 3.11 4.64 7.20 6.01 <lb/>4.75 <lb/>Subtree clustering <lb/>yes <lb/>no 2.73 2.69 2.74 2.78 2.83 <lb/>2.76 <lb/>Patristic <lb/>yes <lb/>no 82.46 67.57 95.77 71.71 71.25 <lb/>77.75 <lb/>Table 1: Computing time required by six clustering methods to process five different trees <lb/>each relating approximately 1000 simulated sequences. All methods were evaluated on an <lb/>Intel Xeon E5-1650v4 (six core) processor. If the UNIX time output implied multi-core pro-<lb/>cessing and the use of multiple cores was documented for the program, then this was indicated <lb/>under the heading &apos;Multi-core&apos;. None of the reported times include the time required to recon-<lb/>struct phylogenetic trees from the simulated sequence data, since the specific reconstruction <lb/>method used (e.g., maximum likelihood, neighbor joining) may vary among users. Because <lb/>we observed substantial variance among repeated runs of MMPP on the same data, we re-<lb/>ported the average of 3 runs. Times reported for TN93 include filtering the genetic distance <lb/>calculations for the shortest pairwise distance per sequence. <lb/>one sequence per individual and then filtered for non-recombinant subtype B sequences (n = 1653, <lb/>see Methods). We reconstructed a maximum likelihood phylogeny from these sequences as the <lb/>primary input for the different clustering methods. First, we discovered that the MMPP method <lb/>tended to assign faster branching rates throughout the base of the tree, including the root node. A <lb/>lineages-through-time plot of the tree (SI Figure S3) was consistent with a period of population-<lb/>level exponential growth in the first half of the tree, which may confound the MMPP model from <lb/>detecting other sources of branching rate variation over time. Based on our experience with simu-<lb/>lated cases where the faster of two rate classes was sometimes incorrectly assigned to the root of the <lb/></body>

			<page>13 <lb/></page>

			<body>tree, we increased the number of rate classes to 3 and grouped lineages assigned to the fastest rate <lb/>class as putative clusters. The resulting clusters are summarized in Figure 3, alongside the clus-<lb/>ters predicted by two nonparametric methods (TN93 and subtree clustering). Our MMPP program <lb/>required 43.6 and 28.7 seconds to analyze the ML tree assuming two and three rate classes, respec-<lb/>tively. Without adequate information to exactly reproduce the clusters reported by the source study <lb/>[39], we tuned each nonparametric clustering method until the number of individuals assigned to <lb/>clusters was similar to the number reported in that study (n = 168 individuals in 72 clusters). <lb/>TN93 <lb/>MMPP <lb/>subtree clustering <lb/>Figure 3: Comparison of three different clustering methods applied to a phylogeny recon-<lb/>structed from real HIV data. The phylogeny was reconstructed by maximum likelihood from <lb/>a published data set of HIV-1 subtype B pol sequences sampled from a study cohort of men <lb/>who have sex with men in Seattle, U.S. [39]. We adjusted the TN93 and subtree cluster-<lb/>ing methods until the number of individuals assigned to clusters was similar to the number <lb/>reported in the original study. Branches assigned to clusters are highlighted in dark red. <lb/>The most apparent difference between the nonparametric methods and the MMPP results, <lb/></body>

			<page>14 <lb/></page>

			<body>which are summarized in Figure 3, was the number of individuals assigned to clusters. Our MMPP <lb/>model assigned only 78 individuals (150 branches in the tree) to 8 clusters, substantially fewer <lb/>than the number reported in [39]. We note that the number of individuals in nonparametric clusters <lb/>is determined by the subjective selection of clustering criteria. To match the number reported by <lb/>[39], the TN93 method required a distance cutoff of 0.006, and our implementation of the subtree <lb/>method used a mean branch length cutoff of 0.0065 and a bootstrap cutoff of 0.9. Based on the <lb/>assignment of branches to clusters, MMPP was more concordant with the subtree method (Cohen&apos;s <lb/>κ = 0.573) than TN93 (κ = 0.341), where κ = 1 indicates complete agreement. Within clusters <lb/>identified by the subtree method but not by MMPP, terminal branch lengths (n = 92) were signif-<lb/>icantly shorter (Wilcoxon test, P &lt; 10 −12 ) and internal branch lengths (n = 64) were no different <lb/>(P = 0.24) from their respective distributions in the entire tree. Similarly, terminal branches in <lb/>TN93 clusters not identified by MMPP (n = 124) were significantly shorter (P &lt; 10 −12 ) but the <lb/>internal branches (n = 31) were only marginally shorter (P = 0.051). In contrast, internal branches <lb/>were significantly shorter in MMPP clusters (P = 5.98 × 10 −7 ). These results suggest that many <lb/>of the nonparametric clusters may be caused by variation in sampling rates; however, we cannot <lb/>ascertain the extent of this effect without additional information such as estimated dates of infec-<lb/>tion. <lb/>Discussion <lb/>Here we have formulated and tested a model-based (parametric) method for clustering genetic <lb/>sequences that have been sampled from an infectious disease epidemic. A potential advantage of a <lb/>model-based approach is that we can focus on the parameter of interest -namely, the variation in <lb/>transmission rates over time that may be an indicator of outbreaks. Our approach is conceptually <lb/>similar to the lineages-over-time model proposed by Holmes and colleagues [17]; however, we <lb/>assume that branching rates evolve along branches of the tree, such that discordant rates may occur <lb/>on contemporaneous branches on different parts of the tree. The MMPP model is also closely <lb/>related to models of biological speciation where rates of speciation are determined by a single <lb/>evolving character state, e.g., [45, 46]. Specifically, our model can be interpreted as a special case <lb/></body>

			<page>15 <lb/></page>

			<body>of the multitype speciation-extinction model [47] where extinction events are censored from the <lb/>model. Our simulation results indicate that the interpretation of MMPP clusters with respect to <lb/>sampling rates is dependent on the probability that a genetic sequence of the pathogen is sampled <lb/>from an infected individual before their death. If most infected individuals are eventually sampled, <lb/>then we predict that MMPP clusters will largely be determined by variation in transmission rates. <lb/>If a substantial fraction of infected individuals are never sampled before their death, however, <lb/>then the MMPP clusters may be caused by variation in either rates of transmission or sampling. <lb/>Nevertheless, we submit that this confounding is preferable to being unable to detect clusters of <lb/>transmission at all (Figure S1). <lb/>When interpreting clusters produced under the MMPP model, we assume that the variation in <lb/>the rates of branching events in the phylogeny is a sufficient approximation of variation in trans-<lb/>mission rates over time. The same assumption is implicit when nonparametric genetic clusters are <lb/>interpreted as putative transmission outbreaks. There are several reasons why transmission events <lb/>are likely to map to locations of the virus phylogeny other than the branching points, such as in-<lb/>complete lineage sorting within hosts [48] and incomplete sampling of the infected population <lb/>[49]. Another issue that is unique to model-based clustering is the problem of model misspeci-<lb/>fication. The present MMPP model assumes that rates of transition between branching rates are <lb/>constant over time. For instance, fitting the MMPP model with two rate classes to the actual HIV-1 <lb/>data set resulted in a majority of branches assigned to the faster rate class, including the root of <lb/>the tree. This was likely caused by an early period of exponential growth in the epidemic (Figure <lb/>S3), which induces lineage-independent variation in branching rates over time. Furthermore, the <lb/>spread of an epidemic through a socially and spatially-structured host population is problematic for <lb/>the MMPP model, which assumes that the evolution of branching rates is a memoryless process. <lb/>These issues identify directions for further work in this new class of genetic clustering methods for <lb/>infectious disease outbreaks. <lb/>Genetic clustering can be an important resource for retrospective epidemiological investiga-<lb/>tions [50] and may eventually play a central role in the near-real time monitoring and prediction <lb/>of infectious disease outbreaks [3, 4]. However, the growing popularity of applying genetic clus-<lb/></body>

			<page>16 <lb/></page>

			<body>tering to detect outbreaks of transmission needs to be tempered with greater skepticism about the <lb/>underlying methods [51]. Our results suggest that many clustering methods are potentially mis-<lb/>directing public health efforts away from groups suffering from higher rates of transmission, and <lb/>towards groups where new infections were diagnosed sooner than the population average. As we <lb/>have shown with our analysis of the MMPP method, bringing new approaches to the clustering <lb/>problem may provide a more complete picture, in combination with current methods, about the <lb/>recent history of an epidemic. <lb/></body>

			<div type="acknowledgement">Acknowledgements <lb/>We wish to acknowledge Simon D. W. Frost for his insightful and helpful feedback on an earlier <lb/>version of this manuscript. <lb/></div>

			<listBibl>References <lb/>[1] Buchman TG, Roizman B, Adams G, Stover BH. Restriction endonuclease fingerprinting of <lb/>herpes simplex virus DNA: a novel epidemiological tool applied to a nosocomial outbreak. <lb/>Journal of Infectious Diseases. 1978;138(4):488-498. <lb/>[2] Ypma RJ, Donker T, van Ballegooijen WM, Wallinga J. Finding evidence for local <lb/>transmission of contagious disease in molecular epidemiological datasets. PloS one. <lb/>2013;8(7):e69875. <lb/>[3] Gardy J, Loman NJ, Rambaut A. Real-time digital pathogen surveillance-the time is now. <lb/>Genome biology. 2015;16(1):155. <lb/>[4] Poon AF, Gustafson R, Daly P, Zerr L, Demlow SE, Wong J, et al. Near real-time monitoring <lb/>of HIV transmission hotspots from routine HIV genotyping: an implementation case study. <lb/>The Lancet HIV. 2016;3(5):e231-e238. <lb/>[5] Worby CJ, Lipsitch M, Hanage WP. Within-host bacterial diversity hinders accurate re-<lb/>construction of transmission networks from genomic distance data. PLoS Comput Biol. <lb/>2014;10(3):e1003549. doi:10.1371/journal.pcbi.1003549. <lb/></listBibl>

			<page>17 <lb/></page>

			<listBibl>[6] Walker TM, Ip CLC, Harrell RH, Evans JT, Kapatai G, Dedicoat MJ, et al. Whole-genome <lb/>sequencing to delineate Mycobacterium tuberculosis outbreaks: a retrospective observational <lb/>study. Lancet Infect Dis. 2013;13(2):137-46. doi:10.1016/S1473-3099(12)70277-3. <lb/>[7] Brenner BG, Roger M, Stephens D, Moisi D, Hardy I, Weinberg J, et al. Transmission <lb/>clustering drives the onward spread of the HIV epidemic among men who have sex with <lb/>men in Quebec. Journal of Infectious Diseases. 2011;204(7):1115-1119. <lb/>[8] Ragonnet-Cronin M, Hodcroft E, Hué S, Fearnhill E, Delpech V, Brown AJL, et al. <lb/>Automated analysis of phylogenetic clusters. <lb/>BMC Bioinformatics. 2013;14:317. <lb/>doi:10.1186/1471-2105-14-317. <lb/>[9] Jacka B, Applegate T, Krajden M, Olmstead A, Harrigan PR, Marshall BDL, et al. Phylo-<lb/>genetic clustering of hepatitis C virus among people who inject drugs in Vancouver, Canada. <lb/>Hepatology. 2014;60(5):1571-80. doi:10.1002/hep.27310. <lb/>[10] Campo DS, Xia GL, Dimitrova Z, Lin Y, Forbi JC, Ganova-Raeva L, et al. Accurate Ge-<lb/>netic Detection of Hepatitis C Virus Transmissions in Outbreak Settings. J Infect Dis. <lb/>2016;213(6):957-65. doi:10.1093/infdis/jiv542. <lb/>[11] Gire SK, Goba A, Andersen KG, Sealfon RSG, Park DJ, Kanneh L, et al. Genomic surveil-<lb/>lance elucidates Ebola virus origin and transmission during the 2014 outbreak. Science. <lb/>2014;345(6202):1369-72. doi:10.1126/science.1259657. <lb/>[12] Dudas G, Carvalho LM, Bedford T, Tatem AJ, Baele G, Faria NR, et al. Virus genomes <lb/>reveal factors that spread and sustained the Ebola epidemic. Nature. 2017;544(7650):309-<lb/>315. doi:10.1038/nature22040. <lb/>[13] Balfe P, Simmonds P, Ludlam CA, Bishop JO, Leigh Brown AJ. Concurrent evolution <lb/>of human immunodeficiency virus type 1 in patients infected from the same source: rate <lb/>of sequence change and low frequency of inactivating mutations. Journal of virology. <lb/>1990;64(12):6221-6233. <lb/></listBibl>

			<page>18 <lb/></page>

			<listBibl>[14] Yerly S, Vora S, Rizzardi P, Chave JP, Vernazza PL, Flepp M, et al. Acute HIV infection: <lb/>impact on the spread of HIV and transmission of drug resistance. AIDS. 2001;15(17):2287-<lb/>92. <lb/>[15] Hué S, Clewley JP, Cane PA, Pillay D. HIV-1 pol gene variation is sufficient for reconstruc-<lb/>tion of transmissions in the era of antiretroviral therapy. AIDS. 2004;18(5):719-28. <lb/>[16] Poon AF. Impacts and shortcomings of genetic clustering methods for infectious disease <lb/>outbreaks. Virus Evolution. 2016;2(2):vew031. <lb/>[17] Holmes EC, Nee S, Rambaut A, Garnett GP, Harvey PH. Revealing the history of infec-<lb/>tious disease epidemics through phylogenetic trees. Philosophical Transactions of the Royal <lb/>Society of London B: Biological Sciences. 1995;349(1327):33-40. <lb/>[18] Stadler T, Kouyos R, von Wyl V, Yerly S, Böni J, Bürgisser P, et al. Estimating the basic repro-<lb/>ductive number from viral sequence data. Molecular Biology and Evolution. 2012;29(1):347-<lb/>357. <lb/>[19] Leitner T, Escanilla D, Franzén C, Uhlén M, Albert J. Accurate reconstruction of a known <lb/>HIV-1 transmission history by phylogenetic tree analysis. Proc Natl Acad Sci U S A. <lb/>1996;93(20):10864-9. <lb/>[20] Fischer W, Meier-Hellstern K. The Markov-modulated Poisson process (MMPP) cookbook. <lb/>Performance Evaluation. 1993;18(2):149-171. <lb/>[21] Rydén T. An EM algorithm for estimation in Markov-modulated Poisson processes. Com-<lb/>putational Statistics &amp; Data Analysis. 1996;21(4):431-447. <lb/>[22] Felsenstein J. Evolutionary trees from DNA sequences: a maximum likelihood approach. <lb/>Journal of Molecular Evolution. 1981;17(6):368-376. <lb/>[23] Pupko T, Pe I, Shamir R, Graur D. A fast algorithm for joint reconstruction of ancestral <lb/>amino acid sequences. Molecular Biology and Evolution. 2000;17(6):890-896. <lb/></listBibl>

			<page>19 <lb/></page>

			<listBibl>[24] Lemey P, Rambaut A, Pybus OG. HIV evolutionary dynamics within and among hosts. AIDs <lb/>Rev. 2006;8(3):125-140. <lb/>[25] Gray RR, Parker J, Lemey P, Salemi M, Katzourakis A, Pybus OG. The mode and <lb/>tempo of hepatitis C virus evolution within and among hosts. BMC Evolutionary Biology. <lb/>2011;11(1):131. <lb/>[26] Hansen N. The CMA evolution strategy: a comparing review. In: Towards a New Evolution-<lb/>ary Computation. Springer; 2006. p. 75-102. <lb/>[27] Vaughan TG, Drummond AJ. <lb/>A stochastic simulator of birth-death master equa-<lb/>tions with application to phylodynamics. <lb/>Mol Biol Evol. 2013;30(6):1480-93. <lb/>doi:10.1093/molbev/mst057. <lb/>[28] Popinga A, Vaughan T, Stadler T, Drummond AJ. Inferring epidemiological dynamics with <lb/>Bayesian coalescent inference: the merits of deterministic and stochastic models. Genetics. <lb/>2015;199(2):595-607. <lb/>[29] Fletcher W, Yang Z. INDELible: a flexible simulator of biological sequence evolution. Mol <lb/>Biol Evol. 2009;26(8):1879-88. doi:10.1093/molbev/msp098. <lb/>[30] Price MN, Dehal PS, Arkin AP, et al. FastTree 2-approximately maximum-likelihood trees <lb/>for large alignments. PloS one. 2010;5(3):e9490. <lb/>[31] Simonsen M, Mailund T, Pedersen CN. Rapid neighbour-joining. In: International Workshop <lb/>on Algorithms in Bioinformatics. Springer; 2008. p. 113-122. <lb/>[32] Wertheim JO, Brown AJL, Hepler NL, Mehta SR, Richman DD, Smith DM, et al. The global <lb/>transmission network of HIV-1. Journal of Infectious Diseases. 2014;209(2):304-313. <lb/>[33] Prosperi MCF, Ciccozzi M, Fanti I, Saladini F, Pecorari M, Borghi V, et al. <lb/>A <lb/>novel methodology for large-scale phylogeny partition. <lb/>Nat Commun. 2011;2:321. <lb/>doi:10.1038/ncomms1325. <lb/></listBibl>

			<page>20 <lb/></page>

			<listBibl>[34] Poon AFY, Joy JB, Woods CK, Shurgold S, Colley G, Brumme CJ, et al. The impact of <lb/>clinical, demographic and risk factors on rates of HIV transmission: a population-based <lb/>phylogenetic analysis in British Columbia, Canada. J Infect Dis. 2015;211(6):926-35. <lb/>doi:10.1093/infdis/jiu560. <lb/>[35] Paradis E, Claude J, Strimmer K. APE: analyses of phylogenetics and evolution in R lan-<lb/>guage. Bioinformatics. 2004;20(2):289-290. <lb/>[36] Schliep KP. phangorn: phylogenetic analysis in R. Bioinformatics. 2011;27(4):592-3. <lb/>doi:10.1093/bioinformatics/btq706. <lb/>[37] Aldous JL, Pond SK, Poon A, Jain S, Qin H, Kahn JS, et al. Characterizing HIV <lb/>transmission networks across the United States. Clin Infect Dis. 2012;55(8):1135-43. <lb/>doi:10.1093/cid/cis612. <lb/>[38] Cock PJA, Antao T, Chang JT, Chapman BA, Cox CJ, Dalke A, et al. Biopython: freely avail-<lb/>able Python tools for computational molecular biology and bioinformatics. Bioinformatics. <lb/>2009;25(11):1422-3. doi:10.1093/bioinformatics/btp163. <lb/>[39] Wolf E, Herbeck JT, Van Rompaey S, Kitahata M, Thomas K, Pepper G, et al. Phylogenetic <lb/>evidence of HIV-1 transmission between adult and adolescent men who have sex with men. <lb/>AIDS research and human retroviruses. 2017;33(4):318-322. <lb/>[40] Shafer RW, Rhee SY, Pillay D, Miller V, Sandstrom P, Schapiro JM, et al. HIV-1 protease and <lb/>reverse transcriptase mutations for drug resistance surveillance. AIDS. 2007;21(2):215-23. <lb/>doi:10.1097/QAD.0b013e328011e691. <lb/>[41] Kosakovsky Pond SL, Posada D, Stawiski E, Chappey C, Poon AFY, Hughes G, <lb/>et al. An evolutionary model-based algorithm for accurate phylogenetic breakpoint <lb/>mapping and subtype prediction in HIV-1. PLoS Comput Biol. 2009;5(11):e1000581. <lb/>doi:10.1371/journal.pcbi.1000581. <lb/></listBibl>

			<page>21 <lb/></page>

			<listBibl>[42] Katoh K, Standley DM. <lb/>MAFFT multiple sequence alignment software version <lb/>7: improvements in performance and usability. Mol Biol Evol. 2013;30(4):772-80. <lb/>doi:10.1093/molbev/mst010. <lb/>[43] Gifford RJ, de Oliveira T, Rambaut A, Pybus OG, Dunn D, Vandamme AM, et al. Phyloge-<lb/>netic surveillance of viral genetic diversity and the evolving molecular epidemiology of hu-<lb/>man immunodeficiency virus type 1. J Virol. 2007;81(23):13050-6. doi:10.1128/JVI.00889-<lb/>07. <lb/>[44] Kouyos RD, von Wyl V, Yerly S, Böni J, Taffé P, Shah C, et al. Molecular epidemiology <lb/>reveals long-term changes in HIV type 1 subtype B transmission in Switzerland. J Infect Dis. <lb/>2010;201(10):1488-97. doi:10.1086/651951. <lb/>[45] Maddison WP, Midford PE, Otto SP. Estimating a binary character&apos;s effect on speciation and <lb/>extinction. Systematic biology. 2007;56(5):701-710. <lb/>[46] Stadler T, Smrckova J. Estimating shifts in diversification rates based on higher-level phylo-<lb/>genies. Biology letters. 2016;12(10):20160273. <lb/>[47] FitzJohn RG. Diversitree: comparative phylogenetic analyses of diversification in R. Meth-<lb/>ods in Ecology and Evolution. 2012;3(6):1084-1092. <lb/>[48] Ypma RJF, van Ballegooijen WM, Wallinga J. <lb/>Relating phylogenetic trees to <lb/>transmission trees of infectious disease outbreaks. <lb/>Genetics. 2013;195(3):1055-62. <lb/>doi:10.1534/genetics.113.154856. <lb/>[49] Novitsky V, Moyo S, Lei Q, DeGruttola V, Essex M. Impact of sampling density <lb/>on the extent of HIV clustering. AIDS Res Hum Retroviruses. 2014;30(12):1226-35. <lb/>doi:10.1089/aid.2014.0173. <lb/>[50] Peters PJ, Pontones P, Hoover KW, Patel MR, Galang RR, Shields J, et al. HIV Infec-<lb/>tion Linked to Injection Use of Oxymorphone in Indiana, 2014-2015. N Engl J Med. <lb/>2016;375(3):229-39. doi:10.1056/NEJMoa1515195. <lb/></listBibl>

			<page>22 <lb/></page>

			<listBibl>[51] Dearlove B, Xiang F, Frost S. Biased phylodynamic inferences from analysing clusters of <lb/>viral sequences. bioRxiv. 2016; p. 095661. <lb/>1 <lb/></listBibl>

			<page>23 </page>


	</text>
</tei>
