<?xml version="1.0" ?>
<tei>
	<teiHeader>
		<fileDesc xml:id="_Bioinformatics-2007-Rivals"/>
	</teiHeader>
	<text xml:lang="en">
			<front> Vol. 23 no. 4 2007, pages 401–407 <lb/>doi:10.1093/bioinformatics/btl633 <lb/> BIOINFORMATICS <lb/> REVIEW <lb/> Databases and ontologies <lb/> Enrichment or depletion of a GO category within a class <lb/>of genes: which test? <lb/> Isabelle Rivals  Ã  , Lé on Personnaz, Lieng Taing 1 and Marie-Claude Potier 1 <lb/> E ´ quipe de Statistique Appliqué e and 1 Laboratoire de Neurobiologie et Diversité Cellulaire, E ´ cole Supé rieure <lb/>de Physique et de Chimie Industrielles (ESPCI), 10 rue Vauquelin, 75005 Paris, France <lb/> Received on June 20, 2006; revised and accepted December 11, 2006 <lb/>Advance Access publication December 20, 2006 <lb/>Associate Editor: Jonathan Wren <lb/> ABSTRACT <lb/>Motivation: A number of available program packages determine <lb/>the significant enrichments and/or depletions of GO categories <lb/>among a class of genes of interest. Whereas a correct formulation of <lb/>the problem leads to a single exact null distribution, these GO tools <lb/>use a large variety of statistical tests whose denominations often do <lb/>not clarify the underlying P-value computations. <lb/> Summary: We review the different formulations of the problem and <lb/>the tests they lead to: the binomial, x  2 , equality of two probabilities, <lb/>Fisher&apos;s exact and hypergeometric tests. We clarify the relationships <lb/>existing between these tests, in particular the equivalence between <lb/>the hypergeometric test and Fisher&apos;s exact test. We recall that the <lb/>other tests are valid only for large samples, the test of equality of <lb/>two probabilities and the x  2 -test being equivalent. We discuss the <lb/>appropriateness of one-and two-sided P-values, as well as some <lb/>discreteness and conservatism issues. <lb/> Contact: isabelle.rivals@espci.fr <lb/> Supplementary information: Supplementary data are available at <lb/> Bioinformatics online. <lb/> </front>
			
			<body>1 INTRODUCTION <lb/> A common problem in functional genomic studies is to detect <lb/>significant enrichments and/or depletions of Gene Ontology (GO) <lb/>categories within a class of genes of interest, typically the class of <lb/>significantly differentially expressed (DE) genes. Many GO process-<lb/>ing tools perform this task using various statistical tests refered to as: <lb/>the binomial test, the x  2 -test, the equality of two probabilities test, <lb/>Fisher&apos;s exact test and the hypergeometric test (see Table 1). The <lb/>authors of some packages claim the advantages of the test(s) they <lb/>propose, often seemingly contradicting each other. For example, <lb/>Zeeberg et al. (2003) favor Fisher&apos;s exact test: &apos;Unlike the Z-statistics <lb/> with the hypergeometric distribution, and tests based on it, Fisher&apos;s <lb/>exact test is appropriate even for categories containing a small num-<lb/>ber of genes&apos;, whereas for Martin et al. (2004) the hypergeometric <lb/>test is most appropriate: &apos;On the average, the hypergeometric dis-<lb/>tribution seems to be both the most adapted model and the most <lb/>powerful test&apos;. Moreover, even though the most recent review papers <lb/>use a number of criteria to exhaustively compare the different exist-<lb/>ing tools (Khatri and Draghici, 2005), they do not discuss in detail <lb/>the identity and approximation relationships existing between the <lb/>different tests. This is precisely the aim of the present paper. <lb/> 2 PROBLEM STATEMENT <lb/> We consider a total population of genes, e.g. the genes expressed in <lb/>a microarray experiment, and we are interested in the property of a <lb/>gene to belong to a specific GO category. The aim is to establish <lb/>whether the class of the DE genes presents an enrichment and/or a <lb/>depletion of the GO category of interest with respect to the total <lb/>gene population. <lb/> 3 CANDIDATE FORMULATIONS <lb/> Let H 0 denote the null hypothesis that the property for a gene to <lb/>belong to the GO category of interest and that to be DE are inde-<lb/>pendent, or equivalently that the DE genes are picked at ran-<lb/>dom from the total gene population. We consider successively <lb/>the hypergeometric, the comparison of two probabilities, and the <lb/>2 · 2 contingency table formulations of the above problem, and <lb/>introduce the exact or approximate null distributions they lead to. <lb/> Notations (see Table 2): the total number of genes is denoted by n, <lb/>the total number of genes belonging to the GO category of interest <lb/>by n  +1  , the number of DE genes by n 1+ : n, n  +1  and n 1+ are hence <lb/>fixed by the experiment. The number of DE genes belonging to the <lb/>GO category is denoted by n 11 . <lb/> 3.1 Hypergeometric formulation <lb/> The hypergeometric formulation is directly derived from the <lb/>problem statement. <lb/> 3.1.1 Exact null distribution If H 0 is true, the random variable <lb/>N 11 whose realization 1 is the observed value n 11 , has a hypergeo-<lb/>metric distribution with parameters n, n 1+ , and n  +1  , which we denote <lb/>by N 11  $ Hyper(n, n 1+ , n  +1  ), with: <lb/>PðN 11  ¼ xÞ ¼ <lb/> n  þ1 <lb/> x <lb/> n À n  þ1 <lb/> n 1þ  À x <lb/> n <lb/>n 1þ <lb/> ¼ <lb/> n  þ1 <lb/> x <lb/> n  þ2 <lb/> n 12 <lb/> n <lb/>n 1þ <lb/> : <lb/> ð1Þ <lb/> Note that Hyper(n, n 1+ , n  +1  )  Hyper(n, n  +1  , n 1+ ). <lb/> 
			
			<note place="footnote">Ã  To whom correspondence should be addressed. <lb/></note> 
			
			<note place="footnote">1 Random variables and their realizations are denoted respectively by <lb/>uppercase and lowercase letters. <lb/></note> 
			
			<note place="footnote">Ó 2006 The Author(s) <lb/>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ <lb/>by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited. <lb/></note> 
			
			<note place="footnote">by  guest on March 17, 2013 <lb/> http://bioinformatics.oxfordjournals.org/ <lb/> Downloaded from <lb/></note> 
			
			3.1.2 Approximate null distribution For a large sample, N 11 has <lb/>approximately a binomial distribution with parameters n 1+ and <lb/>n  +1  /n: N 11  $ Bi(n 1+ , n  +1  /n). Note that if n 1+ n  +1  /n is also large, <lb/>the binomial approximation can further be approximated by a <lb/>Gaussian distribution. <lb/> 3.2 Comparison of two probabilities formulation <lb/> In a second formulation, we consider two samples, that of the DE <lb/>genes of size n 1+ , among which n 11 genes belonging to the GO <lb/>category of interest, and that of the not DE genes of size n 2+ , among <lb/>which n 21 genes belonging to the GO category. The proportions <lb/>of genes belonging to the GO category in the two samples are thus <lb/>f 1  ¼ n 11 /n 1+ (DE genes) and f 2  ¼ n 21 /n 2+ (not DE genes). Let p 1 and <lb/>p 2 denote the probabilities to belong to the GO category in the two <lb/>samples; then N 11  $ Bi(n 1+ , p 1 ) and N 21  $ Bi(n 2+ , p 2 ). In this <lb/>formulation, the null hypothesis H 0 is the equality of the two pro-<lb/>babilities p 1  ¼ p 2  ¼ p, i.e. there is neither enrichment nor <lb/>depletion in the sample of DE genes with respect to that of the <lb/>not DE genes. <lb/> 3.2.1 Approximate null distribution The case of large samples <lb/>arises frequently. Then, the binomial distributions can be approxi-<lb/>mated with Gaussian distributions. Under H 0 , n 1+ and n 2+ being <lb/>large, the probability p can be correctly estimated with f ¼ (n 11  + <lb/> n 21 )/(n 1+  + n 2+ ) ¼ n  +1  /n, leading to the approximately normally <lb/>distributed variable: <lb/>Z ¼ <lb/> F 1  À F 2 <lb/> ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi <lb/> Fð1 À FÞ <lb/> p <lb/> ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi <lb/> 1 <lb/>n 1þ <lb/> þ <lb/> 1 <lb/>n 2þ <lb/> r <lb/> $ Nð0‚ 1Þ: <lb/> ð2Þ <lb/> This distribution is approximate for two reasons: (1) the replace-<lb/>ment of the binomial distributions by Gaussian distributions holds <lb/>only for large samples (both n 1+ and n 2+ must be large), and (2) it has <lb/>not been taken into account that, according to our problem state-<lb/>ment, the sum N 11  + N 21 , the total number of genes belonging to the <lb/>GO category, is fixed and equal to n  +1  . <lb/> 3.2.2 Exact null distribution Without approximating the bino-<lb/>mial distribution, and taking into account that N 11  + N 21  ¼ n  +1  , we <lb/>naturally obtain N 11  $ Hyper(n, n 1+ , n  +1  ) (see (Fisher, 1935; <lb/>Lehman, 1986) for the complete computation with the binomial <lb/>distribution conditionally on N 11  + N 21  ¼ n  +1  ). Hence, the exact dis-<lb/>tribution of N 11 under H 0 is as before the hypergeometric <lb/>distribution. <lb/> 3.3 Contingency table formulation <lb/> A third formulation is based on Table 2 seen as a 2 · 2 contingency <lb/>table. Let again H 0 denote the hypothesis that the property to belong <lb/>to the GO category of interest and that to be DE are independent. <lb/> Table 1. Reviewed GO processing tools <lb/>GO tool <lb/>Statistical tests <lb/>Reference <lb/>BINGO <lb/>Hypergeometric <lb/>Maere et al., 2005 <lb/>CLENCH <lb/>Hypergeometric, binomial, x  2 <lb/> Shah and Fedorov, 2004 <lb/>DAVID <lb/>Fisher <lb/>Dennis et al., 2003 <lb/>EASEonline <lb/>Fisher <lb/>Hosack et al., 2003 <lb/>eGOn <lb/>Fisher <lb/>http://www.genetools.microarray.ntnu.no/help/help_egon.php?egon=1#intro <lb/>FatiGO <lb/>Fisher <lb/>Al-Sharour et al., 2004 <lb/>FuncAssociate <lb/>Fisher <lb/>http://llama.med.harvard.edu/cgi/func/funcassociate <lb/>FunSpec <lb/>Hypergeometric <lb/>Robinson et al., 2002 <lb/>GeneMerge <lb/>Hypergeometric <lb/>Castillo-Davis and Hartl, 2003 <lb/>GFINDer <lb/>Hypergeometric, binomial, Fisher a <lb/> Masseroli et al., 2004 <lb/>GoMiner <lb/>Fisher <lb/>Zeeberg et al., 2003 <lb/>GOstat <lb/> x  2 , Fisher <lb/>Beißbarth and Speed, 2004 <lb/>GoSurfer <lb/> x  2 <lb/> Zhong et al., 2004 <lb/>GO TermFinder (CPAN) <lb/>Hypergeometric <lb/>Boyle et al., 2004 <lb/>GO TermFinder (SGD) <lb/>Binomial <lb/>http://www.yeastgenome.org/help/goTermFinder.html <lb/>GOTM <lb/>Hypergeometric <lb/>Zhang et al., 2004 <lb/>GOToolBox <lb/>Hypergeometric, binomial, Fisher <lb/>Martin et al., 2004 <lb/>L2L <lb/>Binomial <lb/>Newman and Weiner, 2005 <lb/>NetAffx GO Mining Tool <lb/> x  2 <lb/> Cheng et al., 2004 <lb/>Onto-Express <lb/>Binomial, x  2 , Fisher <lb/>Khatri et al. 2002; Draghici et al., 2003 <lb/>Ontology Traverser <lb/>Hypergeometric <lb/>Young et al., 2005 <lb/>STEM <lb/>Hypergeometric <lb/>Ernst et al., 2005 <lb/>THEA <lb/>Hypergeometric, binomial <lb/>Pasquier et al., 2004 <lb/> a <lb/> The website now proposes 3 additional tests, but they are not documented. <lb/> Table 2. Classification of the genes expressed in a microarray experiment <lb/>Category 1 <lb/>(2GO category) <lb/>Category 2 <lb/>(= 2GO category) <lb/>Total <lb/>Class 1 (DE) <lb/>n 11 <lb/> n 12 <lb/> n 1+ <lb/> Class 2 (not DE) <lb/>n 21 <lb/> n 22 <lb/> n 2+ <lb/> Total <lb/>n  +1 <lb/> n  +2 <lb/> n <lb/> 
			
			<note place="headnote">I.Rivals et al. <lb/></note> 
			
			<page>402 <lb/></page> 
			
			<note place="footnote">by  guest on March 17, 2013 <lb/> http://bioinformatics.oxfordjournals.org/ <lb/> Downloaded from <lb/></note> 
			
			3.3.1 Approximate null distribution The case of a large sample <lb/>is frequently considered where, if H 0 is true, the following variable <lb/>is asymptotically x  2 distributed with one degree of freedom (Mood <lb/> et al., 1974): <lb/>D 2  ¼ <lb/> X  2 <lb/>i¼1 <lb/> X  2 <lb/>j¼1 <lb/> N ij  À <lb/> N iþ N  þj <lb/> n <lb/>  2 <lb/> N iþ N  þj <lb/> n <lb/> $ x  2  ð1Þ: <lb/>ð3Þ <lb/> Note that d 2 is the square of the realization z of the normal variable <lb/>Z given by Equation (2): <lb/>d 2  ¼ <lb/> nðn 11 n 22  Àn  12 n 21  Þ  2 <lb/> n 1þ n 2þ n  þ1  n  þ2 <lb/> ¼ z 2  : <lb/> ð4Þ <lb/> 3.3.2 Exact null distribution Whatever the sample size, Fisher&apos;s <lb/>formula gives the probability of the observed configuration of the <lb/>contingency table under H 0 (Fisher, 1935; Mood et al., 1974; <lb/>Agresti, 2002): <lb/>PðfN ij  ¼ n ij  gÞ ¼ <lb/> n 1þ  !n  2þ  !n  þ1  !n  þ2  ! <lb/> n!n 11  !n  12  !n  21  !n  22  ! <lb/> : <lb/> ð5Þ <lb/> It is easy to show that N 11  $ Hyper(n, n 1+ , n  +1  ): <lb/>PðN 11  ¼ x j N 1þ  ¼ n 1þ ‚N  þ1 ¼ n  þ1 Þ ¼ <lb/> n  þ1  ! <lb/> x!n 21  ! <lb/> n  þ2  ! <lb/> n 12  !n  22  ! <lb/> n! <lb/>n 1þ  !n  2þ  ! <lb/> ¼ <lb/> n  þ1 <lb/> x <lb/> n  þ2 <lb/> n 12 <lb/> n <lb/>n 1þ <lb/> : <lb/> ð6Þ <lb/> As expected, the exact distribution of N 11 under H 0 is again the <lb/>hypergeometric distribution, see Equation (1). <lb/>

			 3.4 Summary <lb/> Under H 0 , i.e. assuming the independence of the property to belong <lb/>to the GO category of interest and of the property to be DE, or <lb/>equivalently assuming p 1  ¼ p 2 where p 1 is the probability of the DE <lb/>genes to belong to the GO category, and p 2 the probability of the not <lb/>DE genes to belong to the GO category, the exact distribution of N 11 <lb/> is the hypergeometric distribution N 11  $ Hyper(n, n 1+ , n  +1  ) which, <lb/>if n is large, can be approximated with the binomial distribution <lb/>Bi(n 1+ , n  +1  /n). If the two samples are large, it is also possible to <lb/>exhibit an approximately normal variable Z or its square D 2  ¼ Z 2 , <lb/>the latter being hence approximately x  2 distributed with one degree <lb/>of freedom. <lb/> 4 TESTS AND P-VALUES <lb/> Generally, when performing the test of a null hypothesis H 0 against <lb/>some alternative hypothesis H a , one disposes of a realization x of <lb/>a random variable X with known distribution under H 0 , the null <lb/>distribution. One chooses a priori a probability a of type I error (the <lb/>error to reject H 0 whereas it is true) that must not be exceeded, <lb/>also called significance level, the decision to reject H 0 being taken <lb/>when x falls in the critical region. In this context, the P-value is <lb/>the minimum significance level for which H 0 would be rejected, or <lb/>equivalently, it is the probability, under H 0 , of the minimal critical <lb/>region containing x. <lb/>The choice of a critical region in order to maximize the power <lb/>of the test, and hence the choice of the corresponding P-value, <lb/> depends on the alternative hypothesis H a , which may be &apos;enrich-<lb/>ment&apos; (p 1  &gt; p  2 , one-sided test, critical region right), &apos;depletion&apos; <lb/>(p 1  &lt; p  2 &apos;one-sided&apos; test, critical region left), or &apos;enrichment or <lb/>depletion&apos; (p 1  6 ¼ p  2 , two-sided test, critical region left and right). <lb/>Enrichment, depletion and enrichment or depletion are later denoted <lb/>by E, D, and E/D, respectively. <lb/>
			 
			 4.1 One-sided tests <lb/> The one-sided P-value is defined as: <lb/>if H a  ¼ E‚ p one  ðn  11  Þ ¼ PðN 11  ! n 11  Þ <lb/> if H a  ¼ D‚p one  ðn  11  Þ ¼ PðN 11 n 11  Þ <lb/> : <lb/> ð7Þ <lb/> If the case of a discrete distribution, like the exact hypergeometric <lb/>distribution or the approximate binomial distribution, it is not pos-<lb/>sible to guaranty any value of the significance level with the rule <lb/>&apos;reject H 0 if p one (n 11 ) <lb/> a&apos;. Due to the discreteness, the actual <lb/>significance level (or size of the test) is generally smaller than <lb/>the nominal (desired) significance level a, which results in a loss <lb/>of power. <lb/>To minimize this loss, a good remedy is the use of mid-P-values <lb/>(Agresti and Min, 2001; Agresti, 2002). The one-sided mid-P-value, <lb/>which we denote by p  one , is defined as: <lb/>if H a  ¼ E‚ p  one  ðn  11  Þ ¼ PðN 11  &gt; n 11  Þ þ  1 <lb/>2 PðN 11  ¼ n 11  Þ <lb/> if H a  ¼ D‚p one  ðn  11  Þ ¼ PðN 11  &lt; n 11  Þ þ  1 <lb/>2 PðN 11  ¼ n 11  Þ <lb/> : <lb/> ð8Þ <lb/> It must be noted that the actual significance level, i.e. the actual <lb/>probability of type I error, is no longer guaranteed to be smaller than <lb/>the nominal significance level. However, it is rarely much greater <lb/>(Agresti, 2002). <lb/>Another remedy is randomization, with which any desired signi-<lb/>ficance level can be achieved. However in practice, randomization <lb/>having nothing to do with the data does not make much sense <lb/>(Lehmann, 1986; Agresti, 2002). <lb/>If the approximately normal variable Z is considered, we have: <lb/>if H a  ¼ E‚ p one  ðzÞ ¼ PðZ &gt; zÞ <lb/>if H a  ¼ D‚p one  ðzÞ ¼ PðZ &lt; zÞ <lb/> : <lb/> ð9Þ <lb/> If the approximately x  2 distributed variable D 2 is used, a one-sided <lb/>test cannot be performed, since both enrichment (large observed <lb/>n 11 ) and depletion (small observed n 11 ) lead to a large value of D 2 , <lb/>i.e. there is a single critical region. <lb/> 4.2 Two-sided tests <lb/> In the case of a two-sided test i.e. H a  ¼ E/D, and of a discrete null <lb/>distribution, there are several popular definitions of the P-value, see <lb/>(Agresti, 1992, 2002). A first approach defines the two-sided <lb/> P-value as twice the one-sided P-value: <lb/> p doubling <lb/>two <lb/> ðn  11  Þ ¼ 2 · min½PðN 11  ! n 11  Þ‚PðN  11 n 11  Þ: <lb/>ð10Þ <lb/> Yates and Fisher himself were in favor of this &apos;doubling&apos; approach <lb/>(Yates, 1984). A second approach, which after Gibbons and Pratt <lb/>(1975) we name the &apos;minimum-likelihood&apos; approach, defines the <lb/> P-value as the sum of the probabilities of the values of N 11 that are <lb/> Enrichment or depletion of a GO category <lb/> 
			 
			 <page>403 <lb/></page> 
			 
			 <note place="footnote">by  guest on March 17, 2013 <lb/> http://bioinformatics.oxfordjournals.org/ <lb/> Downloaded from <lb/></note> 
			 
			 smaller or equal to that of the observed value n 11 , as recommended <lb/>for example in (Mehta and Patel, 1998): <lb/>p min lik <lb/>two <lb/> ðn  11  Þ ¼ <lb/> X <lb/> PðN11¼mÞ Pðn11Þ <lb/> PðN 11  ¼ mÞ: <lb/> ð11Þ <lb/> The minimum-likelihood approach is the only one we have <lb/>encountered in the GO tools of Table 1. A third approach <lb/>defines the P-value as the sum of the probabilities of the values <lb/>of N 11 that are at least as or more extreme (with respect to the <lb/>mathematical expectation of N 11 ) than the observed one (Gibbons <lb/>and Pratt, 1975; Yates, 1984; Agresti, 2002). A fourth approach <lb/>defines the two-sided P-value as min[P(N 11  ! n 11 ), P(N 11 n 11 )] <lb/>plus an attainable probability in the other tail that is as close <lb/>as possible to, but not greater than, that one-tailed probability <lb/>(Agresti, 2002). <lb/>These definitions lead to equal P-values in the case of symmetric <lb/>distributions, i.e. when n 1+  ¼ n 2+ ; else, they possibly lead to dif-<lb/>ferent P-values and corresponding test results, each of them having <lb/>advantages and disadvantages, due to the discreteness and skewness <lb/>of the hypergeometric distribution. The problem is also that these <lb/> P-values do not correspond to any well-defined two-sided test. This <lb/>issue is discussed for example in (Dunne et al., 1996), where a <lb/>two-sided P-value based on an uniformly most powerful unbiased <lb/>test is proposed. However, this P-value is obtained with an iterative <lb/>procedure, which makes this approach inadequate for the screening <lb/>of hundreds of different GO categories. <lb/>Thus, if a single simple and computationally light (see subsection <lb/>6.3) procedure were to be recommended, we would advice the <lb/>doubling approach, against which there is no strong argument, <lb/>and using the mid-P-value, in order to reduce the discreteness <lb/>and conservatism effects: <lb/> p  doubling <lb/>two <lb/> ðn  11  Þ ¼ 2 · minðPðN 11  &gt; n 11  Þ þ  1 <lb/>2 PðN 11  ¼ n 11  Þ‚ <lb/> PðN 11  &lt; n 11  Þ þ  1 <lb/>2 PðN 11  ¼ n 11  ÞÞ: <lb/>ð12Þ <lb/> A mid-P-value can also be defined for the minimum-likelihood <lb/>approach, as the sum of the probabilities that are smaller than <lb/>the probability of the observed value n 11 , plus half the sum of <lb/>the probabilities equal to it: <lb/> p  min lik <lb/>two <lb/> ðn  11  Þ ¼ <lb/> X <lb/> PðN11¼mÞ&lt;Pðn11Þ <lb/> PðN 11  ¼ mÞ <lb/> þ <lb/> 1 <lb/>2 <lb/> X <lb/> PðN11¼mÞ¼Pðn11Þ <lb/> PðN 11  ¼ mÞ: <lb/> ð13Þ <lb/> However, we must again emphasize that the actual probability of <lb/>type I error may exceed the nominal significance level. <lb/>If the approximately normal variable Z is considered (a continu-<lb/>ous and symmetrically distributed variable), we have: <lb/>p two  ðzÞ ¼ 2 · min½PðZ &gt; zÞ‚PðZ &lt; zÞ: <lb/> ð14Þ <lb/> If the approximately x  2 distributed variable D 2 is considered, the <lb/> P-value is computed as: <lb/>p two  ðd  2  Þ ¼ PðD 2  &gt; d 2  Þ ¼ p two  ðzÞ: <lb/>ð15Þ <lb/> 4.3 One versus two-sided tests? <lb/> Consider a dataset consisting of tissues in a pathological condition <lb/>and of normal tissues, and a GO category whose genes are directly <lb/>affected by the condition, i.e. the genes belonging to this GO cate-<lb/>gory are DE (either over-or under-expressed). Such a GO category <lb/>is likely to be over-represented among the DE genes, i.e. an enrich-<lb/>ment is expected. Thus, detecting an enrichment is desirable. On the <lb/>other hand, consider a GO category such that the normal expression <lb/>of the corresponding genes is necessary for the condition to develop, <lb/>i.e. the genes belonging to this GO category are not DE. Such a GO <lb/>category is likely to be under-represented among the DE genes, i.e. a <lb/>depletion is expected. Thus, detecting a depletion is also desirable, <lb/>even if there is a risk to detect the depletion of a GO category <lb/>corresponding to genes whose normal expression is necessary to <lb/>the mere survival of the specie. <lb/>Thus, both enrichments and depletions of GO categories <lb/>are potentially of interest. Hence, unless there is a specific <lb/>reason not to consider enrichment or depletion, the adequate <lb/>alternative hypothesis is H a  ¼ E/D, i.e. two-sided tests are <lb/>appropriate. <lb/> 5 SUMMARY AND DISCUSSION <lb/> To summarize, there is a single exact null distribution of N 11 , the <lb/>hypergeometric distribution, but different exact tests (exact in the <lb/>sense that they are based on the exact null distribution), one or <lb/>two-sided, and with several definitions of the P-value in the latter <lb/>case. These tests can equally be called hypergeometric or Fisher&apos;s <lb/>exact tests 2 . Thus, it is not justified to claim, as Masseroli et al. <lb/> (2004) do, that &apos;the x  2 and Fisher&apos;s exact tests have less power <lb/>than the hypergeometric and binomial distribution tests&apos;. GFIN-<lb/>DER and GOToolBox propose the hypergeometric test and <lb/>Fisher&apos;s exact test as two alternative options: GFINDER indeed <lb/>provides the same results for the two options (one-sided tests), <lb/>but strangely enough, GOToolBox gives different results, whereas <lb/>they should be identical for the same choice of a P-value <lb/> (incorrect results given by some GO tools are detailed in the <lb/>Appendix, which is available as supplementary data). <lb/>The available GO tools often do not explicitly state which <lb/> P-value is computed. For example, BINGO calls the test it performs <lb/>&apos;hypergeometric test&apos; (Maere et al. 2005), without saying that it <lb/>is two-sided with the minimum-likelihood approach. According to <lb/>both references and websites, we could establish that Func-<lb/>Associate, GFINDER and THEA provide only one-sided tests in <lb/>both directions, while FuncSpec, EASEonline, GO Term Finder <lb/>(CPAN), Term Finder (SGD), GOTM, L2L, Ontology Traverser <lb/>and STEM only one-sided enrichment tests and that BINGO, <lb/>DAVID, eGOn, 2004 FatiGo, GeneMerge, GoMiner, GOstat, <lb/>GoSurfer, NetAffx and Onto-Express provide two-sided tests, the <lb/> P-values being computed according to the minimum-likelihood <lb/>approach when a discrete distribution is used. <lb/>As discussed in section 4.3, two-sided tests are usually most <lb/>appropriate. Be it with the doubling or the minimum-likelihood <lb/>approach to the P-value, the discreteness and conservatism effects <lb/>can be efficiently dealt with using mid-P-values, a possibility that is <lb/>not offered by any of the GO tools of Table 1. <lb/> 2 <lb/> As a matter of fact, (Fisher, 1935) describes a one-sided test in the direction <lb/>of the observed departure of the null hypothesis. <lb/> 
			 
			 <note place="headnote">I.Rivals et al. <lb/></note> 
			 
			 <page>404 <lb/></page> 
			 
			 <note place="footnote">by  guest on March 17, 2013 <lb/> http://bioinformatics.oxfordjournals.org/ <lb/> Downloaded from <lb/></note> 
			 
			 6 NUMERICAL ILLUSTRATIONS <lb/> 6.1 Small sample <lb/> We consider a small sample with n ¼ 20, n 1+  ¼ 7, n  +1  ¼ 6 and <lb/>n 11  ¼ 4, i.e. f 1  ¼ 0.57 and f 2  ¼ 0.15. The null distribution of N 11  $ <lb/> Hyper(n, n 1+ , n  +1  ) is shown in Figure 1. The sample being <lb/>very small, we consider only the tests based on this exact <lb/>distribution. <lb/> 6.1.1 One-sided test For illustration purposes, let us first con-<lb/>sider a one-sided test (suppose one is interested in enrichments <lb/>only). The corresponding one-sided P-value right equals: <lb/>p one  ð4Þ ¼ PðN 11  ! 4Þ ¼ Pð4Þ þ Pð5Þ þ Pð6Þ <lb/> ¼ 7:04 · 10  À2 þ 7:04 · 10  À3 þ 1:81 · 10  À4 ¼ 7:77 · 10  À2  : <lb/> The one-sided mid-P-value is: <lb/> p  one  ð4Þ ¼ PðN 11  &gt; 4Þ þ Pð4Þ/2 <lb/> ¼ 7:04 · 10  À3 þ 1:81 · 10  À4 þ 7:04 · 10  À2  /2 ¼ 4:24 · 10  À2  : <lb/> There is a substantial difference between the P-value and the <lb/>mid-P-value. With a significance level a ¼ 5%, the mid-P-value <lb/>leads to reject H 0 , whereas the P-value does not: the use of a mid-<lb/> P-value corresponds to a less conservative test. However, the actual <lb/>significance level is no longer guaranteed to be smaller than the <lb/>nominal significance level 5%. <lb/> 6.1.2 Two-sided tests The two-sided doubling P-value equals: <lb/>p doubling <lb/>two <lb/> ð4Þ ¼ 2 · min ðPðN  11 4Þ‚PðN 11  ! 4ÞÞ ¼ 2 · PðN 11  ! 4Þ <lb/> ¼ 2 · p one  ð4Þ ¼ 1:55 · 10  À1  : <lb/> The two-sided doubling mid-P-value equals: <lb/> p  doubling <lb/>two <lb/> ð4Þ ¼2 · min ðPðN  11  &lt; 4Þ þ PðN 11  ¼ 4Þ/2‚ <lb/>PðN 11  &gt; 4Þ þ PðN 11  ¼ 4Þ/2Þ <lb/> ¼ 2 · ðPðN  11  &gt; 4Þ þ PðN 11  ¼ 4Þ/2Þ <lb/> ¼ 2 · p  one  ð4Þ ¼ 8:49 · 10  À2  : <lb/> As for the one-sided test, there is a substantial difference between <lb/>the two values. Also, with a significance level a ¼ 5%, a two-sided <lb/>test does not reject H 0 . <lb/>The two-sided minimum-likelihood P-value equals: <lb/>p min lik <lb/>two  ð4Þ ¼ <lb/> X <lb/> PðN11¼mÞ Pð4Þ <lb/> PðN 11  ¼ mÞ ¼ Pð0Þ þ Pð4Þ þ Pð5Þ þ Pð6Þ <lb/> ¼ 4:43 · 10  À2 þ 7:04 · 10  À2 þ 7:04 · 10  À3 þ 1:81 · 10  À4 <lb/> ¼ 1:22 · 10  À1  : <lb/> The hypergeometric distribution being here asymmetric, the <lb/>doubling and minimum-likelihood P-values are quite different. <lb/>The two-sided minimum-likelihood mid-P-value equals: <lb/> p  min lik <lb/>two <lb/> ð4Þ ¼ <lb/> X <lb/> PðN11¼mÞ&lt;Pð4Þ <lb/> PðN 11  ¼ mÞ þ PðN 11  ¼ 4Þ/2 <lb/> ¼ Pð0Þ þ Pð5Þ þ Pð6Þ þ Pð4Þ/2 ¼ 8:67 · 10  À2  : <lb/> It is always smaller than the P-value, and hence corresponds to a less <lb/>conservative test. <lb/> 6.2 Large sample <lb/> We now consider a sample whose size is analogous to that of <lb/>samples encountered when testing enrichment of GO categories <lb/>among DE genes on dedicated microarrays. We have n ¼ 800, <lb/>n 1+  ¼ 40, n  +1  ¼ 100, and observe n 11  ¼ 10, i.e. f 1  ¼ 0.25 <lb/>and f 2  ¼ 0.12. The alternative hypothesis is H a  ¼ E/D <lb/>(two-sided test). <lb/> The exact two-sided doubling P-value obtained with the hyper-<lb/>geometric distribution is p doubling <lb/>two <lb/> ðn  11  Þ ¼ 3.95 · 10  À2  , and the <lb/>two-sided mid-P-value is p  doubling <lb/>two <lb/> ðn  11  Þ ¼ 2.66 · 10  À2  . With the <lb/>minimum-likelihood approach, p min lik <lb/>two <lb/> ðn  11  Þ ¼ 2.39 · 10  À2  , and <lb/>the two-sided mid-P-value is p  min lik <lb/>two <lb/> ðn  11  Þ ¼ 1.74 · 10  À2  . Note <lb/>that, the null distribution being asymmetric, there is a noticeable <lb/>difference between the two approaches, and, though the sample <lb/>is quite large, between the P-values and the corresponding <lb/>mid-P-values. <lb/> The approximate binomial test leads to a doubling P-value of <lb/>4.54 · 10  À2  , and to a doubling mid-P-value of 3.11 · 10  À2  , to a <lb/>minimum-likelihood P-value of 2.75 · 10  À2  , and to a minimum-<lb/>likelihood mid-P-value of 2.03 · 10  À2  . Note that though the <lb/>sample is not small, there is quite a difference with the exact <lb/>distribution. <lb/> The approximate test of equality of two probabilities leads to <lb/>the value of an approximately normal statistic z ¼ 2.45, and to a <lb/>two-sided P-value of p two (z) ¼ 1.42 · 10  À2  . This value is even <lb/>less accurate than that obtained with the binomial approxima-<lb/>tion, because the DE sample is too small (n 1+  ¼ 40). <lb/> The x  2 -test indeed leads to a statistic value d 2  ¼ 6.015 ¼ z 2 , and <lb/>hence to the same two-sided P-value. <lb/> In the case of larger samples, obtained with mouse or human <lb/>pangenomic microrrays, typically with n of the order of 25 000: <lb/> The approximate binomial test leads to (mid-) P-values <lb/> that are very close to those of the exact hypergeometric test. <lb/>However, with todays computing means, there is no <lb/>decisive advantage in performing this approximation (see <lb/>next section). <lb/> The approximate test of equality of two probabilities becomes <lb/>closer to the exact one only if the number of DE genes is large, <lb/> Fig. 1. Hypergeometric null distribution Hyper(20, 7, 6) (crosses). The <lb/>observed value is n 11  ¼ 4 (circle). <lb/> Enrichment or depletion of a GO category <lb/> 
			 
			 <page>405 <lb/></page> 
			 
			 <note place="footnote">by  guest on March 17, 2013 <lb/> http://bioinformatics.oxfordjournals.org/ <lb/> Downloaded from <lb/></note> 
			 
			 which is not necessarily the case. There is thus no reason to use <lb/>this test. <lb/> This is hence also true for the equivalent x  2 test. <lb/> 6.3 Implementation with R and computational issues <lb/> All the exact tests can be implemented &apos;by hand&apos; with the hyper-<lb/>geometric cumulative distribution function &apos;phyper&apos; and the distri-<lb/>bution function &apos;dhyper&apos;, and the binomial approximations with <lb/>&apos;pbinom&apos; and &apos;dbinom&apos; 3 . <lb/>The default implementation of the exact test with R provides the <lb/>two-sided minimum-likelihood P-value. The corresponding instruc-<lb/>tion is &apos;fisher.test(c)&apos;, where the matrix c is the 2 · 2 contingency <lb/>table [n 11 n 12 ; n 21 n 22 ]. The one-sided enrichment test is obtained <lb/>with &apos;fisher.test(c, alternative ¼ &apos;&apos;greater&apos;&apos;)&apos;, the one-sided <lb/>depletion test with &apos;fisher.test(c, alternative ¼ &apos;&apos;less&apos;&apos;)&apos;. <lb/>In order to evaluate the computation time of the two-sided tests, <lb/>let us consider the case of a microarray with n ¼ 25 000 genes, n 1+  ¼ <lb/> 1000 DE genes, and 500 different GO categories. We take n  +1 <lb/> uniformly distributed in [0,n], and n 11 uniformly distributed in <lb/>[max(0, n  +1 +n  1+ –n), min(n 1+ , n  +1  )]. With R 2.1.0 running under <lb/>Mac OS X on a 2 GHz two processor Macintosh (PowerPC 970 <lb/>2.2), we obtain the following total elapsed times (mean and standard <lb/>error on 20 runs) for the doubling approach: <lb/> hypergeometric doubling P-values, computed with the functions <lb/>&apos;dhyper&apos; and &apos;phyper&apos;: 0.17 ± 0.02 s, and 0.20 ± 0.02s for the <lb/>mid-P-values. <lb/> binomial doubling P-values, computed with the functions <lb/>&apos;dbinom&apos; and &apos;pbinom&apos;: 0.16 ± 0.02s, and 0.19 ± 0.02s for <lb/>the mid-P-values. <lb/>Hence, the gain in time obtained by using the binomial approxi-<lb/>mation to the hypergeometric distribution is negligible. <lb/>For the minimum-likelihood approach, the R function &apos;fisher. <lb/>test&apos;, (which does not only compute a P-value) is much slower <lb/>than a computation &apos;by hand&apos;: <lb/> hypergeometric minimum-likelihood P-values, computed with <lb/>the function &apos;fisher.test&apos;: 17.15 ± 0.21 s. <lb/> hypergeometric minimum-likelihood P-values, computed with <lb/>the functions &apos;dhyper&apos; and &apos;phyper&apos;: 1.83 ± 0.04s and 2.10 ± <lb/>0.05s for the mid-P-values. <lb/>The computation time is hence an argument in favor of the doubling <lb/>approach to the two-sided P-value. <lb/> 7 CONCLUSION <lb/> The correct statement of the enrichment and/or depletion testing <lb/>problem leads to a unique exact null distribution of the number of <lb/>DE genes belonging to the GO category of interest, given the total <lb/>gene number and the total number of genes belonging to the GO <lb/>category. This distribution is the hypergeometric one, whose values <lb/>are equivalently given by Fisher&apos;s formula for a 2 · 2 contingency <lb/>table. Since both enrichments and depletions of GO categories <lb/>are potentially of interest, two-sided tests are generally most appro-<lb/>priate. With the doubling or the popular minimum-likelihood <lb/>definitions of the P-value, a loss of power due to the discreteness <lb/>of the hypergeometric distribution is efficiently dealt with using <lb/>mid-P-values, the doubling P-value involving lighter computations <lb/>than the minimum-likelihood P-value. Finally, since many dedi-<lb/>cated microarrays involve small data sets, and given the currently <lb/>available algorithms and computing means, there is no strong <lb/>argument in favor of the approximate large sample tests. <lb/> 
		
 		</body>

 		<back>
				 
			<div type="acknowledgement">ACKNOWLEDGEMENTS <lb/> Funding to pay the Open Access publication charges for this article <lb/>was provided by the CNRS and the city of Paris. <lb/> Conflict of Interest: none declared. <lb/></div>

			<listBibl> REFERENCES <lb/> Agresti,A. (1992) A survey of exact inference for contingency tables. Stat. Sci., 7, <lb/> 131–177. <lb/>Agresti,A. and Min,Y. (2001) On small-sample confidence intervals for parameters in <lb/>discrete distributions. Biometrics, 57, 963–971. <lb/>Agresti,A. (2002) Categorical Data Analysis. 2nd edn. John Wiley &amp; Sons, Inc., <lb/>Hoboken, New Jersey. <lb/>Agresti,A. (2006) Reducing conservatism of exact small-sample methods of inference <lb/>for discrete data. Compstat 2006, 17th Symposium of the IASC, Rome 28 August— <lb/>1 September 2006. <lb/>Al-Sharour,F. et al. (2004) FatiGO: A web tool for finding significant associations of <lb/>Gene Ontology terms with groups of genes. Bioinformatics, 20, 578–580. <lb/>Beißbarth,T. and Speed,T.P. (2004) GOstat: find statistically overrepresented Gene <lb/>Ontologies within &amp; group of genes. Bioinformatics, 20, 1464–1465. <lb/>Boyle, E.I. et al. (2004) GO: TermFinder–open source software for accessing Gene <lb/>Ontology information and finding significantly enriched Gene Ontology terms <lb/>associated with a list of genes. Bioinformatics, 20, 3710–3715. <lb/>Castillo-Davis,C.I. and Hartl,D.L. (2003) GeneMerge–post-genomics analysis, data <lb/>mining, and hypothesis testing. Bioinformatics, 19, 891–892. <lb/>Cheng,J. et al. (2004) NetAffx Gene Ontology Mining Tool: a visual approach for <lb/>microarray data analysis. Bioinformatics, 20, 1462–1463. <lb/>Dennis,G., Jr et al. (2003) DAVID: Database for Annotation, Visualization, and <lb/>Integrated Discovery. Genome Biol., 4, R60. <lb/>Draghici,S. et al. (2003) Global functional profiling of gene expression. Genomics, 81, <lb/> 98–104. <lb/>Dunne,A. et al. (1996) Two-sided P-values from discrete asymmetric distributions <lb/>based on uniformly most powerful unbiased tests. The Statistician, 45, 397–405. <lb/>eGOn Reference Manual (2004). <lb/>Ernst,J. et al. (2005) Clustering short time series gene expression data. Bioinformatics, <lb/> 21 (Suppl. 1), i159–i168. <lb/>Fisher,R.A. (1935) The logic of inductive inference. J. Royal Stat. Soc., 98, 39–54. <lb/>Gibbons,J.D. and Pratt,J.W. (1975) P-values: interpretation and methodology. Am. <lb/>Stat., 29, 20–25. <lb/>Hosack,D.A. et al. (2003) Identifying biological themes within lists of genes with <lb/>EASE. Genome Biol., 4, R70. <lb/>Khatri,P. et al. (2002) Profiling gene expression utilizing onto-express. Genomics, 79, <lb/> 266–270. <lb/>Khatri,P. and Draghici,S. (2005) Ontological analysis of gene expression data: current <lb/>tools, limitations, and open problems. Bioinformatics, 21, 3587–3595. <lb/>Lehman,E.L. (1986) Testing Statistical Hypotheses. 2nd edn. Springer-Verlag, <lb/>New York, LLC. <lb/>Maere,S. et al. (2005) BiNGO: a Cytoscape plugin to assass overrepresentation <lb/>of Gene Ontology categories in Biological Networks. Bioinformatics,21, 3448–3449. <lb/>Martin,D. et al. (2004) GOToolbox: functional analysis of gene datasets based on Gene <lb/>Ontology. Genome Biol., 5, R101. <lb/>Masseroli,M. et al. (2004) GFINDer: Genome Function INtegrated Discoverer through <lb/>dynamic annotation, statistical analysisn and mining. Nucleic Acids Res., 32, <lb/> W293–W300. <lb/>
			
			<note place="footnote"> 3 The code of the R functions can be found at the R project site https://svn.r-<lb/>project.org/R/trunk/src/nmath/. The best known and most complete software <lb/>for contingency table methods in general is StatXact (Agresti, 2006). <lb/></note> 
			
			<note place="headnote">I.Rivals et al. <lb/></note>

			<page> 406 <lb/></page>

			<note place="footnote">by  guest on March 17, 2013 <lb/> http://bioinformatics.oxfordjournals.org/ <lb/> Downloaded from <lb/></note>

			 Mehta,C.R. and Patel,N.R. (1998) Exact inference for categorical data. In: Armitage,P. and <lb/>Coltin,T.(eds),EncyclopediaofBiostatistics,Vol,2,Wiley,Chichester,UK,pp.1411–1422. <lb/>Mood,A.M. et al. (1974) Introduction to the Theory of Statistics, 3rd edn. McGraw-Hill. <lb/>International Edition. <lb/>Newman,J.C. and Weiner,A.M. (2005) L2L: a simple tool for discovering the hidden <lb/>significance in microarray expression data. Genome Biol., 6, R8. <lb/>Pasquier,C. et al. (2004) THEA: ontology-driven analysis of microarray, Bioinformat-<lb/>ics, 20, 2636–2643. <lb/>Robinson,M.D. et al. (2002) FunSpec: a web-based cluster interpreter for yeast. BMC <lb/>Bioinformatics, 3, 35. <lb/>Shah,N.H. and Fedoroff,N.V. (2004) CLENCH: a program for calculating Cluster <lb/>ENriCHment using the Gene Ontology. Bioinformatics, 20, 1196–1197. <lb/>Yates,F. (1984) Test of significance for 2x2 contingency tables. J. Royal Stat. Soc. <lb/>Series A, 147, 426–463. <lb/>Young,A. et al. (2005) Ontology Traverser: an R package for GO analysis. Bioinfor-<lb/>matics, 21, 275–276. <lb/>Zeeberg,B.R. et al. (2003) GoMiner: a resource for biological interpretation of genomic <lb/>and proteomic data. Genome Biol., 4, R28. <lb/>Zhang,B. et al. (2004) GOTree Machine (GOTM): a web-based platform for inter-<lb/>preting sets of iinteresting genes using Gene Ontology hierarchies. BMC Bioin-<lb/>formatics, 5, 16. <lb/>Zhong,S. et al. (2004) GoSurfer: a graphical interactive tool for comparative <lb/> analysis of large gene sets in gene ontology space. Appl. Bioinformatics, 3, <lb/> 261–264. <lb/> Enrichment or depletion of a GO category <lb/> </listBibl>
			 
			 <page>407 <lb/></page> 
			 
			 <note place="footnote">by  guest on March 17, 2013 <lb/> http://bioinformatics.oxfordjournals.org/ <lb/> Downloaded from</note> 

		 </back>
	</text>
</tei>
